# 	高德地图API

#### 准备页面

##### 1.在页面添加 JS API 的入口脚本标签，并将其中「您申请的key值」替换为您刚刚申请的 key

```js
<script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=您申请的key值"></script> 
```

##### 2.添加`div`标签作为地图容器，同时为该`div`指定`id`属性

```
<div id="container"></div> 
```

##### 3.为地图容器指定高度、宽度

```
#container {width:300px; height: 180px; }
```

##### 4.进行移动端开发时，请在`head`内添加`viewport`设置，以达到最佳的绘制性能,

```
<meta name="viewport" content="initial-scale=1.0, user-scalable=no"> 
```

##### 异步加载 JS API

```
  window.onLoad  = function(){
        var map = new AMap.Map('container');
  }
  var url = 'https://webapi.amap.com/maps?v=1.4.15&key=您申请的key值&callback=onLoad';
  var jsapi = doc.createElement('script');
  jsapi.charset = 'utf-8';
  jsapi.src = url;
  document.head.appendChild(jsapi);
```

#### 地图的生命周期

##### 地图的创建

```
		//实例化地图
        var map = new AMap.Map('container', {
            resizeEnable: true,   //是否监控地图尺寸的变化
            zoom: 13,    // 初始化地图级别
            center: [116.397428, 39.90923],    // 初始化地图中心点坐标,
            viewMode: '3D'    //使用3D视图
        });
```

##### 判断地图是否加载完成

```
        //实例化地图
        var map = new AMap.Map('container', {
            resizeEnable: true,   //是否监控地图尺寸的变化
            zoom: 13,    // 初始化地图级别
            center: [116.397428, 39.90923],    // 初始化地图中心点坐标,
            viewMode: '3D'    //使用3D视图
        });

        //监测地图是否加载完成
        map.on("complete", function () {
            console.log('加载完成');
        });
```

##### 地图销毁

```
			//地图销毁
            $('.clearMarker').on("click", function () {
                map && map.destroy();
                console.log('地图已销毁');
            })
```

##### 异步加载地图

```
            //异步加载地图
            function onApiLoaded() {
                var map = new AMap.Map('container', {
                    resizeEnable: true,   //监测窗口大小是否发生变化 
                    center: [117.000923, 36.675807],    //初始化地图中心坐标
                    zoom: //初始化地图级别
                })
            }
                        var url = "https://webapi.amap.com/maps?v=1.4.15&key=您申请的key值&callback=onApiLoaded"
            var jsapi = document.createElement('script');
            jsapi.type = text / javaScript;
            jsapi.scr = url;
            document.body.appendChild(jsapi);
```

#### 地图属性

##### 中英文地图

```
    var marker, map = new AMap.Map("container", {
        resizeEnable: false,
        center: [116.397428, 39.90923],
        zoom: 5,
        lang: "zh"   //可选取 en,zh_en,zh_cn
    })
    
    function setLang(id) {
        //更改地图语言
        map.setLang(id);
    }
    setLang('en')
```

##### 获取地图级别与中心点坐标

```
    //获取地图层级与中心信息
        //地图级别
        var zoom = map.getZoom()
        //地图中心点位置
        var center = map.getCenter();
        //绑定地图移动事件
        map.on("moveend", function () { console.log(zoom, center.toString()) })
        //绑定地图缩放事件   
        map.on("zoomend", function () {console.log(zoom, center.toString())})
```

##### 设置地图中心点/级别

```
    //获取地图层级与中心信息
        //地图级别
        var zoom = map.getZoom()
        //地图中心点位置
        var center = map.getCenter();
        //绑定地图移动事件
        map.on("moveend", function () { console.log(zoom, center.toString()) })
        //绑定地图缩放事件   
        map.on("zoomend", function () {console.log(zoom, center.toString())})

    //设置地图中心点/级别
        var zoom = Math.floor(Math.random() * 7) + 11;  // 11—18
        //设置地图层级
        map.setZoom(zoom);
        
        //经度范围
        var lng = 121.138398 + Math.floor(Math.random() * 589828) / 1e6;
        //纬度范围
        var lat = 30.972688 + Math.floor(Math.random() * 514923) / 1e6;
        //设置地图中心点
        map.setCenter([lng, lat]);

    
    var zoom = Math.floor(Math.random() * 7) + 11;
    var lng = 121.138398 + Math.floor(Math.random() * 589828) / 1e6;
    var lat = 30.972688 + Math.floor(Math.random() * 514923) / 1e6;
    //同时设置地图层级与中心点
    map.setZoomAndCenter(zoom, [lng, lat]);
```

##### 获取鼠标点击经纬度

```
        map.on("click", function (e) {
            //获取经度
            var lng = e.lnglat.getLng();
            //获取纬度
            var lat = e.lnglat.getLat();
            console.log(lng, lat);
        });
```

##### 地图的热点

```
  		var placeSearch = new AMap.PlaceSearch();  //构造地点查询类
        var infoWindow = new AMap.AdvancedInfoWindow({});
        map.on('hotspotover', function (result) {
            placeSearch.getDetails(result.id, function (status, result) {
                if (status === 'complete' && result.info === 'OK') {
                    placeSearch_CallBack(result);
                }
            });
        });
        //回调函数
        function placeSearch_CallBack(data) { //infoWindow.open(map, result.lnglat);
            var poiArr = data.poiList.pois;
            var location = poiArr[0].location;
            infoWindow.setContent(createContent(poiArr[0]));
            infoWindow.open(map, location);
        }
        function createContent(poi) {  //信息窗体内容
            var s = [];
            s.push('<div class="info-title">' + poi.name + '</div><div class="info-content">' + "地址：" + poi.address);
            s.push("电话：" + poi.tel);
            s.push("类型：" + poi.type);
            s.push('<div>');
            return s.join("<br>");
        }
```

##### 设置鼠标的样式

```
       //设置鼠标的样式  default  pointer move crosshair
        map.setDefaultCursor("crosshair");
```

#### 覆盖物与图层管理

##### 覆盖物的添加与移除

```
    //构造点标记
    marker = new AMap.Marker({
        icon: "https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",    //标记图标
        position: [113.1553, 23.0632]                                       //标记放置点
        
    })
    //添加点标记
    //map.add(marker);
    

    //删除点标记
    function removeMarker() {
        map.remove(marker);
    }

    //构造矢量图形
    var circle = new AMap.Circle({
        center: new AMap.LngLat("116.1553", "23.0632"),  //圆心位置
        radius: 1000,                                   //半径
        strokeColor: "#F33",                            //线颜色
        strokeOpacity: 1,                               //线透明度
        strokeWeight: 3,                                //线粗细度
        fillColor: "#ee2200",                           //填充颜色
        fillOpacity: 0.35                               //填充透明度
    })

    //添加矢量图形
    map.add(circle);
    map.setFitView();     //自适应显示 
```

##### 图层的添加与移除

```
    //构建卫星图层
    var satelliteLayer = new AMap.TileLayer.Satellite();
    //添加卫星图层
    //map.add(satelliteLayer)

    //构建路网图层
    var roadNetLayer = new AMap.TileLayer.RoadNet();
    //添加路网图层
    //map.add(roadNetLayer);

    //添加路网和卫星图层
    map.add([satelliteLayer, roadNetLayer]);

    //删除路网图层和卫星图层
    //map.remove([satelliteLayer, roadNetLayer]);
```

#### 地图属性

##### 中英文地图

```
    var map = new AMap.Map("container", {
        resizeEnable: false,
        center: [116.397428, 39.90923],
        zoom: 5,
        lang: "zh"   //可选取 en,zh_en,zh_cn
    })
    
    function setLang(id) {
        //更改地图语言
        map.setLang(id);
    }
    setLang('en')
```

##### 获取地图级别与中心点坐标

```
    //获取地图层级与中心信息
        //地图级别
        var zoom = map.getZoom()
        //地图中心点位置
        var center = map.getCenter();
        //绑定地图移动事件
        map.on("moveend", function () { console.log(zoom, center.toString()) })
        //绑定地图缩放事件   
        map.on("zoomend", function () {console.log(zoom, center.toString())})
```

##### 设置地图中心点/级别

```
    //获取地图层级与中心信息
        //地图级别
        var zoom = map.getZoom()
        //地图中心点位置
        var center = map.getCenter();
        //绑定地图移动事件
        map.on("moveend", function () { console.log(zoom, center.toString()) })
        //绑定地图缩放事件   
        map.on("zoomend", function () {console.log(zoom, center.toString())})

    //设置地图中心点/级别
        var zoom = Math.floor(Math.random() * 7) + 11;  // 11—18
        //设置地图层级
        map.setZoom(zoom);
        
        //经度范围
        var lng = 121.138398 + Math.floor(Math.random() * 589828) / 1e6;
        //纬度范围
        var lat = 30.972688 + Math.floor(Math.random() * 514923) / 1e6;
        //设置地图中心点
        map.setCenter([lng, lat]);

    
    var zoom = Math.floor(Math.random() * 7) + 11;
    var lng = 121.138398 + Math.floor(Math.random() * 589828) / 1e6;
    var lat = 30.972688 + Math.floor(Math.random() * 514923) / 1e6;
    //同时设置地图层级与中心点
    map.setZoomAndCenter(zoom, [lng, lat]);
```

##### 获取地图当前行政区

```
    // 获取地图当前行政区
    function demo() {
        map.getCity(function (info) {
            var arr = [info.province, info.city, info.citycode, info.district];
            console.log(arr);
        })
    }
    // 绑定地图移动事件
    map.on("moveend", demo);
```

##### 设置地图当前行政区

```
    var val = window.prompt('input');
    map.setCity(val);
```

##### 设置/获取地图显示范围

```
        // 获取地图显示范围
        var norTheast = map.getBounds().northeast.toString();
        var southWest = map.getBounds().southwest.toString();
        console.log(norTheast);
        console.log(southWest);

        // 设置地图显示范围
        var myBounds = new AMap.Bounds([116.319665, 39.855919], [116.468324,39.9756]);
        map.setBounds(myBounds);
```

##### 限制地图显示范围

```
    // 限制地图显示范围
    function lockMapBounds() {
        var bounds = map.getBounds();
        map.setLimitBounds(bounds);
    }	
    // 取消地图显示范围
    function unlockMapBounds() {
        map.clearLimitBounds();
    }
```

##### 地图的平移

```
        function demo() {
            // 地图的像素值平移
            map.panBy(50, 100);
            //地图的中心点平移
            map.panTo([116.405467, 39.907761]);
        }
```

#### 自定义地图样式

##### 自定义地图

```
    // 构建地图
    var map = new AMap.Map('container', {
        // 是否监听视口大小的变化
        resizeEnable: true,
        // 地图初始的位置
        content: [113.1553, 23.0632],
        // 显示地图缩放的级别
        zoom: 10,
        //可选值：en, zh_en, zh_cn
        lang: "zh_cn",
        // 自定义地图样式
        mapStyle: "amap://styles/baad3f75d5b9bc83f59d803b8ef1facd"
    });
```

##### 设定楼块样式

```
 // 构建楼层模块
    var buildingLayer = new AMap.Buildings({
        zIndex:10000,  //楼层高度
        merge: false,  // 不着色
        sort: false,
        zooms:[17,20]
    });

    // 构建地图
    var map = new AMap.Map('container', {
        // 是否监听视口大小的变化
        resizeEnable: true,
        // 地图初始的位置
        center:[116.472268,39.995693],
        // 显示地图缩放的级别
        zoom: 17,
        //可选值：en, zh_en, zh_cn
        lang: "zh_cn",
        pitch: 50,
        showIndoorMap: false,
        showLabel: false,
        mapStyle: "amap://styles/gray",  // 自定义地图样式
        features: ["bg", "point", "road"],
        viewMode: "3D",
        layers: [
            new AMap.TileLayer({}),
            buildingLayer
        ]
    });

    var options = {
            hideWithoutStyle:false,//是否隐藏设定区域外的楼块
            areas:[{ //围栏1
                // visible:false,//是否可见
                rejectTexture: true,//是否屏蔽自定义地图的纹理
                color1: 'ffffff00',//楼顶颜色
                color2: 'ffffcc00',//楼面颜色
                path: [[116.473606,39.995997],[116.473005,39.995482],[116.472442,39.994971],[116.472267,39.994801],[116.471307,39.995442],[116.471242,39.995446],[116.471163,39.995403],[116.4703,39.994639],[116.469916,39.994315],[116.469194,39.993719],[116.469032,39.993863],[116.468815,39.994108],[116.468625,39.994355],[116.468471,39.99466],[116.468421,39.994811],[116.468366,39.995156],[116.468306,39.996157],[116.468308,39.996557],[116.468483,39.996884],[116.468834,39.997188],[116.469481,39.997764],[116.470511,39.998708],[116.471404,39.999517],[116.471553,39.999568],[116.471713,39.999563],[116.471929,39.999463],[116.473228,39.998584],[116.474008,39.998046],[116.474541,39.997674],[116.474541,39.997576],[116.474604,39.997049],[116.474586,39.996895],[116.474179,39.996516],[116.473585,39.995997],[116.473606,39.995997]]
            }, { //围栏2
                color1: 'ff99ff00',
                color2: 'ff999900',
                path: [[116.474609,39.993478],[116.474489,39.993495],[116.473693,39.994009],[116.472898,39.994546],[116.472837,39.9946],[116.4728,39.994653],[116.472779,39.994745],[116.47282,39.994815],[116.47491,39.99655],[116.475041,39.996607],[116.47525,39.996643],[116.475715,39.996686],[116.475947,39.996688],[116.476103,39.996658],[116.477228,39.995932],[116.477261,39.995833],[116.477264,39.995729],[116.477205,39.995625],[116.47642,39.994899],[116.474854,39.993558],[116.47469,39.99348],[116.474609,39.993478]]
            }]
        };
    buildingLayer.setStyle(options); //此配色优先级高于自定义mapStyle

    map.addControl(new AMap.Scale());

    new AMap.Polygon({
        bubble: true,
        fillOpacity: 0.4,
        strokeWeight: 1,
        path: options.areas[0].path,
        map: map
    })
    new AMap.Polygon({
        bubble: true,
        fillColor: "green",
        fillOpacity: 0.2,
        strokeWeight: 1,
        path: options.areas[1].path,
        map: map
    })
```

#### 坐标系转换

##### 经纬度 <-> 地图容器像素坐标

###### 使用[ lnglatTocontainer ](https://lbs.amap.com/api/javascript-api/reference/map)和[ containTolnglat ](https://lbs.amap.com/api/javascript-api/reference/map)将经纬度坐标与地图容器像素坐标相互转换。

```
    //经纬度坐标转成地图容器像素坐标
    var inputVal = [115.263579, 25.596496];
    var lnglat = new AMap.LngLat(inputVal[0], inputVal[1]);             
     var pixel = map.lnglatTocontainer(lnglat);
    var a = pixel.round();
    console.log(a);

    //地图容器像素坐标转经纬度坐标
    var pixel = new AMap.Pixel(inputVal[0], inputVal[1]);
    var lnglat = map.containerToLngLat(pixel);
    console.log(lnglat);
```

#####  经纬度 <-> 平面像素坐标

###### 使用[ lnglatToPixel ](https://lbs.amap.com/api/javascript-api/reference/map)和[ pixelToLngLat ](https://lbs.amap.com/api/javascript-api/reference/map)将经纬度坐标与平面像素坐标相互转换。

```
    //经纬度坐标转换成平面像素坐标
    var inputVal = [107956, 49683];
    var zoom = map.getZoom();
    var lnglat = new AMap.LngLat(inputVal[0], inputVal[1]);
    var pixel = map.lnglatToPixel(lnglat, zoom);
    pixel.x = parseInt(pixel.x);
    pixel.y = parseInt(pixel.y);
    console.log(pixel);

    //平面像素坐标转成经纬度坐标
    var zoom = map.getZoom();
    var pixel = new AMap.Pixel(inputVal[0], inputVal[1]);
    var lnglat = map.pixelToLngLat(pixel, zoom);
    console.log(lnglat);
```

##### 经纬度 <-> 三维坐标

###### 使用[ lngLatToGeodeticCoord ](https://lbs.amap.com/api/javascript-api/reference/maps-3d)和[ geodeticCoordToLngLat ](https://lbs.amap.com/api/javascript-api/reference/maps-3d)将经纬度坐标与三维坐标相互转换

```
    //经纬度坐标转成三维坐标
    var input = [5825164, -5226986]
    var lnglat = new AMap.LngLat(input[0], input[1]);
    var pixel = map.lngLatToGeodeticCoord(lnglat);
    pixel.x = parseInt(pixel.x);
    pixel.y = parseInt(pixel.y);
    console.log(pixel);

    //三维坐标转成经纬度坐标
    var zoom = map.getZoom();
    var pixel = new AMap.Pixel(input[0], input[1]);
    var lnglat = map.geodeticCoordToLngLat(pixel);
    console.log(lnglat);
```

#### 其他坐标转高德坐标

```
  //创建gps坐标位置点标记
    var lnglat = [116.46706996, 39.99188446];
    var m1 = new AMap.Marker({
        position: lnglat,
        icon: "https://webapi.amap.com/theme/v1.3/markers/n/mark_r.png"
    });
    //添加点标记
    map.add(m1);
    //设置点标记文本标签内容
    m1.setLabel({
        offset: new AMap.Pixel(20, 20),     //设置文本标注偏移量
        content: "GPS坐标系中首开广场"
    });
    var m2;

    //坐标转换
    //百度
    function convertFrom(lnglat, type) {
        AMap.convertFrom(lnglat, type, function (status, result) {
            if (result.info == "ok") {
                var resLnglat = result.locations[0];
                m2 = new AMap.Marker({
                    positon: resLnglat
                });
                map.add(m2);
                //设置标签
                m2.setLabel({
                    offset: new AMap.Pixel(20, 20),
                    content: "高德坐标系（正确）"
                })
            }
        })
    }
    convertFrom(lnglat, "gps");

    function setCoordinate() {
        var type = this.id;
        var text = "GPS坐标系中首开广场";

        if (type == "mapbar") {
            text = "图吧坐标系中首开广场";
            lnglat = [116.46179996, 39.99241446];
        } else if (type == "baidu") {
            text = "百度坐标系中首开广场";
            lnglat = [116.4798674287, 39.9989020876];
        } else if (type === "gps") {
            lnglat = [116.46706996, 39.99188446];
        }
        m1.setLabel({
            offset: new AMap.Pixel(20, 20),
            content: text
        });
        m1.setPosition(lnglat);
        map.remove(m2);

        //坐标系转换
        convertFrom(lnglat, type);
    }

    var radios = document.querySelectorAll("#coordinate input");
    radios.forEach(function (ratio) {
        ratio.onclick = setCoordinate;
    });
```

##### 其他坐标 -> 高德坐标 （批量）

```
 var $ = function (elementId) {
            return document.getElementById(elementId);
        };
        var lnglats = [
            '116.368904,39.913423',
            '116.398258,39.904600'
        ];

        // 创建包含4个节点的折线及文字标注
        var path = [
            new AMap.LngLat(116.368904, 39.913423),
            new AMap.LngLat(116.398258, 39.904600)
        ];
        // 创建折线实例
        var polyline = new AMap.Polyline({
            path: path,
            borderWeight: 2, // 线条宽度，默认为 1
            strokeColor: 'red', // 线条颜色
            lineJoin: 'round' // 折线拐点连接处样式
        });
        // 将折线添加至地图实例
        map.add(polyline);

        var text1 = new AMap.Text({
            position: new AMap.LngLat(116.368904, 39.913423),
            text: 'gps坐标',
            offset: new AMap.Pixel(-20, -20)
        })
        map.add(text1);
        var polyline2;
        var text2;

        // 坐标转换
        AMap.convertFrom(path, 'gps', function (status, result) {
            if (result.info === 'ok') {
                var path2 = result.locations;
                polyline2 = new AMap.Polyline({
                    path: path2,
                    borderWeight: 2, // 线条宽度，默认为 1
                    strokeColor: 'blue', // 线条颜色
                    lineJoin: 'round' // 折线拐点连接处样式
                });
                map.add(polyline2);
                text2 = new AMap.Text({
                    position: result.locations[0],
                    text: '高德坐标',
                    offset: new AMap.Pixel(-20, -20)
                })
                map.add(text2);

            }
        });

        function setCoordinate() {
            var type = this.id;
            var m1Text = "GPS 坐标";
            if (type == 'mapbar') {
                m1Text = '图吧坐标';
            } else if (type == 'baidu') {
                m1Text = '百度坐标';
            }
            map.remove(polyline2);
            map.remove(text2);
            text1.setText(m1Text);

            // 坐标转换
            AMap.convertFrom(path, type, function (status, result) {
                if (result.info === 'ok') {
                    var path2 = result.locations;
                    polyline2 = new AMap.Polyline({
                        path: path2,
                        borderWeight: 2, // 线条宽度，默认为 1
                        strokeColor: 'blue', // 线条颜色
                        lineJoin: 'round' // 折线拐点连接处样式
                    });
                    map.add(polyline2);
                    text2 = new AMap.Text({
                        position: result.locations[0],
                        text: '高德坐标',
                        offset: new AMap.Pixel(-20, -20)
                    })
                    map.add(text2);
                }
            });
        }
        //绑定radio点击事件
        var radios = document.querySelectorAll("#coordinate input");
        radios.forEach(function (ratio) {
            ratio.onclick = setCoordinate;
        });
```

#### 地图事件

##### 地图加载完成事件

###### 监听Map的complete事件，可在该事件回调里添加基于地图的其它逻辑代码。

```
        //构建地图
        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.388904, 39.913423],
            zoom: 14
        });

        //监听地图加载事件
        map.on("complete", function () {
            console.log("地图加载完成");
        })
```

##### 室内加载完成

###### 监听室内图层的 complete 事件，确认室内图层加载完成后执行其他操作

```
    // 室内加载完成事件
    AMap.plugin(["AMap.IndoorMap"], function () {
        //设定在没有矢量底图的时候也显示，默认情况下室内图仅在有矢量底图的时候显示
        var indoorMap = new AMap.IndoorMap({alwaysShow: true});
        //构建地图
        var map = new AMap.Map("container", {
            showIndoorMap: false,   //隐藏地图自带的室内地图图层
            layers: [indoorMap, new AMap.TileLayer()]       //地图图层数组
        });
        indoorMap.showIndoorMap("B000A856LJ");
        indoorMap.on("complete", function () {
            log.success("室内图层加载完成");
        })
    })
```

##### 地图移动事件

###### 绑定和解绑 Map 的 movestart、mapmove 等地图移动相关事件。

```
   //构建地图
    var map = new AMap.Map("container", {
        resizeEnable: true      //监听地图的大小变化
    });

    var logMapinfo = function () {
        var zoom = map.getZoom();       //获取当前地图级别
        var center = map.getCenter();       //获取当前地图坐标
        console.log(center);
    }
    // 监听地图移动事件
    function moveOn() {
        // 绑定事件
        map.on("mapmove", logMapinfo);
    }
    function moveOff() {
        // 取消绑定
        map.off("mapmove", logMapinfo);
    }
```

##### 地图缩放事件

###### 绑定和解绑 Map 的 zoomstart、zoomend 等地图缩放相关事件

```
    //构建地图
    var map = new AMap.Map("container", {
        resizeEnable: true      //监听地图的大小变化
    });

    var logMapinfo = function () {
        var zoom = map.getZoom();   //获取当前地图级别
        console.log(zoom);
    }
    // 监听地图缩别事件
    map.on("zoomchange", logMapinfo);
```

#####  地图点击和鼠标事件

###### 监听Map的click事件，获取用户在地图上的点击位置信息。可用于坐标拾取等场景

```
    // 地图缩放事件
        //构建地图
        var map = new AMap.Map("container", {
            resizeEnable: true      //监听地图的大小变化
        });

    function Click() {console.log("你点击了鼠标");}
    function dbClik() {console.log("你双击了鼠标");}
    function move() {console.log("你移动了鼠标");}
        // 绑定鼠标
        function clickOn() {
            //单击事件
            map.on("click", Click);
            //双击事件
            map.on("dblclick", dbClik);
            //移动事件
            map.on("mousemove", move);
        }
        clickOn();

        // 解除鼠标
        function clickOff() {
            //单击事件
            map.off("click", Click);
            //双击事件
            map.off("dblclick", dbClik);
            //移动事件
            map.off("mousemove", move);
        }
```

##### 地图拖拽相关事件

###### 绑定和解绑 Map 的 dragstart、dragging 等拖拽相关事件

```
 //构建地图
        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.388904, 39.913423],
            zoom: 14
        });

        function showInfoDragstart() {
            console.log("开始拖拽");
        }
        function showInfoDragging() {
            console.log("拖拽中");
        }
        function showInfoDragend() {
            console.log("拖拽完成");
        }
        //绑定地图拖拽事件
        function clickOn() {
            console.log("绑定事件");
            map.on("dragstart", showInfoDragstart);
            map.on("dragging", showInfoDragging);
            map.on("dragend", showInfoDragend);
        }
        //解除地图拖拽事件
        function clickOff() {
            console.log("解除事件绑定");
            map.off("dragstart", showInfoDragstart);
            map.off("dragging", showInfoDragging);
            map.off("dragend", showInfoDragend);
        }
```

#### 覆盖物事件

##### 覆盖物点击和鼠标事件

###### 绑定和解绑覆盖物的 click、mouseover、mouseout 等点击相关事件

```
        //构建点标记
        var marker = new AMap.Marker({
            map: map,
            icon: "https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",    //点标记图片
            position: [116.405467, 39.907761]       //位置，默认为地图的中心点
        });

        var lineArr = [
            [116.368904, 39.913423],
            [116.382122, 39.901176],
            [116.387271, 39.912501],
            [116.398258, 39.904600]
        ];

        //构建圆
        var circle = new AMap.Circle({
            map: map,
            center: lineArr[0],     //设置线覆盖路径
            radius: 1500,           //圆的半径/米
            strokeColor: "#3366FF",     //边框线颜色
            strokeOpacity: 0.3,     //边框线透明度
            strokeWeight: 3,        //边框线宽
            fillColor: "#FFA500",        //填充色
            fillOpacity: 0.35       //填充色透明度
        });

        var polylineArr = [
            [116.403322, 39.920255],
            [116.410703, 39.897555],
            [116.402292, 39.892353],
            [116.389846, 39.891365]
        ];

        //构建折线
        var polygon = new AMap.Polygon({
            map: map,
            path: polylineArr,      //坐标数组
            strokeColor: "#FF33FF",     //线颜色
            strokeOpacity: 0.2,      //线透明度
            strokeWeight: 3,        //线宽
            fillColor: "#1791fc",    //填充颜色
            fillOpacity: 0.35        //填充透明度
        })
        map.setFitView();

        function showInfoM(e) {
            var text = "你在[" + e.lnglat.getLng() + "," + e.lnglat.getLat() + "]的位置点击了marker";
            console.log(text);
        }
        function showInfoC(e) {
            var text = "您在[" + e.lnglat.getLng() + "," + e.lnglat.getLat() + "]的位置点击了圆";
            console.log(text);
        }
        function showInfoP(e) {
            var text = "您在[" + e.lnglat.getLng() + "," + e.lnglat.getLat() + "]的位置点击了多边形";
            console.log(text);
        }

        function showInfoOver(e) {
            var text = "鼠标移入覆盖物";
            console.log(text);
        }
        function showInfoOut(e) {
            var text = "鼠标移出覆盖物";
            console.log(text);
        }


        //绑定事件
        function clickOn() {
            marker.on("click", showInfoM);
            circle.on("click", showInfoC);
            polygon.on("click", showInfoP);

            circle.on("mouseover", showInfoOver);
            circle.on("mouseout", showInfoOut);

            polygon.on("mouseover", showInfoOver);
            polygon.on("mouseout", showInfoOut);
        }
        //解除事件
        function clickOff() {
            marker.off("click", showInfoM);
            circle.off("click", showInfoC);
            polygon.off("click", showInfoP);

            circle.off("mouseover", showInfoOver);
            circle.off("mouseout", showInfoOut);

            polygon.off("mouseover", showInfoOver);
            polygon.off("mouseout", showInfoOut);
        }
```

##### 覆盖物拖拽相关事件

###### 绑定和解绑覆盖物的dragging 等拖拽相关事件

```
    //构建点标记
    var marker = new AMap.Marker({
        map: map,
        icon: "https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",    //点标记图标
        draggable: true        //是否可拖拽
    });
    var lineArr = [
        [116.368904, 39.913423],
        [116.382122, 39.901176],
        [116.387271, 39.912501],
        [116.398258, 39.904600]
    ];
    //构建圆
    var circle = new AMap.Circle({
        map: map,
        center: lineArr[0],     //设置线覆盖物路径
        radius: 1500,       //圆的半径
        strokeOpacity: 0.3,      //边框线的透明度
        strokeColor: "#3366FF",     //边框线颜色
        strokeWeight: 3,        //边框线宽
        fillColor: "#FFA500",       //填充颜色
        fillOpacity: .35,       //填充透明度
        draggable: true,        //是否可拖拽
    });

    var polygonArr = [[116.403322, 39.920255],
        [116.410703, 39.897555],
        [116.402292, 39.892353],
        [116.389846, 39.891365]];

    var polygon = new AMap.Polygon({
        map: map,
        path: polygonArr,   //设置多边形路径
        strokeColor: "#FF33FF",     //线的颜色
        strokeOpacity: .2,  //线透明度
        strokeWeight: 3,        //线宽度
        fillColor: "#1791fc",        //填充色
        fillOpacity: .35,        //填充透明度
        draggable: true     //是否可拖拽
    });

    map.setFitView();


    function showInfoM(e) {
        console.log("Maker移动");
    }
    function showInfoC(e) {
        console.log("圆移动");
    }
    function showInfoP(e) {
        console.log("多边形移动");
    }

    // 绑定拖拽事件
    function clickOn() {
        marker.on("dragging", showInfoM);
        circle.on("dragging", showInfoC);
        polygon.on("dragging", showInfoP);
    }
    // 清除拖拽
    function clickOff() {
    marker.off("dragging", showInfoM);
    circle.off("dragging", showInfoC);
    polygon.off("dragging", showInfoP);
    }xxxxxxxxxx         //构建点标记        var marker = new AMap.Marker({            map: map,            icon: "https://webapi.amap.com/theme/v1.3/m    //构建点标记    var marker = new AMap.Marker({        map: map,        icon: "https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",    //点标记图标        draggable: true        //是否可拖拽    });    var lineArr = [        [116.368904, 39.913423],        [116.382122, 39.901176],        [116.387271, 39.912501],        [116.398258, 39.904600]    ];    //构建圆    var circle = new AMap.Circle({        map: map,        center: lineArr[0],     //设置线覆盖物路径        radius: 1500,       //圆的半径        strokeOpacity: 0.3,      //边框线的透明度        strokeColor: "#3366FF",     //边框线颜色        strokeWeight: 3,        //边框线宽        fillColor: "#FFA500",       //填充颜色        fillOpacity: .35,       //填充透明度        draggable: true,        //是否可拖拽    });    var polygonArr = [[116.403322, 39.920255],        [116.410703, 39.897555],        [116.402292, 39.892353],        [116.389846, 39.891365]];    var polygon = new AMap.Polygon({        map: map,        path: polygonArr,   //设置多边形路径        strokeColor: "#FF33FF",     //线的颜色        strokeOpacity: .2,  //线透明度        strokeWeight: 3,        //线宽度        fillColor: "#1791fc",        //填充色        fillOpacity: .35,        //填充透明度        draggable: true     //是否可拖拽    });    map.setFitView();    function showInfoM(e) {        console.log("Maker移动");    }    function showInfoC(e) {        console.log("圆移动");    }    function showInfoP(e) {        console.log("多边形移动");    }    // 绑定拖拽事件    function clickOn() {        marker.on("dragging", showInfoM);        circle.on("dragging", showInfoC);        polygon.on("dragging", showInfoP);    }    // 清除拖拽    function clickOff() {    marker.off("dragging", showInfoM);    circle.off("dragging", showInfoC);    polygon.off("dragging", showInfoP);    }arkers/n/mark_b.png",    //点标记图标            draggable: true        //是否可拖拽         });        var lineArr = [            [116.368904, 39.913423],            [116.382122, 39.901176],            [116.387271, 39.912501],            [116.398258, 39.904600]        ];        //构建圆        var circle = new AMap.Circle({            map: map,            center: lineArr[0],     //设置线覆盖物路径            radius: 1500,       //圆的半径            strokeOpacity: 0.3,      //边框线的透明度            strokeColor: "#3366FF",     //边框线颜色            strokeWeight: 3,        //边框线宽            fillColor: "#FFA500",       //填充颜色            fillOpacity: .35,       //填充透明度            draggable: true,        //是否可拖拽        });        var polygonArr = [[116.403322, 39.920255],        [116.410703, 39.897555],        [116.402292, 39.892353],        [116.389846, 39.891365]];        var polygon = new AMap.Polygon({            map: map,            path: polygonArr,   //设置多边形路径            strokeColor: "#FF33FF",     //线的颜色            strokeOpacity: .2,  //线透明度            strokeWeight: 3,        //线宽度            fillColor: "#1791fc",        //填充色            fillOpacity: .35,        //填充透明度            draggable: true     //是否可拖拽        });        map.setFitView();
```

##### 信息窗体打开关闭事件

###### 监听信息窗体的 open 和 close 事件

```
var infoWindow;
        function showInfoOpen() {
            console.log("您打开了信息窗体");
        }
        function showInfoClose() {
            console.log("您关闭了信息窗体");
        }

        //在指定位置打开信息窗体
        function openInfo() {
            var info = [];
            info.push("<div><div><img style=\"float:left;\" src=\" https://webapi.amap.com/images/autonavi.png \"/></div> ");
            info.push("<div style=\"padding:0px 0px 0px 4px;\"><b>高德软件</b>");
            info.push("电话 : 010-84107000   邮编 : 100102");
            info.push("地址 :北京市朝阳区望京阜荣街10号首开广场4层</div></div>");
            infoWindow = new AMap.InfoWindow({
                content: info.join("<br/>")    //使用默认信息窗体框样式，显示信息内容
            });
            infoWindow.on("open", showInfoOpen);
            infoWindow.on("close", showInfoClose);
            infoWindow.open(map, map.getCenter());
        }
        function closeInfo() {
            infoWindow.close();
        }
```

#### 其他事件

##### DOM事件的绑定与解绑

###### 在其它DOM元素的click事件里，和地图做交互操作

```
     function createMarker() {
            removeMarker();   //防止重复绑定
            // 创建事件
            clickListener = AMap.event.addListener(map, "click", function (e) {
                new AMap.Marker({
                    position: e.lnglat,
                    map: map
                })
            })
        }
        function removeMarker() {
            if(clickListener) {
                //移除事件
                AMap.event.removeListener(clickListener);
            }
        }

```

##### 自定义事件

###### 使用Map的emit和on方法，绑定和触发自定义事件.

```
        var count = 0,
            marker;
        function _onClick(e) {
            new AMap.Marker({
                position: e.lnglat,
                map: map
            });
            map.emit("count", { "count": count++ });      //触发自定义事件 
        }

        map.on("count", console.log(count));    //绑定自定义事件

        function createMarker() {
            removeMarker(); 
            marker = AMap.event.addListener(map, "click", _onClick);
        }

        function removeMarker() {
            if (marker) {
                AMap.event.removeListener(marker);
            }
        }
```

##### 事件模拟触发

###### 使用 emit 模拟事件触发。本例通过模拟click点击事件打开信息窗体

```
        var clickHandler = function (e) {
            new AMap.InfoWindow({
                content: "模拟事件触发"
            }).open(map, e.lnglat);

        }
        map.on("click", clickHandler);
```

#### 图层通用接口

##### 批量修改图层

###### 使用[LayerGroup](https://lbs.amap.com/api/javascript-api/reference/layer#AMap.LayerGroup)对图层做批量修改

```
 		//构建交通图层
        var trafficLayer = new AMap.TileLayer.Traffic({
            zIndex: 11
        });
        //构建网路图层
        var roadNetLayer = new AMap.TileLayer.RoadNet({
            zIndex: 10
        });

        var massMarks = new AMap.MassMarks(citys, {
            opacity: .8,
            zIndex: 12,
            style: [
                {
                    url: 'https://a.amap.com/jsapi_demos/static/images/mass0.png',
                    anchor: new AMap.Pixel(6, 6),
                    size: new AMap.Size(11, 11)
                }, {
                    url: 'https://a.amap.com/jsapi_demos/static/images/mass1.png',
                    anchor: new AMap.Pixel(4, 4),
                    size: new AMap.Size(7, 7)
                }, {
                    url: 'https://a.amap.com/jsapi_demos/static/images/mass2.png',
                    anchor: new AMap.Pixel(3, 3),
                    size: new AMap.Size(5, 5)
                }
            ]
        });
        
        var layerGroup = new AMap.LayerGroup([trafficLayer, roadNetLayer]);
        layerGroup.setMap(map);

        //随机修改图层透明度
        function randomOpacity() {
            layerGroup.setOptions({ opacity: Math.random() })
        }

        //重载图层
        function reloadingLayer() {
            if (layerGroup) {
                layerGroup.reload();
            }
        }
```

##### 图层的添加与移除

###### 操作图层进行添加 setMap(map)、移除 setMap(null) 操作。

```
        //构建卫星图层
        var satellite = new AMap.TileLayer.Satellite({
            map: map
        });

        //添加图层
        function addLayer() {
            satellite.setMap(map);
        }

        //删除图层
        function rmLayer() {
            satellite.setMap(null);
        }

        //显示图层
        function showLayer() {
            satellite.show();
        }

        //隐藏图层
        function hideLayer() {
            satellite.hide();
        }
```

##### 层级设定

###### 通过 setzIndex() 方法设置图层的层级。

```
        //构建卫星图层
        var satellite = new AMap.TileLayer.Satellite({
            map: map,
            zIndex: 12,
            opacity: .8
        });

        //构建网路图层
        var roadNetLayer = new AMap.TileLayer.RoadNet({
            map: map,
            zIndex: 18,
            opacity: .8
        });

        function change1(z) {
            //设置zIndex属性
            satellite.setzIndex(z);
        }

        function change2(z) {
            //设置zIndex属性
            roadNetLayer.setzIndex(z);
        }
```

##### 图层透明度

###### 对图层进行透明度调节。setOpacity(value)。

```
        //构建卫星图层
        var satellite = new AMap.TileLayer.Satellite({
            map: map,
            opacity: .6
        });

        //修改图层透明度
        function setOpacity(val) {
            satellite.setOpacity(val);
        }
```

#### 高德官方图层

```
		//构建地图
        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.473188, 39.993253],
            zoom: 10,
            layers: [
                //new AMap.TileLayer(),   //高德默认标准图层，只显示默认图层的时候，layers可以省略
                new AMap.TileLayer.Satellite(),     //卫星
                new AMap.TileLayer.RoadNet()        //路网
            ]
        });

        //构建实时路况
        var trafficLayer = new AMap.TileLayer.Traffic({
            zIndex: 10
        }) 
        trafficLayer.setMap(map);
        var isVisible = true;
        function toggle() {
            if (isVisible) {
                trafficLayer.hide();
                isVisible = false;
            } else {
                trafficLayer.show();
                isVisible = true;
            }
        }

        //构建地图
        var map = new AMap.Map("container", {
            center: [116.397428, 39.90923],
            viewMode: "3D",
            pitch: 60,
            rotation: -35,
            //隐藏默认楼块
            features: ["bg", "road", "point"],
            mapStyle: "amap://styles/light",
            layers: [
                new AMap.TileLayer.Satellite(), //高德标准默认图层
                //楼块图层
                new AMap.Buildings({
                    zooms: [16, 18],
                    zIndex: 10,
                    heightFactor: 2     //2倍于默认高度，3D下有效
                })
            ],
            zoom: 16
        });
```

#### 简易行政区图

##### 世界

```
  var SOC = "EN";
        var colors = {};
        var getColorBySOC = function (SOC) {
            if (SOC) {
                if (!colors[SOC]) {
                    var R = SOC.charCodeAt(0) * 2;
                    var G = R;
                    var B = 255;
                    colors[SOC] = `rgb(${R}, ${G}, ${B})`;
                }
                return colors[SOC];
            } else {
                return "rgb(200, 200, 240)"
            }
        }
        //构建世界区域
        var disWorld = new AMap.DistrictLayer.World({
            zIndex: 10,
            styles: {
                "nation-stroke": function (props) {
                    if (props.type == "Nation_Border_China") {
                        return "red"
                    } else {
                        return "white"
                    }
                },
                "fill": function (props) {
                    return getColorBySOC(props.SOC);
                }
            }
        });
        var map = new AMap.Map("container", {
            zooms: [3, 15],
            center: [100, 36],
            showIndoorMap: false,
            isHotspot: false,
            defaultCursor: "pointer",
            touchZoomCenter: 1,
            pitch: 0,
            layers: [disWorld],
            viewMode: "3D",
            resizeEnable: true,
            zoom: 3
        })

        map.addControl(new AMap.Scale());
        map.addControl(new AMap.ToolBar({ liteStyle: true }));
```

#### 中国

```
 var SOC = "CHN";
        var colors = {};
        var GDPSpeed = {
            '520000': 10,//贵州
            '540000': 10,//西藏
            '530000': 8.5,//云南 
            '500000': 8.5,//重庆
            '360000': 8.5,//江西
            '340000': 8.0,//安徽
            '510000': 7.5,//四川
            '350000': 8.5,//福建
            '430000': 8.0,//湖南
            '420000': 7.5, //湖北
            '410000': 7.5,//河南
            '330000': 7.0,//浙江
            '640000': 7.5,//宁夏
            '650000': 7.0,//新疆
            '440000': 7.0,//广东
            '370000': 7.0,//山东
            '450000': 7.3,//广西
            '630000': 7.0,//青海
            '320000': 7.0,//江苏
            '140000': 6.5,//山西
            '460000': 7,// 海南
            '310000': 6.5,//上海
            '110000': 6.5, // 北京
            '130000': 6.5, // 河北
            '230000': 6, // 黑龙江
            '220000': 6,// 吉林
            '210000': 6.5, //辽宁
            '150000': 6.5,//内蒙古
            '120000': 5,// 天津
            '620000': 6,// 甘肃
            '610000': 8.5,// 甘肃
        }
        var getColorByDGP = function (adcode) {
            if (!colors[adcode]) {
                var gdp = GDPSpeed[adcode];
                if (!gdp) {
                    colors[adcode] = "rgb(227, 227, 227)"
                } else {
                    var rg = 255 - Math.floor((gdp - 5) / 5 * 255);
                    colors[adcode] = `rgb(${rg}, ${rg}, 255)`
                }
            }
            return colors[adcode];
        }

        var disCountry = new AMap.DistrictLayer.Country({
            zIndex: 10,
            SOC: "CHN",
            depth: 2,
            styles: {
                "ntion-stroke": "#22ffff",
                "coastline-stroke": [0.85, 0.63, 0.94, 1],
                "province-stroke": "white",
                "city-stroke": "rgba(255, 255, 255, .5)",     //中国特有字段
                "fill": function (props) {
                    //中国特有字段
                    return getColorByDGP(props.adcode_pro)
                }
            }
        });

        var map = new AMap.Map("container", {
            zooms: [3, 10],
            showIndoorMap: false,
            zoom: 3,
            isHotspot: false,
            defaultCursor: "pointer",
            touchZoomCenter: 1,
            pitch: 0,
            layers: [
                disCountry,
                new AMap.TileLayer.Satellite()
            ],
            viewMode: "3D",
            resizeEnable: true
        });

        map.addControl(new AMap.Scale());
        map.addControl(new AMap.ToolBar({ listeStyle: true }));
```

#### 外国

```
        var getColorByRandom = function () {
            var rg = Math.random() * 155 + 50;
            return `rgb(${rg}, ${rg}, 255)`;
        }

        var disCountry = new AMap.DistrictLayer.Country({
            zIndex: 10,
            SOC: "RUS",
            depth: 1,
            styles: {
                "nation-stroke": "#22ffff",
                "conastline-stroke": [0.85, 0.63, 0.94, 1],
                "province-stroke": "white",
                "fill": function (props) {
                    return getColorByRandom()
                }
            }
        });
        var map = new AMap.Map("container", {
            zooms: [3, 10],
            center: [93.729504, 68.718195],
            showIndoorMap: false,
            zoom: 3,
            isHotspot: false,
            defaultCursor: 'pointer',
            touchZoomCenter: 1,
            pitch: 0,
            layers: [
                disCountry,
                new AMap.TileLayer()
            ],
            viewMode: '3D',
            resizeEnable: true
        })
        map.addControl(new AMap.Scale());
        map.addControl(new AMap.ToolBar({ liteStyle: true, offset: new AMap.Pixel(10, 180) }));

        var centers = {
            'RUS': [93.729504, 68.718195],
            'USA': [-113.877655, 52.652266],
            'JPN': [136.824904, 38.00712]
        }
        var changeSoc = function (soc) {
            disCountry.setSOC(soc);
            map.setCenter(centers[soc]);    
        }
```

#### 省区

```
        var adCode = 130000;
        var depth = 2;
        var map = new AMap.Map("container", {
            zoom: 4.5,
            center: [116.412427, 39.303573],
            pitch: 0,
            viewMode: "3D"
        });

        //构建省份图层
        var disProvince;
        function initPro(code, dep) {
            dep = typeof dep == "undefined" ? 2 : dep;
            adCode = code;
            depth = dep;

            disProvince && disProvince.setMap(null);

            disProvince = new AMap.DistrictLayer.Province({
                zIndex: 12,
                adcode: [code],
                depth: dep,
                styles: {
                    "fill": function (properties) {
                        var adcode = properties.adcode;
                        return getColorByAdcode(adcode);
                    },  
                    'province-stroke': 'cornflowerblue',
                    'city-stroke': 'white', // 中国地级市边界
                    'county-stroke': 'rgba(255,255,255,0.5)' // 中国区县边界
                }
            });
            disProvince.setMap(map);
        }
        var colors = {};
        var getColorByAdcode = function (adcode) {
            if (!colors[adcode]) {
                var gb = Math.random() * 155 + 50;
                colors[adcode] = `rgb(${gb}, ${gb}, 255)`;
            }
            return colors[adcode];  
        }

        //选择省份
        function changeAdcode(code) {
            //if (code != 100000) {
                initPro(code, depth);
            //}       
        }
        //选择层级
        //function changeDepth(dep) {
            initPro(adCode, 1);
        //}
        initPro(adCode, depth);
```

#### 图层切换

```
 //构建世界地图国家轮廓
        var disWorld = new AMap.DistrictLayer.World({
            zIndex: 10,
            styles: {
                "nation-stroke": "rgba(20, 20, 233, .6)",        //国境线
                "coastline-stroke": "",      //海岸线
                "fill": ""      //填充

            }
        });
        var tileLayer = new AMap.TileLayer();

        //构建地图
        var map = new AMap.Map("container", {
            zooms: [3, 15],
            center: [0, 20],
            showIndoorMap: false,
            zoom: 3,
            isHotspot: false,
            defaultCursor: "pointer",
            touchZoomCenter: 1,
            pitch: 0,
            layters: [
                tileLayer,
                disWorld
            ],
            viewMode: "3D",
            resizeEnable: true
        });

        //添加图层
        function addLayer() {
            disWorld.setMap(map);
        }
        //移除图层
        function rmLayer() {
            disWorld.setMap(null);
        }
```

#### 行政区拾取+修改样式

```
        var nationStroke = "rgba(20, 20, 120, .6)";
        var nationFill = "rgba(20, 120, 230, .3)";

        var disWorld = new AMap.DistrictLayer.World({
            zIndex: 10,
            styles: {
                "fill": function (props) {
                    if (props.SOC == "CHN") {

                        return nationFill;
                    } else {
                        return "white";
                    }
                }
            }
        });
        var map = new AMap.Map("container", {
            zooms: [3, 18],
            center: [110, 30],
            showIndoorMap: false,
            zoom: 3,
            isHotspot: false,
            defaultCursor: "pointer",
            touchZoomCenter: 1,
            pitch: 0,
            layers: [
                disWorld
            ],
            viewMode: "3D",
            resizeEnable: true
        });
        map.on("click", function (ev) {
            var px = ev.pixel;
            var props = disWorld.getDistrictByContainerPos(px); 
            if (props) {
                var SOC = props.SOC;
                disWorld.setStyles({
                    "fill": function (props) {
                        return props.SOC == SOC ? nationFill : "white";
                    }
                });
                updateInfo(props);
            }
        });

        function updateInfo(props) {
            console.log(props.NAME_CHN);
            console.log(props.NAME_ENG);
            console.log(props.SOC);
        }
```

#### 三方标准图层

##### 卫星图+掩模

```
        var opts = {
            subdistrict: 0,     //返回下一级行政区
            extensions: "all"
        }

        //构建区域
        district = new AMap.DistrictSearch(opts);
        district.search("中国", function (status, result) {
            var bounds = result.districtList[0].boundaries;
            var mask = [];
            for (var i = 0; i < bounds.length; i++) {
                mask.push([bounds[i]]);
            }

            var disCountry = new AMap.DistrictLayer.World({
                zIndex: 0,
                rejectMapMask: true
            });
            var object3Dlayer = new AMap.Object3DLayer({ zIndex: 1 });
            map = new AMap.Map("container", {
                mask: mask,
                center: [116.472804, 39.995725],
                viewMode: "3D",
                labelzIndex: 130,
                zoom: 3,
                cursor: "pointer",
                layers: [
                    new AMap.TileLayer.RoadNet({ zIndex: 7 }),
                    disCountry,
                    object3Dlayer,
                    new AMap.TileLayer.Satellite()
                ]
            });
            var height = -5000;
            var color = "#0088ffcc";
            var prism = new AMap.Object3D.Wall({
                path: bounds,
                height: height,
                color: color
            });
            prism.transparent = true;
            object3Dlayer.add(prism);
        })
```

##### WMTS

###### 使用[TileLayer.WMTS](https://lbs.amap.com/api/javascript-api/reference/wms#wmts)加载OGC标准的WMTS地图

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 3,
            center: [-99.241291, 39.51401]
        });

        var wms = new AMap.TileLayer.WMTS({
            url: 'https://services.arcgisonline.com/arcgis/rest/services/Demographics/USA_Population_Density/MapServer/WMTS/',
            blend: false,
            tileSize: 256,
            params: {
                Layer: "0",
                Version: "1.0.0",
                Format: "image/png",
                TileMatrixSet: "EPSG:3857"
            }
        });

        wms.setMap(map);
```

##### XYZ栅格图层

###### 使用[TileLayer.getTileUrl](https://lbs.amap.com/api/javascript-api/reference/layer#TileLayer)自定义栅格图

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            layers: [new AMap.TileLayer.Satellite()]
        });

        var xyzTileLayer = new AMap.TileLayer({
            //图块取图地址
            getTileUrl: 'https://wprd0{1,2,3,4}.is.autonavi.com/appmaptile?x=[x]&y=[y]&z=[z]&size=1&scl=1&style=8&ltype=11',
            zIndex: 100
        });

        //添加图层
        function addXYZTileLayer() {
            map.add(xyzTileLayer);
        }
        //移除图层
        function rmXYZTileLayer() {
            map.remove(xyzTileLayer);
        }
```

##### 函数加载栅格图

```
        //高德栅格路况
        var traffic = new AMap.TileLayer({
            "getTileUrl": function (x, y, z) {
                var a = 'https://tm.amap.com/trafficengine/mapabc/traffictile?v=1.0&t=1&zoom=' + (17 - z) + '&x=' + x + '&y=' + y;
                return a;
            },
            "zooms": [6, 20],
            "zIndex": 4
        });

        var map = new AMap.Map("container", {
            resizeEnable: true,
            layers: [
                new AMap.TileLayer.Satellite(),
                new AMap.TileLayer.RoadNet(),
                traffic
            ]
        });
```

#### 自有数据图层

##### 图片图层

```
        var imageLayer = new AMap.ImageLayer({
            url: 'http://amappc.cn-hangzhou.oss-pub.aliyun-inc.com/lbs/static/img/dongwuyuan.jpg',
            bounds: new AMap.Bounds(
                [116.327911, 39.939229],
                [116.342659, 39.946275]
            ),
            zooms: [15, 18]
        });
        var map = new AMap.Map("container", {
            rersizeEnable: true,
            center: [116.33719, 39.942384],
            zoom: 15,
            layers: [new AMap.TileLayer(), imageLayer]
        });
```

##### 视频图层

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            viewMode: "3D",
            zoom: 3,
            center: [115.811491, 12.423935]
        });
        var bounds = new AMap.Bounds([93, -9], [147, 32]);
        var VideoLayer = new AMap.VideoLayer({
            autoplay: true,
            loop: true,
            zIndex: 130,
            url: [
                'https://a.amap.com/jsapi_demos/static/video/cloud.m4v',
                'https://a.amap.com/jsapi_demos/static/video/cloud.mov'
            ],
            bounds: bounds,
            zooms: [3, 18],
            opacity: .7
        });
        VideoLayer.setMap(map);
```

##### Canvas图层

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 15,
            center: [116.335183, 39.941735]
        });
        AMap.plugin(["AMap.ControlBar"], function () {
            var bar = new AMap.ControlBar();
            map.addControl(bar);
        });

        //添加Canvas图层
        var canvas = document.createElement("canvas");
        canvas.width = canvas.height = 200;
        var context = canvas.getContext("2d");
        context.fillStyle = "rgb(0, 100, 255)";
        context.strokeStyle = "white";
        context.globalAlpha = 1;
        context.lineWidth = 2;

        var radious = 0;
        var draw = function () {
            context.clearRect(0, 0, 200, 200);
            context.globalAlpha = (context.globalAlpha - 0.01 + 1) % 1;
            radious = (radious + 1) % 100;

            context.beginPath();
            context.arc(100, 100, radious, 0, 2 * Math.PI);
            context.fill();
            context.stroke();

            //2D视图时可以省略
            CanvasLayer.reFresh();

            AMap.Util.requestAnimFrame(draw);
        }

        var CanvasLayer = new AMap.CanvasLayer({
            canvas: canvas,
            bounds: new AMap.Bounds(
                [116.328911, 39.937229],
                [116.342659, 39.946275]
            ),
            zooms: [3, 18]
        });
        CanvasLayer.setMap(map);
        draw();
```

##### 热力图

```
	        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.418261, 39.921984],
            zoom: 11
        });

        if (!isSupportCanvas()) {
            alert('热力图仅对支持canvas的浏览器适用,您所使用的浏览器不能使用热力图功能,请换个浏览器试试~')
        }


        var heatmap;
        map.plugin(["AMap.Heatmap"], function () {
            //初始化heatmap对象
            heatmap = new AMap.Heatmap(map, {
                radius: 25, //给定半径
                opacity: [0, 0.8]

            });
            //设置数据集：该数据为北京部分“公园”数据
            heatmap.setDataSet({
                data: heatmapData,
                max: 100
            });
        });

        //判断浏览区是否支持canvas
        function isSupportCanvas() {
            var elem = document.createElement('canvas');
            return !!(elem.getContext && elem.getContext('2d'));
        }
```

##### 3D热力图

```
  var map = new AMap.Map("container", {
            viewMode: '3D',
            pitch: 70,
            resizeEnable: true,
            center: [116.418261, 39.921984],
            zoom: 11.5
        });

        map.addControl(new AMap.ControlBar({}));

        var heatmapOpts = {
            //3d 相关的参数
            '3d': {
                //热度转高度的曲线控制参数，可以利用左侧的控制面板获取
                heightBezier: [0.4, 0.2, 0.4, 0.8],
                //取样精度，值越小，曲面效果越精细，但同时性能消耗越大
                gridSize: 2,
                heightScale: 1
            }
        };

        //初始化heatmap对象
        var heatmap = new AMap.Heatmap(map, heatmapOpts);

        heatmap.setDataSet({
            data: heatmapData,
            max: 100
        });

        //控制左侧的曲线控制面板
        (function () {

            var bezierInp = document.getElementById('bezierInp');

            function onBezierUpdate(val) {

                bezierInp.value = (val);

                heatmapOpts['3d'].heightBezier = val;

                if (heatmap) {
                    heatmap.setOptions(heatmapOpts);
                }
            }

            bezierHelper.setBezier(heatmapOpts['3d'].heightBezier);

            bezierInp.value = (bezierHelper.getBezier());

            window.onBezierUpdate = onBezierUpdate;

        })();
```

##### 自定义图层-SVG

```
        var starCenter = [116.306206, 39.975468];
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 3,
            center: starCenter

        });
        map.plugin(['AMap.CustomLayer'], function () {
            var size = map.getSize();
            var canvas = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            canvas.setAttribute("xmlns", 'http://www.w3.org/2000/svg');
            canvas.setAttribute("width", size.width);
            canvas.setAttribute("height", size.height);

            path = document.createElementNS("http://www.w3.org/2000/svg", "path");  
            path.onclick = function () {
                console.log("svg path clicked");
            }
            var styleText = [];
            styleText.push("stroke: red");
            styleText.push("fill: green");
            styleText.push("fill-opacity: .3");
            path.style.cssText = styleText.join(";");

            canvas.appendChild(path);

            var customLayer  = new AMap.CustomLayer(canvas, {
                zIndex: 300
            });
            customLayer.render = onRender;
            map.add(customLayer);
        });

        function buildPath() {
            var path = [];
            var center = map.lngLatToContainer(starCenter);
            for (var i = 0; i < 6; i ++) {
                var ag = Math.PI * 60 / 180 * i;
                var x = center.x + Math.cos(ag) * 50;
                var y = center.y + Math.sin(ag) * 50;
                path.push((i == 0 ? "M" : "L") + x + " " + y);
            } 
            return path.join(" ") + "Z";
        }
        //更新路径
        function onRender() {
            var newPath = buildPath();
            path.setAttribute("d", newPath);
        }
```

##### 自定义图层Canvas

###### 使用[CustomLayer](https://lbs.amap.com/api/javascript-api/reference/self-own-layers#customlayer)创建自定义图层，以Canvas作为绘制方式。

```
  //构建图层
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 3,        //缩放级别
            center: [116.306206, 39.975468],    //地图中心点
            zooms: [3, 10]      //缩放级别范围
        });

        function getData(callback) {
            AMap.plugin("AMap.DistrictSearch", function () {
                var search = new AMap.DistrictSearch();
                search.search("中国", function (status, data) {
                    if (status === "complete") {
                        var positions = [];
                        var provinces = data["districtList"][0]["districtList"];

                        for (var i = 0; i < provinces.length; i++) {
                            positions.push({
                                center: provinces[i].center,
                                radius: Math.max(2, Math.floor(Math.random() * 10))
                            })
                        }
                        callback(positions);
                    }
                })
            })
        }


        function addLayer(positions) {
            AMap.plugin("AMap.CustomLayer", function () {
                var canvas = document.createElement("canvas");
                var customLayer = new AMap.CustomLayer(canvas, {
                    zooms: [3, 10],
                    alwaysRender: true,     //是否重绘
                    zIndex: 120,        //层级级别
                });

                var onRender = function () {
                    var retina = AMap.Browser.retina;
                    var size = map.getSize();     //获取样式
                    var width = size.width;
                    var height = size.height;
                    canvas.style.width = width + "px";
                    canvas.style.height = height + "px";

                    if (retina) {//高清适配
                        width *= 2;
                        height *= 2;
                    }
                    canvas.width = width;
                    canvas.height = height; //清除画布

                    var ctx = canvas.getContext("2d");
                    ctx.fillStyle = "#08f";
                    ctx.strokeStyle = "#fff";
                    ctx.beginPath();
                    for (var i = 0; i < positions.length; i++) {
                        var center = positions[i].center;
                        var pos = map.lngLatToContainer(center);
                        var r = positions[i].radius;

                        if (retina) {
                            pos = pos.multiplyBy(2);
                            r *= 2;
                        }
                        ctx.moveTo(pos.x + r, pos.y);
                        ctx.arc(pos.x, pos.y, r, 0, 2 * Math.PI);
                    }
                    ctx.lineWidth = retina ? 6 : 3;
                    ctx.closePath();
                    ctx.stroke();
                    ctx.fill();
                }

                customLayer.render = onRender;
                customLayer.setMap(map);
            });
        }
        getData(addLayer)
```

##### Canvas作为切片

###### 使用[TileLayer.Flexible.createTile](https://lbs.amap.com/api/javascript-api/reference/self-own-layers#flex)将canvas作为切片渲染到地图上，适用于需要自定义切片的场景

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 14,
            zoom: [3, 20],      //缩放级别的范围
            expandZoomRange: true   //支持缩放到最大级别
        });

        var layer = new AMap.TileLayer.Flexible({
            cacheSize: 30,      //切片的数量上限
            zIndex: 200,        //层级
            createTile: function (x, y, z, success, fail) {
                var c = document.createElement("canvas");
                c.width = c.height = 256;

                var ctx = c.getContext("2d");
                ctx.font = "15px Verdana";
                ctx.fillStyle = "#ff0000";      //内容颜色
                ctx.strokeStyle = "blue";       //线颜色
                ctx.strokeRect(0, 0, 256, 256);
                ctx.fillText("(" + [x, y, z].join(",") + ")", 10, 30);

                //通知API切片创建完成
                success(c);
            }
        });
        layer.setMap(map);
```

##### img作为切片

###### 使用[TileLayer.Flexible.createTile](https://lbs.amap.com/api/javascript-api/reference/self-own-layers#flex)自定义图片图层，可用于添加水印等场景。

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 14,
            zoom: [3, 20],      //缩放级别的范围
            expandZoomRange: true   //支持缩放到最大级别
        });

        var layer = new AMap.TileLayer.Flexible({
            cacheSize: 30,  //缓存切片数量上限
            opacity: .3,
            createTile: function (x, y, z, success, fail) {
                if ((x + y) % 2) {
                    fail();
                    return;
                }

                var img = document.createElement("img");
                img.onload = function () {
                    success(img);
                }
                img.onerror = function () {
                    fail()
                }
                img.src = "https://a.amap.com/jsapi_demos/static/images/amap.png";
            }
        });
        layer.setMap(map);
```

#### 室内地图

##### 叠加室内地图

###### 使用[IndoorMap.showIndoorMap](https://lbs.amap.com/api/javascript-api/reference/indoormap)显示指定的室内地图和对应楼层信息，可用于商场、火车站等室内场景的导览图

```
        var indoorMap;
        AMap.plugin(["AMap.IndoorMap"], function () {

            var indoorMap = new AMap.IndoorMap({ alwaysShow: true });

            var map = new AMap.Map("container", {
                resizeEnable: true,
                showIndoorMap: false,        //隐藏地图自带的室内地图图层
                layers: [indoorMap, new AMap.TileLayer()]

            });
            indoorMap.showIndoorMap("B000A856LJ");
        });
```

##### 默认室内图层

###### 使用地图对象默认的[indoorMap](https://lbs.amap.com/api/javascript-api/reference/map).[showIndoorMap](https://lbs.amap.com/api/javascript-api/reference/indoormap)方法，显示指定的室内地图和对应楼层信息，可用于商场、火车站等室内场景的导览图

```
		var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.518542, 39.924677],
            zoom: 18
        });
        map.on("indoor_create", function () {
            map.indoorMap.showIndoorMap("B000A856LJ", 5);
        });
```

### 覆盖物

#### 通用

##### 根据覆盖物调整地图范围

###### 地图上覆盖物较多的情况下，如果需要保证所有覆盖物都在视野范围内， 需要将地图调整到合适的缩放等级和中心点，我们可以调用setFitView()方法，以实现该效果

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.518542, 39.924677],
            zoom: 10
        });

        //创建三个点标记
        var m1 = new AMap.Marker({
            position: [116.49, 39.9]
        });
        var m2 = new AMap.Marker({
            position: [116.29, 39.9]
        });
        var m3 = new AMap.Marker({
            position: [116.69, 39.9],
            icon: "https://webapi.amap.com/theme/v1.3/markers/n/mark_r.png"
        });

        //添加
        map.add([m1, m2, m3]);

        //自动适配到指定视野范围
        function appoint() {
            map.setFitView([m1, m2]);
        }
        //自动适配到所有范围
        function all() {
            map.setFitView();
        }
›
```

##### 添加一个或多个覆盖物

###### 利用 map 的 add 方法在地图上添加一个或多个覆盖物。

```
 var map = new AMap.Map("container", {
            zoom: 13,
            center: [116.43, 39.92],
            resizeEnable: true
        });

        //构建点覆盖物
        var marker = new AMap.Marker({
            position: new AMap.LngLat(116.39, 39.92),
            icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png',
            offset: new AMap.Pixel(-13, -30)
        });

        var polylinePath = [
            new AMap.LngLat(116.41, 39.93),
            new AMap.LngLat(116.43, 39.91)
        ];
        //创建线覆盖物
        var polyline = new AMap.Polyline({
            path: polylinePath
        });

        var polygonPath = [
            new AMap.LngLat(116.46, 39.93),
            new AMap.LngLat(116.44, 39.91),
            new AMap.LngLat(116.49, 39.91)
        ]

        //创建面覆盖物
        var polygon = new AMap.Polygon({
            path: polygonPath
        });
        function multiple() {
            map.add([marker, polyline, polygon])
        }
```

##### 移除一个或多个覆盖物

```
        var map = new AMap.Map("container", {
            zoom: 13,
            center: [116.43, 39.92],
            resizeEnable: true
        });

        //构建点覆盖物
        var marker = new AMap.Marker({
            position: new AMap.LngLat(116.39, 39.92),
            icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png',
            offset: new AMap.Pixel(-13, -30)
        });

        var polylinePath = [
            new AMap.LngLat(116.41, 39.93),
            new AMap.LngLat(116.43, 39.91)
        ];
        //创建线覆盖物
        var polyline = new AMap.Polyline({
            path: polylinePath
        });

        var polygonPath = [
            new AMap.LngLat(116.46, 39.93),
            new AMap.LngLat(116.44, 39.91),
            new AMap.LngLat(116.49, 39.91)
        ]

        //创建面覆盖物
        var polygon = new AMap.Polygon({
            path: polygonPath
        });
        function multiple() {
            map.add([marker, polyline, polygon])
        }
        multiple();

        //移除单个覆盖物
        map.remove(marker);
        //移除多个覆盖物
        map.remove([polyline, polygon]);
```

##### 清除所有覆盖物

```
 map.clearMap();
```

##### 获取某类覆盖物

```
	//获取某类覆盖物
	var overlays = map.getAllOverlays("marker");
```

##### 获取某个覆盖物

```
   var map = new AMap.Map("container", {
            zoom: 13,
            center: [116.43, 39.92],
            resizeEnable: true
        });

        var lnglats = [[116.39, 39.92], [116.41, 39.93], [116.43, 39.91], [116.46, 39.93]];
        var markers = [];

        for (var i = 0; i < lnglats.length; i++) {
            var lnglat = lnglats[i];
            //构建点标记
            var marker = new AMap.Marker({
                position: new AMap.LngLat(lnglat[0], lnglat[1]),
                icon: 'https://webapi.amap.com/theme/v1.3/markers/n/mark_b' + (i + 1) + '.png',
                extData: {
                    id: i + 1
                }
            });
            markers.push(marker);
        }

        //添加点标记
        map.add(markers);

        //获取当前id的覆物
        function getOneOverlay(targetId) {
            var targetMarker;
            for (var i = 0; i < markers.length; i++) {
                var id = markers[i].getExtData().id;
                if (id === targetId) {
                    targetMarker = markers[i];
                    break;
                }
            }
            var position = targetMarker.getPosition();
            var infoWindow = new AMap.InfoWindow({
                position: position,
                offset: new AMap.Pixel(0, -35),
                content: "<div>已获取id为" + targetId + "覆盖物</diiv>"
            });
            infoWindow.open(map);

        }
        getOneOverlay(3)
```

##### 跨日期线绘制

###### 通过LngLat的第三个参数可以使经纬度延伸到 [-180, 180] 区间之外，可解决跨日期限的绘制问题

```
        var map = new AMap.Map("container", {
            zoom: 3,
            center: [180, 40],
            viewMode: "3D"      //开启3D视图
        });

        var arr = [];
        arr.push(new AMap.LngLat(116.39, 39.9, true));
        arr.push(new AMap.LngLat(238.25, 37.48, true)); 
        var polyline = new AMap.Polyline({
            path: arr,
            geodesic: true,
            lineJoin: "round",
            showDir: true,
            dirColor: "white",
            strokeColor: "#29b6f6",
            outlineColor: "white",
            isOutline: true,
            strokeWeight: 6.0,
            zIndex: 2
        });
        var marker1 = new AMap.Marker({
            position: arr[0],
            icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png',
            offset: new AMap.Pixel(-13, -30)
        });

        var marker2 = new AMap.Marker({
            position: arr[1],
            icon: "//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-red.png",
            offset: new AMap.Pixel(-13, -30)    
        });

        var arr = [];
        arr.push(new AMap.LngLat(116.39, 27.48, true));
        arr.push(new AMap.LngLat(238.25, 27.48, true));
        arr.push(new AMap.LngLat(228.25, 37.48, true));
        arr.push(new AMap.LngLat(126.39, 37.48, true));
        var polygon = new AMap.Polygon({
            path: arr,
            fillColor: "#0277bd",
            zIndex: 80,
            strokeColor: "white"
        });

        var primeMeridianArr = [];
        primeMeridianArr.push(new AMap.LngLat(180, 90, true));
        primeMeridianArr.push(new AMap.LngLat(180, -90, true));

        //东经180度分割线
        var primeMeridian = new AMap.Polyline({
            path: primeMeridianArr,
            geodesic: true,
            lineJoin: "round",
            strokeColor: "red",
            strokeWeight: 1.0,
            zIndex: 1
        });
        map.add([primeMeridian, polyline, polygon, marker1, marker2])
```

### 点标记

#### 点标记

##### 点标记的添加/更新/删除

###### 通过icon属性创建Marker，展示添加、修改、删除Marker的接口

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 13,
            center: [116.397428, 39.90923]
        });

        //构建点标记
        var marker = new AMap.Marker({
            icon: "//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png",
            position: [116.406315, 39.908775],
            offset: new AMap.Pixel(-13, 30)     //点标记的偏移位
        });
        //添加点标记
        marker.setMap(map);

        function updataIcon() {
           
            var markerContent = document.createElement("div");
            //更新点标记图标
            var markerImg = document.createElement("img");
            markerImg.src = "//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-red.png";
            markerContent.appendChild(markerImg);
            //更新点标记内容
            var markerSpan = document.createElement("span");
            markerSpan.className = 'marker';
            markerSpan.innerText = "我被更新了";
            markerContent.appendChild(markerSpan);
            marker.setContent(markerContent);
        }
        function clearIcon() {
            //删除点标记
            if (marker) {
                marker.setMap(null);
                marker = null;
            }
        }
```

##### 点标记锚点

```
  //创建地图实例
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 13,
            center: [116.397428, 39.90923],
            mapStyle: "amap://styles/whitesmoke"
        });

        var positions = [
            [116.493195, 39.993253],
            [116.473195, 39.993253],
            [116.453195, 39.993253],
            [116.493195, 39.973253],
            [116.473195, 39.973253],
            [116.453195, 39.973253],
            [116.493195, 39.953253],
            [116.473195, 39.953253],
            [116.453195, 39.953253]
        ];
        var anchor = [
            'bottom-left',
            'bottom-center',
            'bottom-right',
            'middle-left',
            'center',
            'middle-right',
            'top-left',
            'top-center',
            'top-right'
        ];

        var pos_icon = [];
        var pos_marker = [];
        var icon = [];
        var marker = [];

        for (var i = 0; i < positions.length; i++) {
            //创建一个icon
            pos_icon[i] = new AMap.Icon({
                //图标尺寸
                size: new AMap.Size(12, 12),
                //图标的取图地址
                image: '//a.amap.com/jsapi_demos/static/demo-center/marker/marker.png',
                //图标所用图片大小
                imageSize: new AMap.Size(12, 12)
            });
            var labelContent = "<div class='labelContent'>" + anchor[i] + "</div>";

            //将Icon传入marker
            pos_marker[i] = new AMap.Marker({
                position: positions[i],
                icon: pos_icon[i],
                anchor: "center",   //设置锚点
                offset: new AMap.Pixel(0, 0)    //设置偏移量
            });
            map.add(pos_marker[i]);

            //创建一个icon
            var imageUrl = "//a.amap.com/jsapi_demos/static/demo-center/marker/icon.png";
            icon[i] = new AMap.Icon({
                //图标尺寸
                size: new AMap.Size(46, 28),
                //图标的取图地址
                image: imageUrl,
                //图标所用的图片大小
                imageSize: new AMap.Size(46, 28)
            });
            //将Icon传入marker
            var labelOffset = new AMap.Pixel(-23, -28);
            marker[i] = new AMap.Marker({
                position: positions[i],
                icon: icon[i],
                anchor: anchor[i],      //设置锚点
                offset: new AMap.Pixel(0, 0),    //设置偏移量
                label: {
                    content: labelContent,
                    offset: labelOffset
                }
            });
            map.add(marker[i]);
        }
```

##### 文本标记

###### 用AMap.Text创建纯文本的点标记

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 13,
            center: [116.4, 39.92],
            viewMode: "3D"
        });

        //创建纯文本标记
        var text = new AMap.Text({
            text: "纯文本标记",
            anchor: "center",   //设置文本标记锚点
            draggable: true,
            cursor: "pointer",
            angle: 10,      //倾斜角度
            style: {
                "padding": ".75rem 1.25rem",
                "margin-bottom": "1rem",
                "border-radius": ".25rem",
                "background-color": "white",
                "width": "15rem",
                "border-width": 0,
                "box-shadow": "0 2px 6px 0 rgba(114, 124, 245, .5)",
                "text-align": "center",
                "font-size": "20px",
                "color": "blue"
            }
        });
        text.setMap(map);
```

##### 自定义图标

###### 使用AMap.Icon类的实例作为Marker的图标

```
        //构建地图
        var map = new AMap.Map("container", {
            zoom: 13,
            center: [116.4, 39.92],
            resizeEnable: true
        });

            //以iconURL的形式创建一个途经点
        var viaMarker = new AMap.Marker({
            position: new AMap.LngLat(116.38, 39.92),
            icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/dir-via-marker.png',
            offset: new AMap.Pixel(-13, -30)
        });

        //创建一个Icon
        var startIcon = new AMap.Icon({
            //图标尺寸
            size: new AMap.Size(25, 34),
            //图标的取图地址
            image: '//a.amap.com/jsapi_demos/static/demo-center/icons/dir-marker.png',
            //图标所用图片大小
            imageSize: new AMap.Size(135, 40),
            //图标取图偏移量
            imageOffset: new AMap.Pixel(-9, -3)
        });

        //将Icon传入Marker
        var startMarker = new AMap.Marker({
            position: new AMap.LngLat(116.35, 39.89),
            icon: startIcon,
            offset: new AMap.Pixel(-13, -30)
        });

        //创建一个Icon
        var endIcon = new AMap.Icon({
            size: new AMap.Size(25, 34),
            image: '//a.amap.com/jsapi_demos/static/demo-center/icons/dir-marker.png',
            imageSize: new AMap.Size(135, 40),
            imageOffset: new AMap.Pixel(-95, -3)
        });

        //将Icon传入marker
        var endMarker = new AMap.Marker({
            position: new AMap.LngLat(116.45, 39.93),
            icon: endIcon,
            offset: new AMap.Pixel(-13, -30)
        });

        //添加标记到地图
        map.add([viaMarker, startMarker, endMarker]);
```

##### 圆点标记

###### 使用AMap.CircleMarker创建圆点标记

```
        var map = new AMap.Map("container", {
            zoom: 4,
            center: [108, 34],
            viewMode: "3D"
        });

        for (var i = 0; i < capitals.length; i++) {
            var center = capitals[i].center;
            var circleMarker = new AMap.CircleMarker({
                center: center,
                radius: 10 + Math.random() * 10,        //3D视图下，CircleMarker的半径不要超过64PX
                strokeColor: "white",
                strokeWeight: 2,
                strokeOpacity: .5,
                fillColor: "rgba(0, 0, 255, 1)",
                fillOpacity: .5,
                zIndex: 10,
                bubble: true,
                cursor: "pointer",
                clickable: true
            });
            circleMarker.setMap(map);
            
        }
```

##### 自定义点标记内容

###### 通过content属性设定Marker的显示内容

```
var position = new AMap.LngLat(116.397428, 39.90923);

        var map = new AMap.Map("container", {
            zoom: 13,
            center: position,
            resizeEnable: true
        }); 

        //创建点标记内容
        var markerContent = `<div class="custom-content-marker">
                                <img src="//a.amap.com/jsapi_demos/static/demo-center/icons/dir-via-marker.png">
                                <div class="close-btn" onclick="clearMarker()">X</div>
                            </div>`;

        //构建点标记
        var marker = new AMap.Marker({
            position: position,
            content: markerContent,
            offset: new AMap.Pixel(-13, -30)
        });

        //添加marker
        marker.setMap(map);

        //清除marker
        function clearMarker() {
            if (marker) {
                marker.setMap(null);
                marker = null;
            }
        }
```

##### 设置点标注的文本标签

###### 通过label属性给Marker设置文本标签

```
        var map = new AMap.Map("container", {
            zoom: 13,
            center: new AMap.LngLat(116.397428, 39.90923),
            resizeEnable: true
        }); 

        var marker = new AMap.Marker({
            position: map.getCenter(),
            icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png',
            offset: new AMap.Pixel(-13, -30)
        });

        marker.setMap(map);

        //设置鼠标划过点标记显示的文字提示
        marker.setTitle("我是marker的title");

        //设置Label标签
        marker.setLabel({
            offset: new AMap.Pixel(20, -20),    //设置文本标注偏移量
            content: `<div class="info">我是marker的label标签</div>`,        //设置文本标注内容
            direction: "right"      //设置文本标注方位
        });
```

##### 自适应多个点标记

###### 撞见多个Marker，通过Map.setFitView自动适配地图级别和中心，使点标记同时显示在视野内

```
	        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.397428, 39.90923],
            zoom: 13
        });


        var markers = [{
            icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-1.png',
            position: [116.205467, 39.907761]
        }, {
            icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-2.png',
            position: [116.368904, 39.913423]
        }, {
            icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-3.png',
            position: [116.305467, 39.807761]
        }];

        //添加一些分布不均的点到地图上，地图上添加三个点标记，作为参照
        markers.forEach(function (marker) {
            new AMap.Marker({
                map: map,
                icon: marker.icon,
                position: [marker.position[0], marker.position[1]],
                offset: new AMap.Pixel(-13, -30)
            });
        });

        //自适应显示坐标
        function ddd() {
            map.setFitView()
        }
```

##### 删除多个点标记

###### 通过Map.remove批量删除多个点标记

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.397428, 39.90923],
            zoom: 13
        });

        //删除marker
        function removeMarkers() {
            map.remove(markers);
        }

        var markers = []
        var positions = [[116.405467, 39.907761], [116.415467, 39.907761], [116.415467, 39.917761], [116.425467, 39.907761], [116.385467, 39.907761]];

        positions.forEach(item => {
            marker = new AMap.Marker({
    
                position: item,
                icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png',
                offset: new AMap.Pixel(-13, -30)
            });
            markers.push(marker);
        });
```

##### 从多个点中删除指定点

###### 通过Marker.setMap(null)从多个点中删除指定点标记

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.397428, 39.90923],
            zoom: 13
        });

        function clearMarker(count) {
            //删除指定的点标记
            //第一种
            map.remove(markers[count])
            //第二种
            markers[count].setMap(null);
        }

        var markers = [];
        var positions = [[116.405467, 39.907761], [116.415467, 39.907761], [116.415467, 39.917761], [116.425467, 39.907761], [116.385467, 39.907761]];
        positions.forEach((item, value) => {
            marker = new AMap.Marker({
                position: item,
                icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-' + (value + 1) + '.png',
                map: map
            });
            markers.push(marker);
        });
```

##### 点聚合

###### 使用AMap.MarkerClusterer展示大量的Marker点，可灵活设定聚合样式。

```
   var cluster, markers = [];

        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [105, 34],
            zoom: 4
        });

        points.forEach((item, value) => {
            markers.push(new AMap.Marker({
                position: item["lnglat"],
                content: `<div style="background-color: hsla(180, 100%, 50%, 0.7); height: 24px; width: 24px; border: 1px solid hsl(180, 100%, 40%); border-radius: 12px; box-shadow: hsl(180, 100%, 50%) 0px 0px 1px;"></div>`,
                offset: new AMap.Pixel(-15, -15)
            }));
        });
        var count = markers.length;
        var _renderClusterMarker = function (context) {
            var factor = Math.pow(context.count / count, 1 / 18);
            var div = document.createElement("div");
            var Hue = 180 - factor * 180;
            var bgColor = 'hsla(' + Hue + ',100%,50%,0.7)';
            var fontColor = 'hsla(' + Hue + ',100%,20%,1)';
            var borderColor = 'hsla(' + Hue + ',100%,40%,1)';
            var shadowColor = 'hsla(' + Hue + ',100%,50%,1)';
            div.style.backgroundColor = bgColor;
            var size = Math.round(30 + Math.pow(context.count / count, 1 / 5) * 20);
            div.style.width = div.style.height = size + "px";
            div.style.border = "solid 1px" + borderColor;
            div.style.borderRadius = size / 2 + "px";
            div.style.boxShadow = "0 0 1px" + shadowColor;
            div.innerHTML = context.count;
            div.style.lineHeight = size + "px";
            div.style.color = fontColor;
            div.style.fontSize = "14px";
            div.style.textAlign = "center";
            context.marker.setOffset(new AMap.Pixel(-size / 2, -size / 2));
            context.marker.setContent(div);
        }
        addCluster(1);
        function addCluster(tag) {
            if (cluster) {
                cluster.setMap(null);
            }

            if (tag == 2) {//完全自定义
                cluster = new AMap.MarkerClusterer(map, markers, {
                    gridSize: 80,
                    renderClusterMarker: _renderClusterMarker
                });
            } else if (tag == 1) {//自定义图标
                var sts = [{
                    url: "https://a.amap.com/jsapi_demos/static/images/blue.png",
                    size: new AMap.Size(32, 32),
                    offset: new AMap.Pixel(-16, -16)
                }, {
                    url: "https://a.amap.com/jsapi_demos/static/images/green.png",
                    size: new AMap.Size(32, 32),
                    offset: new AMap.Pixel(-16, -16)
                }, {
                    url: "https://a.amap.com/jsapi_demos/static/images/orange.png",
                    size: new AMap.Size(36, 36),
                    offset: new AMap.Pixel(-18, -18)
                }, {
                    url: "https://a.amap.com/jsapi_demos/static/images/red.png",
                    size: new AMap.Size(48, 48),
                    offset: new AMap.Pixel(-24, -24)
                }, {
                    url: "https://a.amap.com/jsapi_demos/static/images/darkRed.png",
                    size: new AMap.Size(48, 48),
                    offset: new AMap.Pixel(-24, -24)
                }];
                cluster = new AMap.MarkerClusterer(map, markers, {
                    styles: sts,
                    gridSize: 80
                });
            } else {//默认样式
                cluster = new AMap.MarkerClusterer(map, markers, { gridSize: 80 });
            }

        }
```

##### 设置点的拖拽效果

###### 通过raiseOnDrag属性使得Marker在拖拽时弹起。

```
        var map = new AMap.Map("container", {
            center: [116.397428, 39.90923],
            zoom: 13,
            resizeEnable: true
        });

        var marker = new AMap.Marker({
            position: map.getCenter(),
            icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png',
            offset: new AMap.Pixel(-13, -30),
            draggable: true,    //是否可拖拽
            cursor: "move",     //鼠标移上去样式
            raiseOnDrag: true,      //设置拖拽效果
        });

        map.add(marker);
```

##### 设置点的弹跳效果

###### 通过Marker.setAnimation设置点的弹跳效果。

```
        var map = new AMap.Map("container", {
            center: [116.397428, 39.90923],
            zoom: 13,
            resizeEnable: true
        });

        var marker = new AMap.Marker({
            position: map.getCenter(),
            icon: '//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png',
            offset: new AMap.Pixel(-13, -30),
            draggable: true,    //是否可拖拽
            cursor: "move",     //鼠标移上去样式
            //raiseOnDrag: true,      //设置拖拽效果
        });

        map.add(marker);
        //弹跳效果
        marker.setAnimation("AMAP_ANIMATION_BOUNCE");
```

##### 轨迹回放

###### 使用Marker.moveAlong方法，使Marker沿路径移动，模拟行驶轨迹回放。

```
        var marker, lineArr = [[116.478935, 39.997761], [116.478939, 39.997825], [116.478912, 39.998549], [116.478912, 39.998549], [116.478998, 39.998555], [116.478998, 39.998555], [116.479282, 39.99856], [116.479658, 39.998528], [116.480151, 39.998453], [116.480784, 39.998302], [116.480784, 39.998302], [116.481149, 39.998184], [116.481573, 39.997997], [116.481863, 39.997846], [116.482072, 39.997718], [116.482362, 39.997718], [116.483633, 39.998935], [116.48367, 39.998968], [116.484648, 39.999861]];


        var map = new AMap.Map("container", {
            resizeEnable: true, 
            center: [116.397428, 39.90923],
            zoom: 17
        });


        marker = new AMap.Marker({
            map: map,
            position: [116.478935, 39.997761],
            icon: "https://webapi.amap.com/images/car.png",
            offset: new AMap.Pixel(-26, -13),
            autoRotation: true,
            angle: -90,
        });

        // 绘制轨迹
        var polyline = new AMap.Polyline({
            map: map,
            path: lineArr,
            showDir: true,
            strokeColor: "#28F",  //线颜色
            // strokeOpacity: 1,     //线透明度
            strokeWeight: 6,      //线宽
            // strokeStyle: "solid"  //线样式
        });

        var passedPolyline = new AMap.Polyline({
            map: map,
            // path: lineArr,
            strokeColor: "#AF5",  //线颜色
            // strokeOpacity: 1,     //线透明度
            strokeWeight: 6,      //线宽
            // strokeStyle: "solid"  //线样式
        });

        marker.on('moving', function (e) {
            passedPolyline.setPath(e.passedPath);
        });
        map.setFitView();

        //开始动画
        marker.moveAlong(lineArr, 200);
        //暂停动画
        marker.pauseMove();
        //继续动画
        marker.resumeMove();
        //停止动画
        marker.stopMove();
```

##### 加载海量点

###### 使用[MassMarks](https://lbs.amap.com/api/javascript-api/reference/layer#MassMarks)在地图上加载海量点，适合需要显示大量Marker的场景

```
        var map = new AMap.Map("container", {
            zoom: 4,
            center: [102.342785, 35.312316]
        });

        var style = [{
            url: 'https://a.amap.com/jsapi_demos/static/images/mass0.png',
            anchor: new AMap.Pixel(6, 6),
            size: new AMap.Size(11, 11)
        }, {
            url: 'https://a.amap.com/jsapi_demos/static/images/mass1.png',
            anchor: new AMap.Pixel(4, 4),
            size: new AMap.Size(7, 7)
        }, {
            url: 'https://a.amap.com/jsapi_demos/static/images/mass2.png',
            anchor: new AMap.Pixel(3, 3),
            size: new AMap.Size(5, 5)
            }];

        var mass = new AMap.MassMarks(citys, {
            opacity: .8,
            zIndex: 111,
            cursor: "pointer",
            style: style
        });
        var marker = new AMap.Marker({ content: " ", map: map });

        mass.on("mouseover", function (e) {
            marker.setPosition(e.data.lnglat);
            marker.setLabel({ content: e.data.name });
        });
        mass.setMap(map);
        function setStyle(multiIcon) {
            if (multiIcon) {
                mass.setStyle(style);
            } else {
                mass.setStyle(style[2]);
            }
        }
```

##### 灵活的点标记

###### ElasticMarker是一种可以随着地图缩放改变图标、大小的点标记，本例子模拟了简单的平面展示图，缩放地图看看吧。

```
        //缩放地图看看！！！
        var map = new AMap.Map('container', {
            viewMode: '3D',
            turboMode: false,
            showIndoorMap: false,
            defaultCursor: 'pointer',
            showBuildingBlock: false,
            zooms: [14, 20],
            showLabel: false,
            zoom: 16,
            pitch: 55,
            rotation: -45,
            center: [116.408967, 39.880101],
            forceVector: true,
        });
        var facilities = [];
        var zoomStyleMapping1 = {
            14: 0,
            15: 0,
            16: 0,
            17: 0,
            18: 0,
            19: 0,
            20: 0
        }
        for (var i = 0; i < sheshi.length; i += 1) {
            var marker = new AMap.ElasticMarker({
                position: sheshi[i].position,
                zooms: [14, 20],
                styles: [{
                    icon: {
                        img: sheshi[i].icon,
                        size: [16, 16],//可见区域的大小
                        ancher: [8, 16],//锚点
                        fitZoom: 14,//最合适的级别
                        scaleFactor: 2,//地图放大一级的缩放比例系数
                        maxScale: 1.4,//最大放大比例
                        minScale: 0.8//最小放大比例
                    }
                }],
                zoomStyleMapping: zoomStyleMapping1
            })
            facilities.push(marker);
        }
        map.add(facilities)

        var spots = [];
        var zoomStyleMapping2 = {
            14: 0,
            15: 0,
            16: 1,
            17: 1,
            18: 1,
            19: 1,
            20: 1
        }
        for (var i = 0; i < touristSpots.length; i += 1) {
            var marker = new AMap.ElasticMarker({
                position: touristSpots[i].position,
                zooms: [14, 20],
                styles: [{
                    icon: {
                        img: touristSpots[i].smallIcon,
                        size: [16, 16],//可见区域的大小
                        ancher: [8, 16],//锚点
                        fitZoom: 14,//最合适的级别
                        scaleFactor: 2,//地图放大一级的缩放比例系数
                        maxScale: 2,//最大放大比例
                        minScale: 1//最小放大比例
                    },
                    label: {
                        content: touristSpots[i].name,
                        offset: [-35, 0],
                        position: 'BM',
                        minZoom: 15
                    }
                }, {
                    icon: {
                        img: touristSpots[i].bigIcon,
                        size: touristSpots[i].size,
                        ancher: touristSpots[i].ancher,
                        fitZoom: 17.5,
                        scaleFactor: 2,
                        maxScale: 2,
                        minScale: 0.125
                    },
                    label: {
                        content: touristSpots[i].name,
                        offset: [-35, 0],
                        position: 'BM'
                    }
                }],
                zoomStyleMapping: zoomStyleMapping2
            })
            spots.push(marker);
        }
        map.add(spots)

        var trees = new AMap.ElasticMarker({
            map: map,
            position: [116.410908, 39.88057],
            zooms: [15.5, 20],
            styles: [{
                icon: {
                    img: 'https://a.amap.com/jsapi_demos/static/resource/img/trees.png',
                    size: [366, 201],
                    ancher: [183, 101],
                    imageSize: [865, 1156],
                    imageOffset: [45, 480],
                    fitZoom: 17.5,
                    scaleFactor: 2,
                    maxScale: 2,
                    minScale: 0.125
                }
            }],
            zoomStyleMapping: zoomStyleMapping1
        })


        map.on('click', function (e) {
            console.log(e.lnglat + '')
        })
        new AMap.Polygon({
            cursor: 'pointer',
            bubble: true,
            path: [[116.419763, 39.882967], [116.419791, 39.882397], [116.419674, 39.882398], [116.419632, 39.882376], [116.419086, 39.882371], [116.41912, 39.88163], [116.41769, 39.881571], [116.417726, 39.880507], [116.417791, 39.879454], [116.417847, 39.878396], [116.417896, 39.87733], [116.418027, 39.874746], [116.418002, 39.874715], [116.417888, 39.874716], [116.417732, 39.874711], [116.417141, 39.874692], [116.416588, 39.874675], [116.415591, 39.874645], [116.413683, 39.874562], [116.413676, 39.874127], [116.412921, 39.874095], [116.41292, 39.874514], [116.412799, 39.874549], [116.412244, 39.874536], [116.411768, 39.874504], [116.411358, 39.874478], [116.410034, 39.874414], [116.408755, 39.874363], [116.408182, 39.874332], [116.407259, 39.87431], [116.406883, 39.8743], [116.406732, 39.877576], [116.406254, 39.877576], [116.405835, 39.877582], [116.40576, 39.877621], [116.40574, 39.878041], [116.405721, 39.878541], [116.404778, 39.878539], [116.404748, 39.878529], [116.404722, 39.87849], [116.404622, 39.878493], [116.403535, 39.878467], [116.402885, 39.878451], [116.402863, 39.879073], [116.403702, 39.879094], [116.404528, 39.879117], [116.404525, 39.879152], [116.404636, 39.879157], [116.405664, 39.879199], [116.405639, 39.879913], [116.405593, 39.880618], [116.404583, 39.880596], [116.404308, 39.880602], [116.403795, 39.880609], [116.403062, 39.880597], [116.402629, 39.880599], [116.40199, 39.88061], [116.401413, 39.880621], [116.400929, 39.880633], [116.400889, 39.880849], [116.400792, 39.880896], [116.400505, 39.880913], [116.400405, 39.880918], [116.400393, 39.88117], [116.400955, 39.881193], [116.40089, 39.881923], [116.400878, 39.882144], [116.400849, 39.882624], [116.400794, 39.883245], [116.400741, 39.883927], [116.400742, 39.884154], [116.401057, 39.885182], [116.400731, 39.885279], [116.400931, 39.885696], [116.401043, 39.885883], [116.40131, 39.886259], [116.401549, 39.886532], [116.401668, 39.88664], [116.403101, 39.886729], [116.403125, 39.886766], [116.403145, 39.886835], [116.403133, 39.886969], [116.403102, 39.887379], [116.403144, 39.88749], [116.403868, 39.88768], [116.404604, 39.887846], [116.40549, 39.887973], [116.406221, 39.888038], [116.40773, 39.888094], [116.409536, 39.888147], [116.411578, 39.888205], [116.413718, 39.888269], [116.414653, 39.888295], [116.415318, 39.888293], [116.41583, 39.888257], [116.416241, 39.888216], [116.416638, 39.88812], [116.416952, 39.88804], [116.417343, 39.887944], [116.417594, 39.887849], [116.417843, 39.887737], [116.41803, 39.887623], [116.418233, 39.887495], [116.418504, 39.887327], [116.418719, 39.887187], [116.418956, 39.887043], [116.419171, 39.886916], [116.419415, 39.886666], [116.419618, 39.886341], [116.42003, 39.885517], [116.420323, 39.884945], [116.420455, 39.88462], [116.420547, 39.884246], [116.420558, 39.883975], [116.420572, 39.883615], [116.420455, 39.883601], [116.419832, 39.883562], [116.419749, 39.883521], [116.41974, 39.88346], [116.419763, 39.882967]],
            map: map,
            fillOpacity: 0.3,
            strokeWeight: 1,
            fillColor: 'green'

        })
```

##### 标注和标注图层

###### 标注和标注图层。可添加带文字的标注，支持海量点。

```
        var map = new AMap.Map("container", {
            zoom: 9,
            showLabel: false,
            expandZoomRange: true,
            center: [116.12, 39.11],
            viewMode: "3D",
            pitch: 60,
            mapStyle: 'amap://styles/whitesmoke'
        });

        var layer = new AMap.LabelsLayer({
            zooms: [3, 20],
            zIndex: 1000,
            collision: true,     //开启标注避让
            animation: true
        });
        map.add(layer);

        var markers = [];

        LabelsData.forEach((item, value) => {
            item.extData = {
                index: value
            }

            var labelMarker = new AMap.LabelMarker(item);
            markers.push(labelMarker);
            layer.add(labelMarker);
                
        });
        map.setFitView();
```

##### 标注和标注图层—文字标注

###### 标注和标注图层。可添加图标， 文字及图标和文字的展示。示例为结合掩模后的效果。

```
 var opts =  {
        subdistric: 0,      //返回下一级行政区
        extensions: "all"       //返回行政区边界坐标组等具体信息

    }
    // 实例化DistrictSearch
    district = new AMap.DistrictSearch(opts);
    district.search("中国", function (status, result) {
        var bounds = result.districtList[0].boundaries;
        var mask = [];
        for(var i = 0; i < bounds.length; i ++) {
            mask.push([bounds[i]]);
        }
        var disCountry = new AMap.DistrictLayer.World({
            zIndex: 0,
            rejectMapMask: true
        });
        var object3Dlayer = new AMap.Object3DLayer({zIndex: 1});
        var map = new AMap.Map("container", {
            mask: mask,
            showLabel: false,
            center: [106.42804, 39.995725],
            viewMode: "3D",
            labelzIndex: 130,
            zoom: 4,
            cursor: "pointer",
            pitch: 35,       //倾斜角度
            layers: [new AMap.TileLayer.RoadNet({zIndex: 7}), disCountry, object3Dlayer, new AMap.TileLayer.Satellite()]
        });
        var height = -5000;
        var color = "#0088ffcc";

        var prism = new AMap.Object3D.Wall({
            path: bounds,
            height: height,
            color: color
        });
        prism.transparent = true;
        object3Dlayer.add(prism);

        var layer = new AMap.LabelsLayer({
            rejectMapMask: true,
            collision: true,     //开启标注避让
            animation: true     //开启标注淡入动画，默认开启
        });

        map.add(layer);

        for(var i = 0; i <  LabelsData.length; i ++) {
            var labelsMarker = new AMap.LabelMarker(LabelsData[i]);

            layer.add(labelsMarker);
        }

    })

```

##### 标注和标注图层-海量点

###### 标注和标注图层。可添加带文字的标注，2D 标注建议在 3000 点内 ，3D 标注建议在 30000 点内。

```
    var map = new AMap.Map("container", {
        zoom: 9,
        showLabel: false,
        expandZoomRange: true,   //允许缩放到最大级别
        center: [116.12, 40.11],
        viewMode: "3D",     //开启3D视图
        pitch: 60,      //俯仰角度
        mapStyle: "amap://styles/whitesmoke"
    });

    map.on("complete", function () {
        var viewData = {'2D': 3E3, '3D': 3E4};
        var curViewMode = map.getViewMode_();

        var layer = new AMap.LabelsLayer({
            zooms: [3, 20],      //缩放级别范围
            zIndex: 1000,
            animation: false,        //关闭标注淡入动画
            collision: false        //碰撞隐藏
        });

        map.add(layer);

        var markers = [];
        var positions = Positions.slice(0, viewData[curViewMode]);

        var icon = {
            type: "image",
            image: "https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",
            size: [10, 15],
            anchor: "bottom-center",
            angel: 0,
            retina: true
        }

        for (var i = 0; i < positions.length; i++) {
            var curPosition = positions[i];
            var curData = {
                position: curPosition,
                icon
            }

            var labelMarker = new AMap.LabelMarker(curData);
            markers.push(labelMarker);
        }

        // 添加海量点标记
        layer.add(markers);

        console.log(viewData[curViewMode])
    });
```

#### 覆盖物群体

##### 添加/移除

###### 对一类覆盖物，创建覆盖物群组，从地图上添加/移除。

```
 var map = new AMap.Map("container", {
        zoom: 13,
        center: [116.43, 39.92],
        resizeEnable: true,     //监听地图大小的变化
    });

    var lnglats = [[116.39, 39.92], [116.41, 39.93], [116.43, 39.91], [116.46, 39.93]];
    var markers = [];

    for(var i = 0; i < lnglats.length; i ++) {
        var lnglat = lnglats[i];
        var marker = new AMap.Marker({
            position: new AMap.LngLat(lnglat[0], lnglat[1]),
            icon: 'https://webapi.amap.com/theme/v1.3/markers/n/mark_b' + (i + 1) + '.png',
            extData: {
                id: i + 1
            }
        });
        markers.push(marker);
    }
    //创建覆盖物群体组，并将marker传给OverlayGroup
    var overlayGroups = new AMap.OverlayGroup(markers);

    //添加覆盖物群组
    // map.add(overlayGroups);

    // 移除覆盖物群组
    // map.remove(overlayGroups);
```

##### 批量修改属性

###### 可以通过 Ovelaygroup 对覆盖物批量修改属性。

```
   var map = new AMap.Map("container", {
       zoom: 14,
       center: [116.396959,39.918288],
       resizeEnable: true
   });

   var paths = [[new AMap.LngLat(116.367519, 39.921711), new AMap.LngLat(116.414383, 39.929017)], [new AMap.LngLat(116.370953, 39.915918), new AMap.LngLat(116.429489, 39.907293)]];
   var polylines = [];

   for(var i = 0; i < paths.length; i ++) {
       var path = paths[i];

       //创建实线实例
       var polyline = new AMap.Polyline({
           path: path,
           strokeWeight: 6,
           strokeColor: '#3366FF',
           isOutline: true,
           borderWeight: 3,
           outlineColor: '#ffeeff'
       });
       polylines.push(polyline);
   }

   var overlayGroups = new AMap.OverlayGroup(polylines);

   map.add(overlayGroups);
   function changeAttribute() {
       overlayGroups.setOptions({
           strokeColor: "#ffeeff",
           outlineColor: "#3366FF"
       })
   }

```

#### 地图控件

##### 地图控件的添加和移除

###### 给地图添加比例尺、缩放工具条、鹰眼等控件

```
    // 构建比例尺/工具条/鹰眼
    var scale = new AMap.Scale({
            visible: false
        }),
        toolBar = new AMap.ToolBar({
            visible: false
        }),
        overView = new AMap.OverView({
            visible: false
        });
    // 添加比例尺
    map.addControl(scale);
    //显示
    scale.show();
    // 隐藏
    scale.hide();
    // 添加工具条尺
    map.addControl(toolBar);
    // 显示
    toolBar.show();
    // 隐藏
    // toolBar.hide();
    // 工具条方向盘
    // 显示
    toolBar.showDirection();
    // 隐藏
    // toolBar.hideDirection();
    // 工具条标尺
    //显示
    toolBar.showRuler();
    // 隐藏
    toolBar.hideRuler();

    // 添加鹰眼
    map.addControl(overView);
    overView.show();
    //展开
    overView.open();
    //关闭
    // overView.close();
```

##### 简易绽放按扭

###### 使用简易模式下的缩放按扭

```
   var map = new AMap.Map("container",{
        resizeEnable: true,     //是否监听地图缩放事件
        zoom: 13,    //地图缩放级别
        center: [116.43, 39.92]
    });

    AMap.plugin([
        "AMap.ToolBar"
    ], function () {
        //在图面添加工具条控件
        map.addControl(new AMap.ToolBar({
            //简易缩放模式，默认为false
            liteStyle: true
        }));
    })

```

##### 3D控制罗盘

###### 3D地图模式下为地图添加控制罗盘

```
   var map = new AMap.Map("container", {
        zoom: 13,
        center: [116.43, 39.92],
        resizeEnable: true,
        viewMode: "3D",
        pitch: 45
    });

    AMap.plugin([
        "AMap.ControlBar",
    ], function () {
        // 添加3D罗盘
        map.addControl(new AMap.ControlBar());
    })
```

#### 信息窗体

##### 默认样式信息窗体

###### 展示创建默认样式的信息窗体，以及信息窗体的打开操作

```
    var infoWindow;
    var map = new AMap.Map("container", {
        resizeEnable: true,
        center: [116.473188,39.993253],
        zoom: 13
    });

    //在指定位置打开信息窗体

        //构建信息窗体中显示的内容
        var info = [];
        info.push("<div class='input-card content-window-card'><div><img style=\"float:left;\" src=\" https://webapi.amap.com/images/autonavi.png \"/></div> ");
        info.push("<div style=\"padding:7px 0px 0px 0px;\"><h4>高德软件</h4>");
        info.push("<p class='input-item'>电话 : 010-84107000   邮编 : 100102</p>");
        info.push("<p class='input-item'>地址 :北京市朝阳区望京阜荣街10号首开广场4层</p></div></div>");

        infoWindow = new AMap.InfoWindow({
            content: info.join("")  //使用默认信息窗体框样式，显示信息内容
        });

        // 打开
        infoWindow.open(map, map.getCenter());
        // 关闭
        // infoWindow.close();
```

##### 信息窗体锚点

###### 信息窗体锚点设置

```
    var map = new AMap.Map("container", {
        center:  [116.402023,39.906977],    //地图中心点
        zoom: 13,
        viewMode: "3D"
    });

    // 自定义信息窗体
    var infoWindow = new AMap.InfoWindow({
        anchor: "top-left",
        content: "这是信息窗体！我在边"
    });

    function setAtnchor(anchor) {
        infoWindow.setAnchor(anchor)
    }

    infoWindow.open(map, [116.402023,39.906977])

```

##### 自定义样式信息窗体

###### 展示如何创建自定义样式的信息窗体，以及如何点击Marker打开信息窗体。

```
	 var map = new AMap.Map("container", {
        center:  [116.481181, 39.989792],    //地图中心点
        zoom: 13,
        viewMode: "3D"
    });

    addMarker();
    function addMarker() {
        map.clearMap();
        var marker = new AMap.Marker({
            map: map,
            position: [116.481181, 39.989792]
        });
        AMap.event.addListener(marker, "click", function () {
            infoWindow.open(map,  marker.getPosition());
        });
    }

    //实例化信息窗体
    var title = `方恒假日酒店<span style="font-size:11px;color:#F00;">价格:318</span>`;
    var content = [];
    content.push("<img src='http://tpc.googlesyndication.com/simgad/5843493769827749134'>地址：北京市朝阳区阜通东大街6号院3号楼东北8.3公里");
    content.push("电话：010-64733333");
    content.push("<a href='https://ditu.amap.com/detail/B000A8URXB?citycode=110105'>详细信息</a>");

    var infoWindow = new AMap.InfoWindow({
        isCustom: true,     //使用自定义窗体
        content: createInfoWindow(title, content.join("<br/>")),
        offset: new AMap.Pixel(16, -45)
    });

    //构建自定义窗体
    function createInfoWindow(title, content) {
        var info = document.createElement("div");
        info.className =  "custom-info input-card content-window-card";

        //可以通过下面的方式修改自定义窗体的宽高
        //info.style.width = "400px";
        // 定义顶部标题
        var top = document.createElement("div");
        var titleD = document.createElement("div");
        var closeX = document.createElement("img");
        top.className = "info-top";
        titleD.innerHTML = title;
        closeX.src = "https://webapi.amap.com/images/close2.gif";
        closeX.onclick = closeInfoWindow;

        top.appendChild(titleD);
        top.appendChild(closeX);
        info.appendChild(top);

        // 定义中部内容
        var middle = document.createElement("div");
        middle.className = "info-middle";
        middle.style.backgroundColor = 'white';
        middle.innerHTML = content;
        info.appendChild(middle);

        // 定义底部内容
        var bottom = document.createElement("div");
        bottom.className = "info-bottom";
        bottom.style.position = 'relative';
        bottom.style.top = '0px';
        bottom.style.margin = '0 auto';
        var sharp = document.createElement("img");
        sharp.src = "https://webapi.amap.com/images/sharp.png";
        bottom.appendChild(sharp);
        info.appendChild(bottom);
        return info;
    }


    //关闭信息窗体
    function closeInfoWindow() {
        map.clearInfoWindow();
    }

```

##### 信息窗体内的交互事件

###### 展示对信息窗体内的 DOM 元素添加自定义事件的方式。

```
  var lnglat = new AMap.LngLat(116.397,39.918);
    var map = new AMap.Map("container", {
        zoom: 14,
        center: lnglat,
        resizeEnable: true
    });

    var infoWindowContent = `<div className="custom-infowindow input-card">
                                <label style="color: grey">故宫博物院</label>
                                <div class="input-item">
                                    <div class="input-item-prepend">
                                        <span class="input-item-text">经纬度</span>
                                    </div>
                                    <input type="text" id="lnglat">
                                </div>
                                <input type="button" id="lnglat2container" class="btn" value="获取该位置经纬度" onclick="getLngLat()"/>
                            </div>`

    // 构建信息窗体
    var infoWindow = new AMap.InfoWindow({
        position: lnglat,
        offset: new AMap.Pixel(0, -35),
        content: infoWindowContent
    });


    infoWindow.open(map);


    // 将当前经纬度展示在 infowindow 的 input 中
    function getLngLat(){
        var lnglatInput = document.getElementById('lnglat');

        lnglatInput.setAttribute('value', lnglat.toString());
    }

```

##### 带检索功能的信息窗体

###### 使用AdvancedInfoWindow，可创建带检索功能的信息窗体，并可设置搜索功能。

```
    // 带检索功能的信息窗体
    var lnglat = [116.473188, 39.993253];
    // 构建地图
    var map = new AMap.Map("container", {
        resizeEnable: true,
        center: lnglat,
        zoom: 15
    });
    var marker = new AMap.Marker({
        position: lnglat
    });
    marker.setMap(map);

    var content = `<div class="info-title">高德地图</div>
                   <div class="info-content">
                        <img src="https://webapi.amap.com/images/amap.jpg">高德是中国领先的数字地图内容、导航和位置服务解决方案提供商
                        <br/>
                        <a target="_blank" href = "https://mobile.amap.com/">点击下载高德地图</a>
                    </div>`

    var infoWindow1 = new AMap.AdvancedInfoWindow({
        content: content,
        offset: new AMap.Pixel(0, -30)
    });

    var infoWindow2 = new AMap.AdvancedInfoWindow({
        content: content,
        asOrigin: false,
        asDestination: false,
        offset: new AMap.Pixel(0, -30)
    });
    var infoWindow3 = new AMap.AdvancedInfoWindow({
        content: content,
        placeSearch: false,
        asDestination: false,
        offset: new AMap.Pixel(0, -30)
    })

    // 打开信息窗体1
    infoWindow1.open(map, lnglat);
    //打开信息窗体2
    infoWindow2.open(map, lnglat);
    //打开信息窗体3
    infoWindow3.open(map, lnglat);

```

##### 给多个点添加信息窗体

###### 给多个点标记添加单击打开信息窗体的事件。

```
        // 给多个点标记添加信息窗体
        var map = new AMap.Map("container", {resizeEnable: true});
        var lnglats = [[116.368904, 39.923423], [116.382122, 39.921176], [116.387271, 39.922501], [116.398258, 39.914600]];
        var infoWindow = new AMap.InfoWindow({offset: new AMap.Pixel(0, -30)});
        lnglats.forEach((item, value) => {
            var marker = new AMap.Marker({
                position: item,
                map: map
            });
            marker.content = "我是第"+ (value + 1) + "个Marker";
            marker.on("click", markerClick);
            marker.emit("click", {target: marker});


        });
        function markerClick(e) {
            infoWindow.setContent(e.target.content);
            infoWindow.open(map, e.target.getPosition());
        }
        map.setFitView();

```

#### 右键菜单

##### 默认右键菜单

###### 使用[ContextMenu.addItem](https://lbs.amap.com/api/javascript-api/reference/overlay/#contextmenu)，配置地图右键菜单选项

```
        var lnglat = new AMap.LngLat(116.397, 39.918);

        var map = new AMap.Map("container", {
            center: lnglat,
            zoom: 14,
            resizeEnable: true
        });

        // 创建右键菜单
        var contextMenu = new AMap.ContextMenu();

        // 放大一级
        contextMenu.addItem("放大一级", function () {
            map.zoomIn();
        }, 0);
        //缩小一级
        contextMenu.addItem("缩小一级", function () {
            map.zoomOut();
        }, 1);

        // 显示全国范围
        contextMenu.addItem("缩放至全国范围", function (e) {
            map.setZoomAndCenter(4,  [108.946609, 34.262324]);
        }, 2);

        contextMenu.addItem("添加标记", function (e) {
            var marker =  new AMap.Marker({
                map: map,
                position: contextMenuPosition       //基点位置
            });
        }, 3);

        // 右键弹出菜单
        map.on("rightclick", function (e) {
            contextMenu.open(map, e.lnglat);
            contextMenuPosition = e.lnglat;
        });

        contextMenu.open(map, lnglat);

```

##### 自定义右键菜单

###### 设置[ContextMenu.content](https://lbs.amap.com/api/javascript-api/reference/overlay#contextmenu)，实现自定义样式和内容的右键菜单

```
    // 构建经纬度
    var lnglat = new AMap.LngLat(116.397, 39.918);

    var map = new AMap.Map("container", {
        center: lnglat,
        zoom: 14,
        resizeEnable: true
    });

    var menu = new ContextMenu(map);

    function ContextMenu(map) {
        var me = this;

        this.mouseTool = new AMap.MouseTool(map);

        this.contextMenuPosition = null;
        var content = [];
        content.push("<div class='info context_menu'>");
        content.push("  <p onclick='menu.zoomMenu(0)'>缩小</p>");
        content.push("  <p class='split_line' onclick='menu.zoomMenu(1)'>放大</p>");
        content.push("  <p class='split_line' onclick='menu.distanceMeasureMenu()'>距离量测</p>");
        content.push("  <p onclick='menu.addMarkerMenu()'>添加标记</p>");
        content.push("</div>");

        //通过content自定义右键菜单内容
        this.contextMenu = new AMap.ContextMenu({isCustom: true, content: content.join("")});

        // 地图监听右键菜单事件
        map.on("rightclick", function (e) {
            me.contextMenu.open(map, e.lnglat);
            me.contextMenuPosition = e.lnglat;  //右键菜单位置
        });
    }

    ContextMenu.prototype.zoomMenu = function zoomMenu(tag) {   //右键菜单缩放地图
            if(tag === 0) {
                map.zoomOut();
            }else if(tag === 1) {
                map.zoomIn();
            }
            this.contextMenu.close();
        }

        ContextMenu.prototype.distanceMeasureMenu = function () {
            //右键菜单距离量测
            this.mouseTool.rule();
            this.contextMenu.close();
        }

        ContextMenu.prototype.addMarkerMenu = function () {
            this.mouseTool.close();
            var marker = new AMap.Marker({
                map: map,
                position: this.contextMenuPositon  //  基点位置
            });
            this.contextMenu.close();
        }
        menu.contextMenu.open(map, lnglat);

```

##### 覆盖物添加右键菜单

###### 使用[ContextMenu.open](https://lbs.amap.com/api/javascript-api/reference/overlay#contextmenu)方法，将右键菜单的操作打开关联到其它覆盖物对象上

```
    var lnglat = new AMap.LngLat(116.397, 39.918);

    var map = new AMap.Map("container", {
        center: lnglat,
        zoom: 14,
        resizeEnabled: true
    });

    // 创建右键菜单
    var contextMenu = new AMap.ContextMenu();

    //右键放大
    contextMenu.addItem("放大一级", function () {
        map.zoomIn();
    }, 0);

    //右键缩小
    contextMenu.addItem("缩小一级", function () {
        map.zoomOut();
    }, 1);
    var marker = new AMap.Marker({
        map: map,
        position: lnglat

    });
    map.setCenter(marker.getPosition());
    marker.on('rightclick', function (e) {
        contextMenu.open(map, e.lnglat);
    });

    contextMenu.open(map, lnglat);

```

#### 矢量图形

##### 折线的绘制和编辑

###### 使用[AMap.Polyline](https://lbs.amap.com/api/javascript-api/reference/overlay#polyline)和[AMap.PolyEditor插件](https://lbs.amap.com/api/javascript-api/reference/plugin#AMap.PolyEditor)绘制和编辑折线

```
var map = new AMap.Map("container", {
        center: [116.395577, 38.892257],
        zoom: 14
    });
    var path =  [
        [116.362209, 39.887487],
        [116.422897, 39.878002],
        [116.372105, 39.90651],
        [116.428945, 39.89663]
    ];

    // 构建折线
    var polyline = new AMap.Polyline({
        path: path,     //经纬度数组
        isOutline: true,
        outlineColor: "#ffeeff",    //边框颜色
        borderWeight: 3,        //边框宽度
        strokeColor: "#3366FF",     //填充颜色
        strokeOpacity: 1,           //透明度
        strokeWeight: 6,            //填充宽度
        strokeStyle: "dashed",      //虚线
        strokeDasharray: [10, 20],  //dashed样式存在才可作用
        lineJoin: "round",
        lineCap: "round",
        zIndex: 50
    });
    polyline.setMap(map);

    // 窗口适应到折线区域
    map.setFitView([polyline]);

    // 编缉折线
    var polyEditor = new AMap.PolyEditor(map, polyline);

    polyEditor.on("addnode", function (event) {
        console.log("addnode事件触发");
    });

    polyEditor.on("adjust", function (event) {
        console.log("adjust事件触发");
    });
    polyEditor.on("removenode", function (event) {
        console.log("removenode事件触发");
    });
    polyEditor.on("end", function (event) {
        console.log("触发事件：end");
    });

    // 开始编缉
    polyEditor.open();

    // 结束编缉
    polyEditor.close();

```

##### 弧线的绘制和编辑

###### 使用[AMap.BezierCurve](https://lbs.amap.com/api/javascript-api/reference/overlay#BezierCurve)和[AMap.BezierEditor插件](https://lbs.amap.com/api/javascript-api/reference/plugin#bezier-editor)绘制和编辑弧线

```
    var map = new AMap.Map("container", {
       zoom: 10,
       resizeEnable: true,
       center: [ 116.397637, 39.900001 ]
    });

    var path = [//每个弧线段有两种描述方式
        [116.39, 39.91, 116.37, 39.91],//起点
        //第一段弧线
        [116.380298, 39.907771, 116.38, 39.90],//控制点，途经点
        //第二段弧线
        [116.385298, 39.907771, 116.40, 39.90],//控制点，途经点//弧线段有两种描述方式1
        //第三段弧线
        [//弧线段有两种描述方式2
            [116.392872, 39.887391],//控制点
            [116.40772, 39.909252],//控制点
            [116.41, 39.89]//途经点
        ],
        //第四段弧线
        [116.423857, 39.889498, 116.422312, 39.899639, 116.425273, 39.902273]
        //控制点，控制点，途经点，每段最多两个控制点
    ];

    var bezierCurve = new AMap.BezierCurve({
        path: path,
        isOutline: true,     //打开边框线
        outlineColor: "#ffeeff",        //边框颜色
        borderWeight: 3,        //边框宽度
        strokeColor: "#3366FF",     //填充颜色
        strokeOpacity: 1,       //填充透明度
        strokeWeight: 6,        //内容宽度
        strokeStyle: "solid",      //内容样式
        strokeDasharray: [10, 10],        //dashed样式存在有效
        lineJoin: "round",
        lineCap: "round",
        zIndex: 50
    });

    //添加到地图
    bezierCurve.setMap(map);

    //  地图视野缩放到弧线的范围
    map.setFitView([bezierCurve]);

    var bezierCurveEditor = new AMap.BezierCurveEditor(map, bezierCurve);

    bezierCurveEditor.on("addnode", function (e) {
        console.log("触发事件：addnode")
    });
    bezierCurveEditor.on("adjust", function (event) {
        console.log("触发事件：adjust");
    });
    bezierCurveEditor.on("removenode", function (event) {
        console.log("触发事件：removenode");
    });
    bezierCurveEditor.on("end", function (event) {
        console.log("触发事件：end");
    });

    // 开始编缉
    bezierCurveEditor.open();
    // 结束编缉
    bezierCurveEditor.close();

```

##### 多边形的绘制和编缉

###### 使用[AMap.Polygon](https://lbs.amap.com/api/javascript-api/reference/overlay#polygon)和[AMap.PolyEditor插件](https://lbs.amap.com/api/javascript-api/reference/plugin#AMap.PolyEditor)绘制和编辑多边形

```
	    var map = new AMap.Map("container", {
        center: [116.400274, 39.905812],
        zoom: 14
    });

    var path = [
        [116.403322, 39.920255],
        [116.410703, 39.897555],
        [116.402292, 39.892353],
        [116.389846, 39.891365]
    ];
    
    // 构建多边形
    var polygon = new AMap.Polygon({
        path: path,
        strokeColor: "green",   //边框颜色
        strokeWeight: 6,        //边框宽度
        strokeOpacity: .2,      //边框透明度
        fillOpacity: .4,        //填充透明度
        fillColor: "#1791fc",   //填充颜色
        zIndex: 50
    });
    polygon.setMap(map);

    map.setFitView([polygon]);

    // 构建多边形编缉多边形
    var polyEditor = new AMap.PolyEditor(map, polygon);
    polyEditor.on("addnode", function (event) {
        console.log("触发事件：addnode")
    });
    polyEditor.on("adjust", function (event) {
        console.log("触发事件：adjust");
    });
    polyEditor.on("removenode", function (event) {
        console.log("触发事件：removenode");
    });
    polyEditor.on("end", function (event) {
        console.log("触发事件：end");
    });
    // 开始编缉
    polyEditor.open();
    // 结束编缉
    polyEditor.close();

```

##### 距形的绘制和编缉

###### 使用[AMap.Rectangle](https://lbs.amap.com/api/javascript-api/reference/overlay#rectangle)和[AMap.RectangleEditor](https://lbs.amap.com/api/javascript-api/reference/plugin#AMap.RectangleEditor)绘制和编辑矩形

```
    var map = new AMap.Map('container', {
        center: [ 116.387175, 39.876405 ],
        zoom: 13
    });

    var southWest = new AMap.LngLat(116.356449, 39.859008);
    var northEast = new AMap.LngLat(116.417901, 39.893797);

    var bounds = new AMap.Bounds(southWest, northEast);

    var rectangle = new AMap.Rectangle({
        bounds: bounds,
        strokeColor: "red", //边框颜色
        strokeWeight: 6,        //边框宽度
        strokeOpacity: .5 ,      //边框透明度
        strokeDasharray: [30, 10],
        strokeStyle: "dashed",
        fillStyle: "blue",
        fillOpacity: .5,
        cursor: "pointer",
        zIndex: 50
    });
    rectangle.setMap(map);
    // 地图缩放到矩形最合适的视野
    map.setFitView([rectangle]);

    var rectangleEditor = new AMap.RectangleEditor(map, rectangle);


    rectangleEditor.on("adjust", function (event) {
        console.log("触发事件：adjust");
    });

    rectangleEditor.on("end", function (event) {
        console.log("触发事件：end");
    });

    // 开始编缉
    rectangleEditor.open();
    //结束编缉
    rectangleEditor.close();

```

##### 圆的绘制和编辑

###### 使用[AMap.Circle](https://lbs.amap.com/api/javascript-api/example/overlayers/circle-draw-and-edit)和[AMap.CircleEditor](https://lbs.amap.com/api/javascript-api/example/overlayers/circle-draw-and-edit)绘制和编辑圆

```
  var map = new AMap.Map("container", {
        center: [116.433322, 39.900256],
        zoom: 14
    });
    var circle = new AMap.Circle({
        center: map.getCenter(),
        radius: 1000,       //半径
        borderWeight: 3,
        strokeColor: "#FF33FF",
        strokeOpacity: 1,
        strokeWeight: 6,
        strokeOpacity: .2,
        fillOpacity: .4,
        strokeOpacity: .2,
        fillOpacity: .4,
        strokeStyle: "dashed",
        strokeDasharrary: [10, 10],
        fillColor: "#1791fc",
        zIndex: 50
    });

    circle.setMap(map);
    map.setFitView([circle]);

    var circleEditor = new  AMap.CircleEditor(map, circle);

    circleEditor.on("move", function (event) {
        console.log("触发事件：move")
    });
    circleEditor.on("adjust", function (event) {
        console.log("触发事件：adjust");
    });
    circleEditor.on("end", function (event) {
        console.log("触发事件：end");
    });

    // 打开编缉
    circleEditor.open();
    // 关闭编缉
    circleEditor.close();

```

##### 椭圆的绘制和编辑		

###### 使用[AMap.Ellipse](https://lbs.amap.com/api/javascript-api/reference/overlay#ellipse)和[AMap.EllipseEditor](https://lbs.amap.com/api/javascript-api/reference/plugin#AMap.EllipseEditor)绘制和编辑椭圆

```
    var map = new AMap.Map("container", {
        center: [ 116.433322, 39.900255 ],
        zoom: 14
    });

    var ellipse = new AMap.Ellipse({
        center: [116.433322, 39.900255],
        radius: [2000, 1000],       //半径
        borderWeight: 3,
        strokeColor: "#FF33FF",
        strokeOpacity: .2,
        strokeWeight: 6,
        fillOpacity: .4,
        strokeStyle: "dashed",
        strokeDasharrary:[10, 10],
        fillColor: "#1791fc",
        zIndex: 50
    });

    ellipse.setMap(map);

    map.setFitView([ellipse]);

    var ellipseEditor = new AMap.EllipseEditor(map, ellipse);

    ellipseEditor.on("move", function (event) {
        console.log("触发事件：move");
    });
    ellipseEditor.on("adjust", function (event) {
        console.log("触发事件：adjust");
    });
    ellipseEditor.on("end", function (event) {
        console.log("触发事件：end");
    });

    // 打开编缉
    ellipseEditor.open()

    // 关闭编缉
    ellipseEditor.close();

```

##### 绘制矢量图形

###### 利用[AMap.MouseTool](https://lbs.amap.com/api/javascript-api/reference/plugin#AMap.MouseTool)绘制折线、弧线、多边形、矩形、圆形等

```
    var map = new AMap.Map("container", {
        center: [116.434381, 39.898515],
        zoom: 14
    });

    var mouseTool = new AMap.MouseTool(map);

    // 绘制线
    function drawPolyline() {
        mouseTool.polyline({
            strokeColor: "#3366FF",
            strokeOpacity: 1,
            strokeWeight: 6,
            strokeStyle: "solid"
        })
    }
    // 绘制多边形
    function drawPolygon() {
        mouseTool.polygon({
            strokeColor: "#FF33FF",
            strokeOpacity: .2,
            strokeWeight: 6,
            fillColor: "#1791fc",
            fillOpacity: .4,
            strokeStyle: "solid"
        });
    }
    // 绘制距形
    function drawRectangle() {
        mouseTool.rectangle({
            strokeColor: "red",
            strokeOpacity: .5,
            strokeWeight: 6,
            fillColor: "blue",
            fillOpacity: .5,
            strokeStyle: "solid"
        });
    }

    // 绘制圆形
    function drawCircle() {
        mouseTool.circle({
            strokeColor: "#FF33FF",
            strokeWeight: 6,
            strokeOpacity: .2,
            fillColor: "#1791fc",
            fillOpacity: .4,
            strokeStyle: "solid"
        });
    }
    mouseTool.on("draw", function (event) {
        console.log("绘制完成");
    });

```

##### 跨日期线绘制

###### 通过LngLat的第三个参数可以使经纬度延伸到 [-180, 180] 区间之外，可解决跨日期限的绘制问题

```
    var map = new AMap.Map("container", {
        zoom: 3,
        resizeEnable: true,
        center:[180,40],
        viewMode: "3D"
    });

    var arr = [];
    arr.push(new AMap.LngLat("116.39", "39.9",true));
    arr.push(new AMap.LngLat("238.25","37.48",true));

    var polyline = new AMap.Polyline({
        path: arr,
        geodesic: true,
        lineJoin: "round",
        showDir: true,
        dirColor: "white",
        strokeColor: "#29b6f6",
        outlineColor: "white",
        isOutline: true,
        strokeWeight: 6
    });

    var circle = new AMap.Circle({
        center: arr[0],
        fillColor: "#81d4fa",
        strokeColor: "white",
        radius: 100000      //m
    });

    var circleMarker = new AMap.CircleMarker({
        center: arr[1],
        fillColor: "#80d8ff",
        strokeColor: "white",
        radius: 20      //px
    });
    var arr = []; //经纬度坐标数组
    arr.push(new AMap.LngLat("126.39", "27.48",true));
    arr.push(new AMap.LngLat("238.25","27.48",true));
    arr.push(new AMap.LngLat("228.25","37.48",true));
    arr.push(new AMap.LngLat("116.39","37.48",true));

    var polygon = new AMap.Polygon({
        path: arr,
        fillColor: "#0277bd",
        zIndex: 80,
        strokeColor: "white"
    });
    map.add([polyline,polygon,circle,circleMarker]);

```

##### 绘制大地线

###### 使用[Polyline.geodesic](https://lbs.amap.com/api/javascript-api/reference/overlay#polyline)在地图上绘制大地线

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.397428, 39.90923],
            zoom: 3
        });
        var lineArr = [['75.757904', '38.118117'], ['117.375719', '24.598057']];
        var polyline = new AMap.Polyline({
            path: lineArr,      //设置线覆盖物路径
            strokeColor: "#3366FF",      //线颜色
            strokeOpacity: 1,       //线透明度
            strokeWeight: 2,        //线宽
            strokeStyle: "solid",       //线样式
            strokeDasharray: [10, 5],        //补充线样式
            geodesic: true  //绘制大地线
        });
        polyline.setMap(map);
```

##### 带洞多边形

###### 使用[Polygon](https://lbs.amap.com/api/javascript-api/reference/overlay#polygon)在地图上绘制带洞的多边形

```
 var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.397428, 39.90923],
            zoom: 3
        });

        var polygonOptions = {
            map: map,
            strokeColor: '#97EC71',     //线颜色
            strokeWeight: 2,        //线宽度
            fillColor: "#D1B3E3",       //填充颜色
            fillOpacity: .7
        }
        var pointers = {
            outer: [
                [117.104554, 30.504444],
                [117.118974, 30.506219],
                [117.12893, 30.508586],
                [117.13305, 30.511248],
                [117.139917, 30.514501],
                [117.147126, 30.518642],
                [117.153993, 30.5216],
                [117.161546, 30.526036],
                [117.171502, 30.529289],
                [117.177339, 30.531655],
                [117.184892, 30.531063],
                [117.197595, 30.533133],
                [117.212014, 30.535499],
                [117.223001, 30.536682],
                [117.233987, 30.536977],
                [117.23845, 30.538456],
                [117.240854, 30.545848],
                [117.251153, 30.543778],
                [117.251497, 30.53816],
                [117.24875, 30.530767],
                [117.246347, 30.523965],
                [117.243943, 30.515684],
                [117.241197, 30.504149],
                [117.238107, 30.493795],
                [117.229524, 30.481073],
                [117.221971, 30.474268],
                [117.215104, 30.469533],
                [117.204461, 30.466574],
                [117.190728, 30.462727],
                [117.183862, 30.464207],
                [117.156739, 30.47456],
                [117.14644, 30.47841],
                [117.140603, 30.482257],
                [117.127214, 30.485215],
                [117.107988, 30.487878]
            ],
            inner: [
                [117.162061, 30.49361],
                [117.167211, 30.49716],
                [117.172361, 30.50071],
                [117.177167, 30.505739],
                [117.184034, 30.512542],
                [117.18987, 30.522894],
                [117.2012, 30.525851],
                [117.210126, 30.527034],
                [117.219396, 30.526443],
                [117.225919, 30.527034],
                [117.234159, 30.529104],
                [117.237935, 30.528808],
                [117.235532, 30.522894],
                [117.234502, 30.516683],
                [117.232785, 30.507514],
                [117.226262, 30.491835],
                [117.217336, 30.480297],
                [117.202916, 30.4729],
                [117.194677, 30.470828],
                [117.184034, 30.473491],
                [117.177511, 30.47793],
                [117.170644, 30.484439],
                [117.167897, 30.489173]
            ]
        };

        var pathArray = [
            pointers.outer,
            pointers.inner
        ]
        
        var polygon = new AMap.Polygon(polygonOptions);
        polygon.setPath(pathArray);
        map.setFitView();
```

##### 庶罩

###### 通过给地图添加一个无限大的带洞多边形，实现遮罩效果，即只显示某个区域的地图

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 8,
            center: [116.44923, 40.207714],
            layers: [new AMap.TileLayer.RoadNet({ zIndex: 20 }), new AMap.TileLayer({zIndex: 6, opacity: 1, getTileUrl:'https://t{1,2,3,4}.tianditu.gov.cn/DataServer?T=ter_w&x=[x]&y=[y]&l=[z]'})]
        });

        new AMap.DistrictSearch({
            extensions: "all",
            subdistrict: 0
        }).search("北京市", function (status, result) {
            var outer = [
                new AMap.LngLat(-360, 90, true),
                new AMap.LngLat(-360, -90, true),
                new AMap.LngLat(360, -90, true),
                new AMap.LngLat(360, 90, true),
            ];
            var holes = result.districtList[0].boundaries;
            var pathArray = [outer];
            pathArray.push.apply(pathArray, holes);
            var polygon = new AMap.Polygon({
                pathL: pathArray,
                strokeColor: '#00eeff',
                strokeWeight: 1,
                fillColor: '#71B3ff',
                fillOpacity: 0.5
            });
            polygon.setPath(pathArray);
            map.add(polygon);
        })
```

##### GeoJSONGeoJSON

###### 使用GeoJSON根据标注你的GeoJSON配置在地图上对应覆盖物。

```
        var map = new AMap.Map("container", {
            center: [107.943579, 30.131735],
            zoom: 7
        });

        ajax("https://a.amap.com/jsapi_demos/static/geojson/chongqing.json", function (err, geoJSON) {
            if (!err) {
                var geojson = new AMap.GeoJSON({
                    geoJSON: geoJSON,
                    getPolygon: function (geojson, lnglats) {
                        var area = AMap.GeometryUtil.ringArea(lnglats[0]);
                        return new AMap.Polygon({
                            path: lnglats,
                            fillOpacity: 1 - Math.sqrt(area / 8000000000),
                            strokeColor: "white",
                            fillColor: "red"
                        });
                    }
                });
                geojson.setMap(map);
                console.log("GeoJSON数据加载完成");
            } else {
                console.log("失败")
            }
        })
```

##### OverlayGroup批处理矢量图形

###### 使用[OverlayGroup](https://lbs.amap.com/api/javascript-api/reference/overlay#overlaygroup)对地图上的覆盖物做集合操作，适用于需要对覆盖物批量处理的场景

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.40, 39.91],
            zoom: 13
        });

        var lineArr = [[116.37, 39.91], [116.38, 39.90], [116.39, 39.91], [116.40, 39.90]];

        //构建折线
        var polyline = new AMap.Polyline({
            path: lineArr,      //设置线覆盖物路径
            strokeColor: "#3366FF",     //线颜色
            strokeOpacity: 1,       //线透明度
            strokeWeight: 5,        //线宽
            strokeStyle: "solid",        //线样式
            strokeDasharray: [10, 5]        //补充线样式
        });
        polyline.setMap(map);

        var polygonArr = new Array();
        polygonArr.push([116.40, 39.92]);
        polygonArr.push([116.41, 39.90]);
        polygonArr.push([116.40, 39.89]);
        polygonArr.push([116.39, 39.89]);

        var polygon = new AMap.Polygon({
            path: polygonArr,       //设置多边形边界路径
            strokeColor: "#FF33FF",     //线颜色
            strokeOpacity: .2,      //线透明度
            strokeWeight: 3,        //线宽度
            fillColor: "#1791fc",       //填充色
            fillOpacity: .5         //填充透明度
        });
        polygon.setMap(map);

        var circle = new AMap.Circle({
            center: new AMap.LngLat("116.40", "39.92"),     //圆心位置
            radius: 1000,       //半径
            strokeColor: "#F33",        //线颜色
            strokeOpaicty: .5,      //线透明度
            strokeWeight: 3,        //线宽度
            fillColor: "#ee2200",       //填充颜色
            fillOpacity: .35,       //填充透明度

        });
        circle.setMap(map);

        var overlayGroup = new AMap.OverlayGroup([polyline, polygon, circle]);

        function randomColor() {
            return "#" + (Math.random() * 0xffffff << 0).toString(16);
        }

        //覆盖物随机出现颜色
        overlayGroup.setOptions({ fillColor: randomColor(), strokeColor: randomColor() });
```

##### 自定义折线方向箭头

###### 给Polyline添加dirColor属性可以设置方向箭头的颜色，添加dirImg可以设置方向箭头的图片，支持Image和Canvas。

```
       var map = new AMap.Map("container");

        var path1 = [
            [75.757904, 38.118117],
            [97.375719, 24.598057],
            [117.375719, 38.118117]
        ];
        var path2 = [
            [75.757904, 41.118117],
            [97.375719, 27.598057],
            [117.375719, 41.118117]
        ];
        var path3 = [
            [75.757904, 44.118117],
            [97.375719, 30.598057],
            [117.375719, 44.118117]
        ];
        var path4 = [
            [75.757904, 47.118117],
            [97.375719, 33.598057],
            [117.375719, 47.118117]
        ];

        var polyline1 = new AMap.Polyline({
            path: path1,
            showDir: true,
            strokeColor: "#3366bb",     //线颜色
            strokeWeight: 10        //线宽

        });

        var polyline2 = new AMap.Polyline({
            path: path2,            // 设置线覆盖物路径
            showDir: true,
            dirColor: 'pink',
            strokeColor: '#336688',   // 线颜色
            strokeWeight: 10           // 线宽
        });

        var canvasDir = document.createElement('canvas')
        var width = 24;
        canvasDir.width = width;
        canvasDir.height = width;
        var context = canvasDir.getContext('2d');
        context.strokeStyle = 'red';
        context.lineJoin = 'round';
        context.lineWidth = 8;
        context.moveTo(-4, width - 4);
        context.lineTo(width / 2, 6);
        context.lineTo(width + 4, width - 4);
        context.stroke();

        var polyline3 = new AMap.Polyline({
            path: path3,            // 设置线覆盖物路径
            showDir: true,
            dirImg: canvasDir,
            strokeColor: '#3366cc',   // 线颜色
            strokeWeight: 10           // 线宽
        });

        var polyline4 = new AMap.Polyline({
            path: path4,            // 设置线覆盖物路径
            showDir: true,
            dirImg: 'https://a.amap.com/jsapi_demos/static/images/mass0.png',
            strokeColor: '#3366dd',   // 线颜色
            strokeWeight: 10           // 线宽
        });

        map.add([polyline1, polyline2, polyline3, polyline4]);
        map.setFitView();
```

#### 通用接口

##### Object的添加/移除

###### 对Object3D对象进行添加和移除的基本操作

```
        var map = new AMap.Map("container", {
            viewMode: "3D",     //开启3D模式
            pitch: 55,      //俯仰角度
            rotation: 35,     //旋转角度
            center: [116.39756, 39.904215],
            features: ["bg", "road"],     //隐藏默认楼块
            zoom: 16        //缩放级别
        });

        //添加Object3DLayer图层，用于添加3DObject对象

        var object3Dlayer = new AMap.Object3DLayer();
        map.add(object3Dlayer);

        var paths = [
            [116.395951, 39.907129],
            [116.399127, 39.907178],
            [116.399534, 39.900413],
            [116.396316, 39.900331]
        ];
        var bounds = paths.map(function (path) {
            return new AMap.LngLat(path[0], path[1]);
        });

        //创建Object3D对象
        var prism = new AMap.Object3D.Prism({
            path: bounds,
            height: 500,
            color: 'rgba(100, 150, 230, 0.7)',       //可支持#，rgb(), rgba()格式
        });

       //开启透明度支持
        prism.transparent = true;

        //添加至3D图层
        object3Dlayer.add(prism);

        //移除
        object3Dlayer.remove(prism);
```

##### 模型变换

###### 使用 Object3D 类型的 position 和 rotateZ 等方法可对三维对象进行模型变换，本例模拟了雷达扫描的实现。

```
        var map = new AMap.Map("container", {
            viewMode: "3D",     //开启3D模式
            buildingAnimation: false,       //楼块消失是否显示动画过程
            showIndoorMap: false,           //是否在有矢量图的时候自动展示地图
            center: [116.470323, 39.992598],    //中心点
            pitch: 30,      //俯仰角度
            zoom: 17,       //缩放级别
        });

        //添加3D图层
        var object3Dlayer = new AMap.Object3DLayer();
        map.add(object3Dlayer);

        var radar;

        var buildRadar = function () {
            radar = new AMap.Object3D.Mesh();
            radar.transparent = true;
            radar.backOrFront = "front";    

            var geometry = radar.geometry;
            var radius = 200;       //米
            radius = radius / map.getResolution(map.getCenter(), 20);
            var unit = 1;
            var range = 200;
            var count = range / unit;

            for (var i = 0; i < count; i++) {
                var angle1 = i * unit * Math.PI / 180;
                var angle2 = (i + 1) * unit * Math.PI / 180;

                var p1x = Math.cos(angle1) * radius;
                var p1y = Math.sin(angle1) * radius;
                var p2x = Math.cos(angle2) * radius;
                var p2y = Math.sin(angle2) * radius;


                geometry.vertices.push(0, 0, 0);    
                geometry.vertices.push(p1x, p1y, 0);
                geometry.vertices.push(p2x, p2y, 0);

                var opacityStart = getOpacity(i / count);
                var opacityEnd = getOpacity((i + 1) / count);

                geometry.vertexColors.push(0, 1, .2, opacityStart);
                geometry.vertexColors.push(0, 1, .2, opacityStart);
                geometry.vertexColors.push(0, 1, .2, opacityEnd);
            }
            radar.position(map.getCenter());

            object3Dlayer.add(radar);
        }

        function getOpacity(scale) {
            return 1 - Math.pow(scale, .3);
        }

        function scan() {
            radar.rotateZ(-2);
            AMap.Util.requestAnimFrame(scan);
        }

        buildRadar();
        scan();
```

#### 立体Mesh

##### 基础Mesh

###### 通过给Object3D.Mesh的实例设定各种三维描述信息，实现三维物体的展示。

```
     //创建3D底图
    var map = new AMap.Map("container", {
        viewMode: "3D",
        showBuildingBlock: false, //3D楼块效果
        expandZoomRange: true,   //允许最大缩放级别
        zooms: [3, 20],    //缩放级别范围
        pitch: 50,  //俯仰角度
        zoom: 16.5,   //缩放级别
        center: [116.250766, 39.932931]//中心点
    });

    // 构建3D
    var object3Dlayer = new AMap.Object3DLayer();
    map.add(object3Dlayer);

    var center_3d = map.lngLatToGeodeticCoord(map.getCenter());
    var topColor = [0, 1, 1, .9];
    var topFaceColor = [0, 1, 1, .4];
    var bottomColor = [0, 0, 1, .9];

    //添加一个圆柱体
    var addRegularPrism = function (center, segment, height, radius) {
        var cylinder = new AMap.Object3D.Mesh();
        var geometry = cylinder.geometry;
        var verticesLength = segment * 2;

        var path = [];
        for(var i = 0;i < segment; i ++) {
            var angle = 2 * Math.PI * i / segment;
            var x = center.x + Math.cos(angle) * radius;
            var y = center.y + Math.sin(angle) * radius;
            path.push([x, y]);
            geometry.vertices.push(x, y, 0);  //底部顶点
            geometry.vertices.push(x, y, -height);  //顶部顶点

            geometry.vertexColors.push.apply(geometry.vertexColors, bottomColor);  //底部颜色
            geometry.vertexColors.push.apply(geometry.vertexColors, topColor);  //底部颜色

            var bottomIndex = i * 2;
            var topIndex = bottomIndex + 1;
            var nextBottomIndex = (bottomIndex + 2) % verticesLength;
            var nextTopIndex = (bottomIndex + 3) % verticesLength;

            geometry.faces.push(bottomIndex, topIndex, nextTopIndex);
            geometry.faces.push(bottomIndex, nextTopIndex, nextBottomIndex)
        }

        // 独立的顶点
        for(var i = 0; i < segment; i ++) {
            geometry.vertices.push.apply(geometry.vertices, geometry.vertices.slice(i * 6 + 3, i * 6 + 6)); //底部顶点
            geometry.vertexColors.push.apply(geometry.vertexColors, topFaceColor);
        }
        var triangles = AMap.GeometryUtil.triangulateShape(path);
        var offset = segment * 2;

        for(var v = 0; v < triangles.length; v += 3) {
            geometry.faces.push(triangles[v] + offset, triangles[v + 2] + offset, triangles[v + 1] + offset);
        }
        cylinder.transparent = true;   //开启3D透明
        object3Dlayer.add(cylinder);
    }
    addRegularPrism(center_3d.add(new AMap.Pixel(-1500, 0)), 3, 800, 500);  //三棱柱
    addRegularPrism(center_3d, 5, 1200, 500);  //五棱柱
    addRegularPrism(center_3d.add(new AMap.Pixel(1500, 0)),32 , 1200, 500);  //圆柱
```

##### 接受光照的Mesh

###### 使用 Object3D.MeshAcceptLights 类的实例，创建和展示可接受光照的三维物体

```
        var map = new AMap.Map("container", {
            zoom: 16.5,  //缩放级别
            viewMode: "3D",  //开启3D视图
            showBuildingBlock: false,  //地图是否显示3D楼块效果
            expandZoomRange: true,  //允许缩放到最大级别
            zooms: [3, 20],  //缩放级别范围
            pitch: 60,  //俯仰角度
            center: [116.230766, 39.932931]
        });

        map.AmbientLight = new AMap.Lights.AmbientLight([1, 1, 1], 0.3);
        map.DirectionLight = new AMap.Lights.DirectionLight([0, -1, 2], [1, 1, 1], .7);

        var angle = 90;
        function changeLightDirection() {
            angle += 3;
            var dir = [
                Math.cos(angle / 180 * Math.PI),
                -Math.sin(angle / 180 * Math.PI),
                2
            ];
            map.DirectionLight.setDirection(dir);
            map.render();
            AMap.Util.requestAnimFrame(changeLightDirection);
        }
        changeLightDirection();

        var object3Dlayer = new AMap.Object3DLayer();
        map.add(object3Dlayer);
        var center_3d = map.lngLatToGeodeticCoord(map.getCenter());

        //添加一个圆柱体
        var addRegularPrism = function (center, segment, height, radius, color) {
            var cylineder = new AMap.Object3D.MeshAcceptLights();
            var geometry = cylineder.geometry;
            var verticesLength = segment * 2;

            var path = [];

            for (var i = 0; i < segment; i++) {
                var angle = 2 * Math.PI * i / segment;
                var x = center.x + Math.cos(angle) * radius;
                var y = center.y + Math.sin(angle) * radius;
                path.push([x, y]);
                geometry.vertices.push(x, y, 0); //底部顶点
                geometry.vertices.push(x, y, -height);  //顶部顶点

                geometry.vertexColors.push.apply(geometry.vertexColors, color);  //底部颜色
                geometry.vertexColors.push.apply(geometry.vertexColors, color);  //顶部颜色

                var nX = Math.cos(angle);
                var nY = Math.sin(angle);
                //为了支持光照，计算侧面顶点法向量
                geometry.vertexNormals.push(nX, nY, 0);
                geometry.vertexNormals.push(nX, nY, 0);

                var bottomIndex = i * 2;
                var topIndex = bottomIndex + 1;
                var nextBottomIndex = (bottomIndex + 2) % verticesLength;
                var nextTopIndex = (bottomIndex + 3) % verticesLength;

                geometry.faces.push(bottomIndex, topIndex, nextTopIndex);  //侧面三角形1 
                geometry.faces.push(bottomIndex, nextTopIndex, nextBottomIndex);  //侧面三角形2
            }

            // 构建顶面三角形,一样的颜色,但是法向量不一样，所以需要独立的顶点
            for (var i = 0; i < segment; i++) {
                geometry.vertices.push.apply(geometry.vertices, geometry.vertices.slice(i * 6 + 3, i * 6 + 6)); //底部顶点
                geometry.vertexColors.push.apply(geometry.vertexColors, color);
                geometry.vertexNormals.push(0, 0, -1);
            }

            var triangles = AMap.GeometryUtil.triangulateShape(path);
            var offset = segment * 2;
            for (var i = 0; i < triangles.length; i += 3) {
                geometry.faces.push(triangles[i] + offset, triangles[i + 2] + offset, triangles[i + 1] + offset);
            }
                
            cylineder.transparent = true;  //设置支持透明度
            object3Dlayer.add(cylineder);
        }

        addRegularPrism(center_3d.add(new AMap.Pixel(-1500, 0)), 3, 800, 500, [1, 0, 0, 1]) //三棱柱
        addRegularPrism(center_3d, 5, 1500, 400, [0, 1, 0, 1])//五棱柱
        addRegularPrism(center_3d.add(new AMap.Pixel(1500, 0)), 32, 1600, 500, [0, 0, 1, 1])//圆柱
```

##### 给 Mesh 添加纹理

###### 通过给 Object3D.Mesh 的实例设定纹理及纹理坐标，实现三维物体的纹理贴图

```
 var map = new AMap.Map("container", {
            zoom: 16.5,  //缩放级别
            viewMode: "3D",  //开启3D视图
            showBuildingBlock: false,  //地图是否显示3D楼块效果
            expandZoomRange: true,  //允许缩放到最大级别
            zooms: [3, 20],  //缩放级别范围
            pitch: 60,  //俯仰角度
            center: [116.230766, 39.932931]
        });

        map.AmbientLight = new AMap.Lights.AmbientLight([1, 1, 1], 0.3);
        map.DirectionLight = new AMap.Lights.DirectionLight([0, -1, 2], [1, 1, 1], .5);

        var object3Dlayer = new AMap.Object3DLayer();
        map.add(object3Dlayer);
        var center = map.getCenter();

        //添加一个圆柱体
        var addBox = function (center, length, width, height) {
            var box = new AMap.Object3D.MeshAcceptLights();
            var geometry = box.geometry;
            box.textures.push('https://a.amap.com/jsapi_demos/static/texture3d/shuilifang.png');

            var halfLength = length / 2;
            var halfWidth = width / 2;
            var path = [
                [-halfLength, halfWidth],
                [halfLength, halfWidth],
                [halfLength, -halfWidth],
                [-halfLength, -halfWidth]
            ];

            //构造4个侧面
            for (var i = 0; i < 4; i += 1) {
                var x1 = path[i][0];
                var y1 = path[i][1];

                var x2 = path[(i + 1) % 4][0];
                var y2 = path[(i + 1) % 4][1];

                // 每个侧面四个顶点
                geometry.vertices.push(x1, y1, 0);
                geometry.vertices.push(x1, y1, -height);
                geometry.vertices.push(x2, y2, 0);
                geometry.vertices.push(x2, y2, -height);

                var v1 = new AMap.Vector3(0, 0, -height);
                var v2 = new AMap.Vector3(x2 - x1, y2 - y1, 0);

                // 各面的法向量
                var normal = new AMap.Vector3().crossVectors(v2, v1).normalize().elements;

                geometry.vertexNormals.push(normal[0], normal[1], normal[2]);
                geometry.vertexNormals.push(normal[0], normal[1], normal[2]);
                geometry.vertexNormals.push(normal[0], normal[1], normal[2]);
                geometry.vertexNormals.push(normal[0], normal[1], normal[2]);

                // 四个顶点的纹理坐标
                geometry.vertexUVs.push(0, 1);
                geometry.vertexUVs.push(0, 0);
                geometry.vertexUVs.push(1, 1);
                geometry.vertexUVs.push(1, 0);

                var bottomIndex = i * 4;
                var topIndex = bottomIndex + 1;
                var nextBottomIndex = (bottomIndex + 2);
                var nextTopIndex = (bottomIndex + 3);

                // 侧面三角形1
                geometry.faces.push(topIndex, bottomIndex, nextBottomIndex);
                // 侧面三角形2
                geometry.faces.push(topIndex, nextBottomIndex, nextTopIndex);
            }
            //构造顶面
            for (var i = 0; i < 4; i += 1) {
                geometry.vertices.push(path[i][0], path[i][1], -height);
                geometry.vertexNormals.push(0, 0, -1);
            }

            // 四个顶点的纹理坐标
            geometry.vertexUVs.push(0, 2);
            geometry.vertexUVs.push(1, 2);
            geometry.vertexUVs.push(1, 0);
            geometry.vertexUVs.push(0, 0);

            // 侧面三角形1
            geometry.faces.push(16 + 0, 16 + 1, 16 + 2);
            // 侧面三角形2
            geometry.faces.push(16 + 0, 16 + 2, 16 + 3);

            box.position(center);

            // 如果使用了透明颜色，请设置true
            box.transparent = true;
            object3Dlayer.add(box);
        };

        addBox(center, 1600, 1600, 800);
```

##### 不规则棱柱体

###### 使用Prism类型创建和展示朝阳区的棱柱体，并给地图设置光照，实现三维地块的展示。

```
      var map = new AMap.Map("container", {
            zoom: 11,
            viewMode: "3D",  //开启3D视图
            pitch: 50,  //俯仰角度
            center: [116.480766, 39.932931]
        });

        //设置光照 
        map.AmbientLight = new AMap.Lights.AmbientLight([1, 1, 1], .5);
        map.DirectionLight = new AMap.Lights.DirectionLight([0, 0, 1], [1, 1, 1], 1);

        var object3Dlayer = new AMap.Object3DLayer();
        map.add(object3Dlayer);

        new AMap.DistrictSearch({
            subdistrict: 0,   //返回下一级行政区
            extensions: 'all',  //返回行政区边界坐标组等具体信息
            level: 'city'  //查询行政级别为 市
        }).search("朝阳区", function (status, result) {
            var bounds = result.districtList[0].boundaries,
                height = 5000,
                color = "#0088ffcc";
            var prism = new AMap.Object3D.Prism({
                path: bounds,
                height: height,
                color: color
            });
            prism.transparent = true;  //设置是否支持透明度
            object3Dlayer.add(prism);
            var text = new AMap.Text({
                text: result.districtList[0].name + '</br>(' + result.districtList[0].adcode + ')',
                verticalAign: "bottom",
                position: [116.528261, 39.934313],
                height: 5000,
                style: {
                    'background-color': 'transparent',
                    '-webkit-text-stroke': 'red',
                    '-webkit-text-stroke-width': '0.5px',
                    'text-align': 'center',
                    'border': 'none',
                    'color': 'white',
                    'font-size': '24px',
                    'font-weight': 600
                }
            });
            text.setMap(map);
        });
```

##### glTF 模型

###### AMap.GltfLoader 插件解析加载 glTF 模型

```
var map = new AMap.Map("container", {
                zoom: 15,
                viewMode: "3D",  //开启3D视图
                pitch: 30,  //俯仰角度
                center: [121.499809, 31.236666],  //中心点
                rotation: 25,  //旋转角度
                mapStyle: "amap://styles/macaron",
                showIndoorMap: false,   //是否在有矢量底图的时候自动展示室内地图
            });

            //创建Object3DLayer图层
            var object3Dlayer = new AMap.Object3DLayer();
            map.add(object3Dlayer);

            map.plugin(["AMap.GltfLoader"], function () {
                var urlCity = 'https://a.amap.com/jsapi_demos/static/gltf-online/shanghai/scene.gltf';
                var urlDuck = 'https://a.amap.com/jsapi_demos/static/gltf/Duck.gltf';
                var paramCity = {
                    position: new AMap.LngLat(121.510909, 31.233366),  //必须
                    scale: 3580, //非必须 默认1
                    height: 1800,  //非必须 默认0
                    scene: 0,  //非必须 默认0
                }

                var paramDuck = {
                    position: new AMap.LngLat(121.495000, 31.233366), // 必须
                    scale: 800,
                    height: -100,
                    scene: 0,
                }

                var gltfObj = new AMap.GltfLoader();
                gltfObj.load(urlCity, function (gltfCity) {
                    gltfCity.setOption(paramCity);
                    gltfCity.rotateX(90);
                    gltfCity.rotateZ(120);
                    object3Dlayer.add(gltfCity);
                });

                gltfObj.load(urlDuck, function (gltfDuck) {
                    gltfDuck.setOption(paramDuck);
                    gltfDuck.rotateX(90);
                    gltfDuck.rotateZ(-20);
                    object3Dlayer.add(gltfDuck);
                })
            });
        
```

##### 垂面

###### AMap.Object3D.Wall 可以用经纬度来创建一组垂直于地面的墙面

```
        var map = new AMap.Map("container", {
            center: [116.472804, 39.995725],
            viewMode: "3D",
            labelzIndex: 130,
            pitch: 40,
            zoom: 9
        });
        var object3Dlayer = new AMap.Object3DLayer({zIndex: 1});
        map.add(object3Dlayer);
        var opts = {
            subdistrict: 0,
            extensions: "all",
            level: "city"
        }
        var district = new AMap.DistrictSearch(opts);
        district.search("北京市", function (status, result) {
            var bounds = result.districtList[0].boundaries;
            var height = 30000;
            var color = "#0088ffcc";
            var wall = new AMap.Object3D.Wall({
                path: bounds,
                height: height,
                color: color
            });
            wall.backOrFront = "both";
            wall.transparent = true;
            object3Dlayer.add(wall);
        });
```

#### 线

##### 基础线

###### Object3D.Line 用来创建基于 gl.LINES 绘制的纯粹的线样式的三维图形

```
        var map = new AMap.Map("container", {
            showBuildingBlock: false,
            expandZoomRange: true,
            zooms: [3, 20],
            pitch: 53,
            zoom: 5,
            center: [109.480766, 29.932931],
            viewMode: '3D',
            defaultCursor: "pointer"   //默认鼠标样式
        });

        var object3Dlayer = new AMap.Object3DLayer({zIndex: 10});
        map.add(object3Dlayer);

        //构建线
        var line3D = new AMap.Object3D.Line();
        line3D.transparent = true;

        var geometry = line3D.geometry;
        for (var i = 0; i < city_line.length; i++) {
            var od = city_line[i].line;

            var origin = od[0].split(",");
            origin = map.lngLatToGeodeticCoord([origin[0], origin[1]]);
            geometry.vertices.push(origin.x, origin.y, 0);
            geometry.vertexColors.push(0, .4, 1, .3);

            var des = od[1].split(",");
            des = map.lngLatToGeodeticCoord([des[0], des[1]]);
            geometry.vertices.push(des.x, des.y, 0);
            geometry.vertexColors.push(0, .4, 1, .3);
        }
        object3Dlayer.add(line3D);
```

##### MeshLine

###### 通过设置 Object3D.MeshLine 的相关属性，展示3D线段通过设置 Object3D.MeshLine 的相关属性，展示3D线段

```
        var points = [
            new AMap.LngLat(116.400433, 39.908084),
            new AMap.LngLat(113.52412, 34.777709),
            new AMap.LngLat(108.821972, 34.270829),
            new AMap.LngLat(104.067108, 30.65769)
        ];

        var map = new AMap.Map('container', {
            center: [108.011931, 37.071694],
            zoom: 6,
            viewMode: '3D',
            pitch: 70
        });

        var object3Dlayer = new AMap.Object3DLayer();
        var numberOfPoints = 180;
        var minHeight = 20;

        var meshLine = new AMap.Object3D.MeshLine({
            path: computeBezier(points, numberOfPoints, minHeight),
            height: getEllipseHeight(numberOfPoints, 8000000, minHeight),
            color: 'rgba(55,129,240, 0.9)',
            width: 20
        });

        meshLine.transparent = true;
        object3Dlayer.add(meshLine);
        meshLine['backOrFront'] = 'both';
        map.add(object3Dlayer);

        function pointOnCubicBezier(cp, t) {
            var ax, bx, cx;
            var ay, by, cy;
            var tSquared, tCubed;

            cx = 3.0 * (cp[1].lng - cp[0].lng);
            bx = 3.0 * (cp[2].lng - cp[1].lng) - cx;
            ax = cp[3].lng - cp[0].lng - cx - bx;

            cy = 3.0 * (cp[1].lat - cp[0].lat);
            by = 3.0 * (cp[2].lat - cp[1].lat) - cy;
            ay = cp[3].lat - cp[0].lat - cy - by;

            tSquared = t * t;
            tCubed = tSquared * t;

            var lng = (ax * tCubed) + (bx * tSquared) + (cx * t) + cp[0].lng;
            var lat = (ay * tCubed) + (by * tSquared) + (cy * t) + cp[0].lat;

            return new AMap.LngLat(lng, lat);
        }

        function computeBezier(points, numberOfPoints) {
            var dt;
            var i;
            var curve = [];

            dt = 1.0 / (numberOfPoints - 1);

            for (i = 0; i < numberOfPoints; i++) {
                curve[i] = pointOnCubicBezier(points, i * dt);
            }

            return curve;
        }

        function getEllipseHeight(count, maxHeight, minHeight) {
            var height = [];
            var radionUnit = Math.PI / 180;

            for (var i = 0; i < count; i++) {
                var radion = i * radionUnit;

                height.push(minHeight + Math.sin(radion) * maxHeight);
            }
```

##### 细线 ThinLine

###### AMap.Object3D.ThinLine可以利用经纬度路径来绘制细线

```
        var map = new AMap.Map('container', {
            center: [116.472804, 39.995725],
            viewMode: '3D',
            labelzIndex: 130,
            pitch: 30,
            zoom: 6.5,
        });

        var object3Dlayer = new AMap.Object3DLayer({zIndex: 1});
        object3Dlayer.setMap(map);

        var opts = {
            subdistrict: 0,
            extensions: "all",
            level: "province"
        }

        //行政区查询 
        var district = new AMap.DistrictSearch(opts);
        district.search("河北省", function (status, result) {
            var bounds = result.districtList[0].boundaries;

            var color = '#0055ff';
            for (var i = 0; i < bounds.length; i++) {
                var line = new AMap.Object3D.ThinLine({
                    path: bounds[i],
                    color: color
                });
                object3Dlayer.add(line);
            }
        });
```

#### 点Points

##### 带高度的点

###### Object3D.Points 是基于 gl.POINTS 绘制的一种三维图形，支持颜色、大小、纹理

```
    var map = new AMap.Map("container", {
        viewMode: "3D",
        turboMode: false,
        defaultCursor: "pointer",
        showBuildingBlock: false,
        expandZoomRange: true,
        zooms: [3, 20],
        zoom: 4,
        pitch: 50,
        forceVector: true
    });

    var object3Dlayer = new AMap.Object3DLayer({zIndex: 110, opacity: 1});
    map.add(object3Dlayer);

    function lnglatToG20(lnglat) {
        lnglat = map.lngLatToGeodeticCoord(lnglat);
        lnglat.x = AMap.Util.format(lnglat.x, 3);
        lnglat.y = AMap.Util.format(lnglat.y, 3);
        return lnglat;
    }

    new AMap.DistrictSearch({
        subdistrict: 1,  //返回下一级行政区
        extensions: "base"
    }).search("中国", function (status, result) {
        var provinces = result.districtList[0].districtList;
        var points3D = new AMap.Object3D.Points();
        points3D.transparent = true;

        var geometry = points3D.geometry;
        for(var i = 0; i < provinces.length; i ++) {
            var center = lnglatToG20(provinces[i].center);
            geometry.vertices.push(center.x, center.y, -Math.random() * 10000000);
            geometry.pointSizes.push(Math.round(Math.random() * 50));
            geometry.vertexColors.push(i * 0.029, i * 0.015, i * 0.001, 0.5);
        }

        points3D.borderColor = [0.6, .8, 1, 1];
        points3D.borderWeight = 3;
        object3Dlayer.add(points3D);
    });
```

##### 无高度的点

###### Object3D.Points 是基于 gl.POINTS 绘制的一种三维图形，支持颜色、大小、纹理

```
    var map = new AMap.Map("container", {
        viewMode: "3D",
        turboMode: false,
        defaultCursor: "pointer",
        showBuildingBlock: false,
        expandZoomRange: true,
        zooms: [3, 20],
        zoom: 4,
        pitch: 50,
        forceVector: true
    });

    var object3Dlayer = new AMap.Object3DLayer({zIndex: 110, opacity: 1});
    map.add(object3Dlayer);

    function lnglatToG20(lnglat) {
        lnglat = map.lngLatToGeodeticCoord(lnglat);
        lnglat.x = AMap.Util.format(lnglat.x, 3);
        lnglat.y = AMap.Util.format(lnglat.y, 3);
        return lnglat;
    }

    new AMap.DistrictSearch({
        subdistrict: 1,  //返回下一级行政区
        extensions: "base"
    }).search("中国", function (status, result) {
        var provinces = result.districtList[0].districtList;
        var points3D = new AMap.Object3D.Points();
        points3D.transparent = true;

        var geometry = points3D.geometry;
        for(var i = 0; i < provinces.length; i ++) {
            var center = lnglatToG20(provinces[i].center);
            //高度为0
            geometry.vertices.push(center.x, center.y, 0);
            geometry.pointSizes.push(Math.round(Math.random() * 50));
            geometry.vertexColors.push(i * 0.029, i * 0.015, i * 0.001, 0.5);
        }

        points3D.borderColor = [0.6, .8, 1, 1];
        points3D.borderWeight = 3;
        object3Dlayer.add(points3D);
    });
```

##### 圆点 RoundPoints

###### Object3D.Points 是基于 gl.POINTS 绘制的一种三维图形，支持颜色、大小、纹理，绘制效果为圆形点

```
var map = new AMap.Map("container", {
        viewMode: "3D",
        turboMode: false,
        defaultCursor: "pointer",
        showBuildingBlock: false,
        expandZoomRange: true,
        zooms: [3, 20],
        zoom: 4,
        pitch: 50,
        forceVector: true
    });

    var object3Dlayer = new AMap.Object3DLayer({zIndex: 110, opacity: 1});
    map.add(object3Dlayer);

    function lnglatToG20(lnglat) {
        lnglat = map.lngLatToGeodeticCoord(lnglat);
        lnglat.x = AMap.Util.format(lnglat.x, 3);
        lnglat.y = AMap.Util.format(lnglat.y, 3);
        return lnglat;
    }

    new AMap.DistrictSearch({
        subdistrict: 1,  //返回下一级行政区
        extensions: "base"
    }).search("中国", function (status, result) {
        var provinces = result.districtList[0].districtList;
        var points3D = new AMap.Object3D.RoundPoints();
        points3D.transparent = true;

        var geometry = points3D.geometry;
        for(var i = 0; i < provinces.length; i ++) {
            var center = lnglatToG20(provinces[i].center);
            //高度为0
            geometry.vertices.push(center.x, center.y, 0);
            geometry.pointSizes.push(Math.round(Math.random() * 50));
            geometry.vertexColors.push(i * 0.029, i * 0.015, i * 0.001, 0.5);
        }

        points3D.borderColor = [0.6, .8, 1, 1];
        points3D.borderWeight = 3;
        object3Dlayer.add(points3D);
    });
```

##### 气球

###### 本例子组合使用了Object3D.RoundPoints和Object3D.Line，实现了气球点的效果

```
	    var map = new AMap.Map("container", {
        viewMode: "3D",
        turboMode: false,
        defaultCursor: "pointer",
        showBuildingBlock: false,
        expandZoomRange: true,
        zooms: [3, 20],
        zoom: 4,
        pitch: 50,
        forceVector: true
    });

    var object3Dlayer = new AMap.Object3DLayer({zIndex: 110, opacity: 1});
    map.add(object3Dlayer);

    function lnglatToG20(lnglat) {
        lnglat = map.lngLatToGeodeticCoord(lnglat);
        lnglat.x = AMap.Util.format(lnglat.x, 3);
        lnglat.y = AMap.Util.format(lnglat.y, 3);
        return lnglat;
    }

    var lines = new AMap.Object3D.Line();
    var lineGeo = lines.geometry;
    new AMap.DistrictSearch({
        subdistrict: 1,  //返回下一级行政区
        extensions: "base"
    }).search("中国", function (status, result) {
        var provinces = result.districtList[0].districtList;
        var points3D = new AMap.Object3D.RoundPoints();
        points3D.transparent = true;
        var pointsGeo = points3D.geometry;
        for(var i = 0; i < provinces.length; i ++) {
            var center = lnglatToG20(provinces[i].center);
            var size = Math.max(10, Math.round(Math.random() * 40));
            var height = -size * 100000;

            // 连线
            lineGeo.vertices.push(center.x, center.y, 0);
            lineGeo.vertexColors.push(0, 1, 1, 1);
            lineGeo.vertices.push(center.x, center.y, height);
            lineGeo.vertexColors.push(0 , 1, 1, 1);

            pointsGeo.vertices.push(center.x, center.y, 0);  //尾部小点
            pointsGeo.pointSizes.push(5);
            pointsGeo.vertexColors.push(0, 0, 1, 1);

            pointsGeo.vertices.push(center.x, center.y, height);  //空中点
            pointsGeo.pointSizes.push(size);
            pointsGeo.vertexColors.push(i * 0.029, i * 0.015, i * 0.01, 1);
        }
        points3D.borderColor = [.4, .8, 1, 1];
        points3D.borderWeight  = 3;
        object3Dlayer.add(lines);
        object3Dlayer.add(points3D);
    });
```

##### 带纹理的点

###### 为 Points 类型添加纹理。使用 textures、vertexUVs 和 textureIndices 属性

```
    var map = new AMap.Map('container', {
        viewMode: '3D',
        features: ['road', 'bg'],
        // mapStyle: 'amap://styles/whitesmoke',
        zooms: [3, 20],
        zoom: 13
    });

    var object3Dlayer = new AMap.Object3DLayer({zIndex: 110, opacity: 1});
    map.add(object3Dlayer);

    function lnglatToG20(lnglat) {
        lnglat = map.lngLatToGeodeticCoord(lnglat);
        lnglat.x = AMap.Util.format(lnglat.x, 3);
        lnglat.y = AMap.Util.format(lnglat.y, 3);
        return lnglat;
    }

    var coords = [
        [116.397477, 39.908692], // 天安门
        [116.410886, 39.881949], // 天坛
        [116.464332, 39.915299], // 央视
    ];
    var imgs = [
        'https://a.amap.com/jsapi_demos/static/demo-center/3d_texture_tiananmen_256.png',
        'https://a.amap.com/jsapi_demos/static/demo-center/3d_texture_tiantan_256.png',
        'https://a.amap.com/jsapi_demos/static/demo-center/3d_texture_cctv_256.png'
    ];
    var points3D = new AMap.Object3D.Points();
    points3D.transparent = true;
    var geometry = points3D.geometry;
    for(var i = 0; i <  imgs.length; i ++) {
        var img = imgs[i];
        points3D.textures.push(img);
    }

    for(var i = 0; i < coords.length; i ++) {
        var center = lnglatToG20(coords[i]);
        geometry.vertices.push(center.x, center.y, 0);
        geometry.pointSizes.push(80);
        geometry.vertexColors.push(i * 0.029, i * 0.015, i * 0.01, .5);
        geometry.pointAreas.push(0, 0, 1, 1);
        geometry.vertexUVs.push(0, 0, 1, 1);
        geometry.textureIndices.push(i)
    }
    object3Dlayer.add(points3D);
```

#### 输入提示

##### 获取输入提示数据

###### 使用 Autocomplete 获取输入提示信息

```
var map = new AMap.Map('container', {
        resizeEnable: true,
        zoom: 11
    });

    // 获取输入提示信息
    function autoInput(keywords) {

        AMap.plugin("AMap.Autocomplete", function () {
            // 实例化Autocomplete
            var autoOptions = {
                city: "全国"
            }
            var autoComplete = new AMap.Autocomplete(autoOptions);
            autoComplete.search(keywords, function (status, result) {
                console.log(result);
            })
        })
    }
   autoInput("北京")

```

##### 输入提示

###### 使用Autocomplete进行联想输入

```
	    //构建地图
        var map = new AMap.Map("container", {
            resizeEnable: true
        });
        //输入提示
        var a = "北京";
        var auto = new AMap.Autocomplete({
            input: "tipinput"
        });
```

#### POI搜索

##### 获取搜索数据

###### 使用 AMap.PlaceSearch 获取搜索信息

```
        //构建地图
        var map = new AMap.Map("container", {
            resizeEnable: true
        });

        function autoInput(keywords) {
            AMap.plugin("AMap.PlaceSearch", function () {
                var autoOptions = {
                    city: "全国"
                }
                var placeSearch = new AMap.PlaceSearch(autoOptions);
                placeSearch.search(keywords, function (status, result) {
                    console.log(result);
                })
            })
        }
        autoInput("北京大学");
```

##### 关键字搜索

###### PlaceSearch.search，根据关键字进行搜索

```
        //构建地图
        var map = new AMap.Map("container", {
            resizeEnable: true
        });

        AMap.service(["AMap.PlaceSearch"], function () {
            //构造地点查询类
            var placeSearch = new AMap.PlaceSearch({
                pageSize: 5,  //单页显示结果条数
                pageIndex: 1,  //页码
                city: "010",  //兴趣点城市
                citylimit: true,  //是否强制限制在设置的城市内搜索
                map: map,  //展现结果的地图实例
                panel: "panel",  //展现结果的容器
                autoFitView: true   //调整视图为最合适的范围
            })
            //关键字查询
            placeSearch.search("北京大学");
        });
```

##### 多关键字搜索

###### PlaceSearch.search，同时搜索多个关键字

        //构建地图
        var map = new AMap.Map("container", {
            resizeEnable: true
        });
    
        AMap.service(["AMap.PlaceSearch"], function () {
            //构造地点查询类
            var placeSearch = new AMap.PlaceSearch({
                pageSize: 5,  //单页显示结果条数
                pageIndex: 1,  //页码
                city: "010",  //兴趣点城市
                citylimit: true,  //是否强制限制在设置的城市内搜索
                map: map,  //展现结果的地图实例
                panel: "panel",  //展现结果的容器
                autoFitView: true   //调整视图为最合适的范围
            })
            //关键字查询
            placeSearch.search("方恒国际中心 | 大恒科技大厦");
        });
##### 周边搜索

###### PlaceSearch.searchNearBy，在中心点附近一定范围进行关键字搜索

```
        //构建地图
        var map = new AMap.Map("container", {
            resizeEnable: true
        });

        AMap.service(["AMap.PlaceSearch"], function () {
            //构造地点查询类
            var placeSearch = new AMap.PlaceSearch({
                type: "餐饮服务",
                pageSize: 5,  //单页显示结果条数
                pageIndex: 1,  //页码
                city: "010",  //兴趣点城市
                citylimit: true,  //是否强制限制在设置的城市内搜索
                map: map,  //展现结果的地图实例
                panel: "panel",  //展现结果的容器
                autoFitView: true   //调整视图为最合适的范围
            })
            //关键字查询
            var cpoint = [116.405467, 39.907761];
            placeSearch.searchNearBy("", cpoint, 400, function (status, result) {})
        });
```

##### 多边形搜索

###### PlaceSearch.searchInBounds，在多边形范围内进行关键字搜索

```
        //构建地图
        var map = new AMap.Map("container", {
            resizeEnable: true
        });

        AMap.service(["AMap.PlaceSearch"], function () {
            //构造地点查询类
            var placeSearch = new AMap.PlaceSearch({
                type: "餐饮服务",
                pageSize: 5,  //单页显示结果条数
                pageIndex: 1,  //页码
                city: "010",  //兴趣点城市
                citylimit: true,  //是否强制限制在设置的城市内搜索
                map: map,  //展现结果的地图实例
                panel: "panel",  //展现结果的容器
                autoFitView: true   //调整视图为最合适的范围
            })
            //多边形查
            var polygonArr = [//多边形覆盖物节点坐标数组
                [116.403322, 39.920255],
                [116.410703, 39.897555],
                [116.402292, 39.892353],
                [116.389846, 39.891365]
            ];
            var polygon = new AMap.Polygon({
                path: polygonArr,  //设置多边形边界路径
                strokeColor: "#FF33FF",  //线颜色
                strokeOpacity: .2,  //线透明度
                strokeWeight: 3,  //线宽 
                fillColor: "#1791fc",  //填充色
                fillOpacity: 0.35  //填充透明度
            });
            placeSearch.searchInBounds("酒店", polygon);
        });
```

##### 详细查询 

###### PlaceSearch.getDetails，根据POIID获取某个POI的详细信息

```
        //构建地图
        var map = new AMap.Map("container", {
            resizeEnable: true
        });

        var placeSearch = new AMap.PlaceSearch({
            city: "beijing",  //兴趣点城市
            citylimit: true,   //是否限制在设置的城市内搜索
            pageSize: 10,  //单页显示结果条数
            children: 0,  //不展示子节点数据 
            pageIndex: 1,  //页码
            extensions: "base"  //返回基本地址信息
        });

        placeSearch.getDetails("B000A83U0P", function (status, result) {
            if (status === "complete" && result.info === "OK") {
                placeSearch_CallBack(result);
            }
        });

        var infoWindow = new AMap.InfoWindow({
            autoMove: true,  //是否自动调整窗体到视野内
            offset: { x: 0, y: -30 }
        });

        function placeSearch_CallBack(data) {
            var poiArr = data.poiList.pois;
            //添加Marker
            var marker = new AMap.Marker({
                map: map,
                position: poiArr[0].location
            });

            map.setCenter(marker.getPosition());
            infoWindow.setContent(createContent(poiArr[0]));
            infoWindow.open(map, marker.getPosition());
        }
        function createContent(poi) {//信息窗体内容
            var s = []
            s.push("<b>名称：" + poi.name + "</b>");
            s.push("地址：" + poi.address);
            s.push("电话：" + poi.tel);
            s.push("类型：" + poi.type);
            return s.join("<br>");
        }
```

##### 输入提示后查询

###### 组合使用Autocomplete和PlaceSearch进行POI搜索

```
        //地图加载
        var map = new AMap.Map("container", {
            resizeEnable: true
        });
        //输入提示
        var autoOptions = {
            input: "北京"
        };
        var auto = new AMap.Autocomplete(autoOptions);
        var placeSearch = new AMap.PlaceSearch({
            map: map
        });  //构造地点查询类
        AMap.event.addListener(auto, "select", select);//注册监听，当选中某条记录时会触发
        function select(e) {
            placeSearch.setCity(e.poi.adcode);
            placeSearch.search(e.poi.name);  //关键字查询查询
        }
```

##### 根据搜索结果添加 marker

###### 使用 PlaceSearch 进行关键字搜索。

```
        //地图加载
        var map = new AMap.Map("container", {
            resizeEnable: true
        });
        //输入提示
        var placeSearch = new AMap.PlaceSearch({
            city: "021"
        });

        placeSearch.search("东方明珠", function (status, result) {
            console.log(result);
            var pois = result.poiList.pois;
            for (var i = 0; i < pois.length; i++) {
                var poi = pois[i];
                var marker = [];
                marker[i] = new AMap.Marker({
                    position: poi.location,
                    title: poi.name
                });
                map.add(marker[i]);
            }
            map.setFitView();
        });
```

#### 我的数据

##### 叠加云数据图层

```
var map = new AMap.Map('container', {
        resizeEnable: true,
        zoom: 12,
        center: [116.397428, 39.90923]
    });
    addCloudLayer();  //叠加云数据图层
    function addCloudLayer() {
        //加载云图层插件
        map.plugin('AMap.CloudDataLayer', function() {
            var layerOptions = {
                query: {keywords: '公园'},
                clickable: true
            };
            var cloudDataLayer = new AMap.CloudDataLayer('532b9b3ee4b08ebff7d535b4', layerOptions); //实例化云图层类
            cloudDataLayer.setMap(map); //叠加云图层到地图
            AMap.event.addListener(cloudDataLayer, 'click', function(result) {
                var clouddata = result.data;
                var photo = [];
                if (clouddata._image[0]) {//如果有上传的图片
                    photo = ['<img width=240 height=100 src="' + clouddata._image[0]._preurl + '"><br>'];
                }
                var infoWindow = new AMap.InfoWindow({
                    content: "<font class='title'>" + clouddata._name + "</font><hr/>" + photo.join("") + "地址：" + clouddata._address + "<br />" + "创建时间：" + clouddata._createtime + "<br />" + "更新时间：" + clouddata._updatetime,
                    size: new AMap.Size(0, 0),
                    autoMove: true,
                    offset: new AMap.Pixel(0, -25)
                });
                infoWindow.open(map, clouddata._location);
            });
        });
    }
```

##### 周边搜索

###### 使用[CloudDataSearch.searchNearBy](https://lbs.amap.com/api/javascript-api/reference/cloudlayer#CloudDataLayer)方法，搜索传入中心点位置周边的POI，可用于周边服务搜索等场景。

```

```

#### 驾车路线规划

##### 位置经纬度 + 驾车规划路线

###### 使用 AMap.Driving 与『起终点经纬度』进行驾车路线规划

```
var map = new AMap.Map("container", {
    zoom: 12,
    center:  [116.397428, 39.90923],
    resizeEnable: true
});

var driving = new AMap.Driving({
    map: map,
    panel: "panel"
});
driving.search(new AMap.LngLat(116.379028, 39.865042), new AMap.LngLat(116.427281, 39.903719), function (status, result) {
    if(status === "complete") {
        console.log(("绘制路线完成"));
    }else{
        console.log(("获取驾车数据失败" + result));
    }
});
```

##### 地点关键字 + 驾车路线规划

###### 使用 AMap.Driving 与『起终点名称关键字』进行驾车规划路线

```
var map = new AMap.Map("container", {
    zoom: 8,
    center:  [113.29231,23.126441],
    resizeEnable: true
});

var driving = new AMap.Driving({
    map: map,
    panel: "panel"
});

driving.search([{keyword: "广州", city: "广州"}, {keyword: "深圳", city: "深圳"}], function (status, result) {
    if(status === "complete") {
        console.log(("绘制路线完成"));
    }else{
        console.log(("获取驾车数据失败" + result));
    }
});
```

##### 位置经纬度 + 获取驾车规划数据

###### 通过[AMap.Driving](https://lbs.amap.com/api/javascript-api/reference/route-search#m_AMap.Driving)的search方法获取驾车规划数据

```
var map = new AMap.Map("container", {
    zoom: 14,
    center:  [113.29231,23.126441],
    resizeEnable: true
});

var drivingOption = {
    policy:  AMap.DrivingPolicy.LEAST_TIME,
    ferry: 1, //是否可以使用轮渡
    province: "粤",
    map: map,
    panel: "panel"
}
var driving = new AMap.Driving(drivingOption);
driving.search(new AMap.LngLat(116.379028, 39.865042), new AMap.LngLat(116.427281, 39.903719), function (status, result) {
    if(status === "complete") {
        console.log(("绘制路线完成"));
    }else{
        console.log(("获取驾车数据失败" + result));
    }
});
```

##### 规划结果 + 驾车路线绘制

###### 使用[AMap.Driving](https://lbs.amap.com/api/javascript-api/reference/route-search#m_AMap.Driving)获取规划数据后，自定义绘制规划路线

```
var map = new AMap.Map("container", {
    zoom: 14,
    center:  [113.29231,23.126441],
    resizeEnable: true
});

var drivingOption = {
    policy:  AMap.DrivingPolicy.LEAST_TIME,
    ferry: 1, //是否可以使用轮渡
    province: "粤",
}
var driving = new AMap.Driving(drivingOption);
driving.search(new AMap.LngLat(116.379028, 39.865042), new AMap.LngLat(116.427281, 39.903719), function (status, result) {
    if(status === "complete") {
        if(result.routes && result.routes.length) {
            // 绘制第一条路线
            drawRoute(result.routes[0]);
        }
    }else{
        console.log(("获取驾车数据失败" + result));
    }
});

function drawRoute(route) {
    var path = parseRouteToPath(route);
    var startMarker = new AMap.Marker({
        position: path[0],
        icon: 'https://webapi.amap.com/theme/v1.3/markers/n/start.png',
        map: map
    });
    var endMarker = new AMap.Marker({
        position: path[path.length - 1],
        icon: 'https://webapi.amap.com/theme/v1.3/markers/n/end.png',
        map: map
    });

    var routeLine = new AMap.Polyline({
        path: path,
        borderWeight: 2,
        strokeWeight: 5,
        strokeColor: "#0091ff",
        lineJoin: "round"
    });
    routeLine.setMap(map);
    map.setFitView([routeLine, startMarker, endMarker]);
}

function parseRouteToPath(route) {
    var path = [];
    for(var i = 0; i <  route.steps.length; i ++) {
        var step = route.steps[i]

        for(var j = 0; j < step.path.length; j ++) {
            path.push(step.path[j]);
        }
    }
    return path;
}
```

##### 规划结果 + 驾车路线展示

###### 使用 AMap.DrivingRender 直接对路径规划的结果进行驾车路线可视化展示

```
var map = new AMap.Map("container", {
    zoom: 8,
    center:  [113.29231,23.126441],
    resizeEnable: true
});

var drivingOption = {
    policy:  AMap.DrivingPolicy.LEAST_TIME,
    ferry: 1, //是否可以使用轮渡
    province: "粤",
}
var driving = new AMap.Driving(drivingOption);

driving.search([{keyword: "广州", city: "广州"}, {keyword: "深圳", city: "深圳"}], function (status, result) {
    if(status === "complete" && result.info === "OK") {
        (new Lib.AMap.DrivingRender()).autoRender({
            data: result,
            map: map,
            panel: "panel"
        })
    }else{

    }
})
```

##### 可拖拽驾车路线规划

###### 使用 AMap.DragRoute 实现可拖拽途经点的驾车路线规划

```
    var map, route, marker;
 map = new AMap.Map("container", {
    zoom: 8,
    center:  [113.29231,23.126441],
    resizeEnable: true
});

 var path = [];
    path.push([116.303843, 39.983412]);
    path.push([116.321354, 39.896436]);
    path.push([116.407012, 39.992093]);

    map.plugin("AMap.DragRoute", function () {
        route = new AMap.DragRoute(map, path,  AMap.DrivingPolicy.LEAST_FEE); //构造导航类
        route.search();  //开启拖拽
    });
```

##### 途经点

###### 按起终点经纬度规划路线

```
    var map, route, marker;
 map = new AMap.Map("container", {
    zoom: 8,
    center:  [113.29231,23.126441],
    resizeEnable: true
});

 var drivingOpation = {
     map: map,
     panel: "panel"
 }

 var driving = new AMap.Driving(drivingOpation);

 driving.search(new AMap.LngLat(116.379028, 39.865042), new AMap.LngLat(116.427281, 39.903719), {waypoints: [new AMap.LngLat(116.379028, 39.885042)]}, function (status, result) {
     if(status === "complete") {
         console.log("绘制驾车路线完成");
     }else{
         console.log("获取驾车数据失败" + result);
     }
 })
```

#### 货车路线规划

##### 位置经纬度 + 货车路线规划

###### 使用 AMap.TruckDriving 与经纬度信息进行货车路线规划

```
 var map = new AMap.Map("container")

    var truckOptions = {
        map: map,
        policy: 0,
        size: 1,
        city: "beijing",
        panel: "panel"
    }
    //构建货车路线
    var driving = new AMap.TruckDriving(truckOptions);
    var path = []
    path.push({lnglat:[116.303843, 39.983412]});//起点
    path.push({lnglat:[116.321354, 39.896436]});//途径
    path.push({lnglat:[116.407012, 39.992093]});//终点

    driving.search(path, function (status, result) {
        if(status === "complete") {
            console.log("OK");
        }else{
            console.log("No");
        }
    })
```

##### 地点关键字 + 货车路线规划

###### 使用 AMap.TruckDriving 与名称关键字信息进行货车路线规划

```
var map = new AMap.Map("container")
    var truckOptions = {
        map: map,
        policy: 0,
        size: 1,
        city: "beijing",
        panel: "panel"
    }
    //构建货车路线
    var driving = new AMap.TruckDriving(truckOptions);
    var path = [
        {keyword: "广州", "city": "广州"},  //起点
        {keyword: "东莞", "city": "东莞"},  //经点
        {keyword: "深圳", "city": "深圳"}  //终点
    ]
    driving.search(path, function (status, result) {
        if(status === "complete") {
            console.log("完成");
        }else{
            console.log("失败");
        }
    })
```

##### 位置经纬度+获取货车规划数据 

```
  var map = new AMap.Map("container")
        var truckOptions = {
            map: map,
            policy: 0,   //规划策略
            size: 1,  //车型大小
            width: 2.5, //宽度
            height: 2,  //高度
            load: 1,  //载重
            weight: 12,  //自重
            axlesNum: 2,  //轴数
            porvince: "京",  //车辆牌照省份
            isOutline: true,
            outlineColor: "#ffeeee",
            size: 1,
            city: "beijing",
            panel: "panel"
        }
        //构建货车路线
        var truckDriving = new AMap.TruckDriving(truckOptions);
        var path = [
            {keyword: "广州", "city": "广州"},  //起点
            {keyword: "东莞", "city": "东莞"},  //经点
            {keyword: "深圳", "city": "深圳"}  //终点
        ]
        truckDriving.search(path, function (status, result) {
            if(status === "complete") {
                console.log("完成");
            }else{
                console.log("失败");
            }
        })
```

##### 规划结果 + 货车路线绘制	

###### 使用[AMap.TruckDriving](https://lbs.amap.com/api/javascript-api/reference/route-search#truck)的search方法获取规划数据后自定义绘制

```
        var map = new AMap.Map("container")
        var truckOptions = {
            policy: 0,   //规划策略
            size: 1,  //车型大小
            width: 2.5, //宽度
            height: 2,  //高度
            load: 1,  //载重
            weight: 12,  //自重
            axlesNum: 2,  //轴数
            province: "京",  //车辆牌照省份
            city: "beijing",
        }
        //构建货车路线
        var truckDriving = new AMap.TruckDriving(truckOptions);
        var path = [
            {keyword: "广州", "city": "广州"},  //起点
            {keyword: "东莞", "city": "东莞"},  //经点
            {keyword: "深圳", "city": "深圳"}  //终点
        ]
        truckDriving.search(path, function (status, result) {
            if(status === "complete") {

                if(result.routes && result.routes.length) {
                    drawroute(result.routes[0]);
                }
                console.log("完成");
            }else{
                console.log("失败");
            }
        });

        function drawroute(route) {
            var path = parseRouteToPath(route);

            var startMarker = new AMap.Marker({
                position: path[0],
                icon: 'https://webapi.amap.com/theme/v1.3/markers/n/start.png',
                map: map
            });
            var endMarker = new AMap.Marker({
                position: path[path.length - 1],
                icon: 'https://webapi.amap.com/theme/v1.3/markers/n/end.png',
                map: map
            });

            var routeLine = new AMap.Polyline({
                path: path,
                isOutline: true,
                outlineColor: "#ffeeee",
                borderWeight: 2,
                strokeWeight: 5,
                strokeColor: "#0091ff",
                lineJoin: "round"
            });
            routeLine.setMap(map);
            map.setFitView([startMarker, endMarker, routeLine]);
        }

        function parseRouteToPath(route) {
            var path = [];

            for(var i = 0; i < route.steps.length;i ++) {
                var step = route.steps[i]

                for(var j = 0; j < step.path.length; j ++) {
                    path.push(step.path[j]);
                }
            }
            return path;
        }
```

#### 步行路线规划

##### 位置经纬度 + 步行路线规划

###### 使用 AMap.Walking 和 『起终点经纬度』进行步行路线规划

```
       var map = new AMap.Map("container", {
           resizeEnable: true,
           center: [116.397428, 39.90923],
           zoom: 13
       });
       var walking = new AMap.Walking({
           map: map,
           panel: "panel"
       });

       walking.search([113.244245,23.128967], [113.071358,22.544442], function(status, result) {
           if (status === 'complete') {
               console.log(('绘制步行路线完成'));
           } else {
               console.log(('步行路线数据查询失败' + result));
           }
       });
```

##### 地点关键字 + 步行路线规划

###### 使用 AMap.Walking 和 『起终点关键字』进行步行路线规划

```
       var map = new AMap.Map("container", {
           resizeEnable: true,
           center: [116.397428, 39.90923],
           zoom: 13
       });
       var walking = new AMap.Walking({
           map: map,
           panel: "panel"
       });

       walking.search([{keyword: "广州", city: "广州"}, {keyword: "江门", city: "江门"}], function(status, result) {
           if (status === 'complete') {
               console.log(('绘制步行路线完成'));
           } else {
               console.log(('步行路线数据查询失败' + result));
           }
       });
```

##### 规划结果 + 步行路线展示

###### 使用 AMap.WalkingRender 对『步行路线规划结果数据』进行可视化展示

```
	       var map = new AMap.Map("container", {
           resizeEnable: true,
           center: [116.397428, 39.90923],
           zoom: 13
       });
       var walking = new AMap.Walking();

       walking.search([{keyword: "广州", city: "广州"}, {keyword: "江门", city: "江门"}], function(status, result) {
           if (status === 'complete') {
               (new Lib.AMap.WalkingRender()).autoRender({
                   data: result,
                   map: map,
                   panel: "panel"
               });
           } else {
               console.log(('步行路线数据查询失败' + result));
           }
       });
```

##### 规划结果 + 步行路线绘制

###### 使用[AMap.Walk](https://lbs.amap.com/api/javascript-api/reference/route-search#m_AMap.Walking)获取规划路线并自定义绘制

```
       var map = new AMap.Map("container", {
           resizeEnable: true,
           center: [116.397428, 39.90923],
           zoom: 13,
           viewMode: "3D"
       });
       var walking = new AMap.Walking();

       walking.search([{keyword: "广州", city: "广州"}, {keyword: "江门", city: "江门"}], function(status, result) {
           if (status === 'complete') {
               if(result.routes && result.routes.length) {
                   drawRoute(result.routes[0]);
               }
           } else {
               console.log(('步行路线数据查询失败' + result));
           }
       });
       function drawRoute(route) {
           var path = parseRouteToPath(route);

           var startMarker = new AMap.Marker({
               position: path[0],
               icon: "https://webapi.amap.com/theme/v1.3/markers/n/start.png",
               map: map
           });
           var endMarker = new AMap.Marker({
               position: path[path.length - 1],
               icon: "https://webapi.amap.com/theme/v1.3/markers/n/end.png",
               map: map
           });

           var routeLine = new AMap.Polyline({
               path: path,
               isOutline: true,
               outlineColor: "#ffeeee",
               borderWeight: 2,
               strokeWeight: 5,
               strokeColor: "#0091ff",
               lineJoin: "round"
           });
           routeLine.setMap(map);
           map.setFitView([startMarker, endMarker, routeLine]);
       }

       function parseRouteToPath(route) {
           var path = [];
           for(var i = 0; i < route.steps.length; i ++) {
               var step = route.steps[i]

               for(var j = 0; j < step.path.length; j ++) {
                   path.push(step.path[j]);
               }
           }
           return path;
       }
```

##### 位置经纬度 + 获取步行规划数据

###### 使用[AMap.Walk](https://lbs.amap.com/api/javascript-api/reference/route-search#m_AMap.Walking)的search方法获取步行规划数据

```
       var map = new AMap.Map("container", {
           resizeEnable: true,
           center: [116.397428, 39.90923],
           zoom: 13,
           viewMode: "3D"
       });

       var walkOption = {
           map: map,
           panel: "panel",
           hideMarkers: false,
           isOutline: true,
           outlineColor: "#ffeeee",
           autoFitView: true
       }
       var walking = new AMap.Walking(walkOption);

       walking.search([{keyword: "广州", city: "广州"}, {keyword: "江门", city: "江门"}], function (status, result) {
           if(status === "complete") {
               console.log("成功");
           }else{
               console.log("失败");
           }
       })
```

#### 骑行路径规划

##### 位置经纬度 + 骑行路线规划

###### 使用 AMap.Riding 和『起终点经纬度』进行骑行路线规划

```
    var map = new AMap.Map("container", {
        resizeEnable: true,
        zoom: 13,
        center: [116.397428, 39.90923]
    });

    // 构建骑行导航
    var riding = new AMap.Riding({
        map: map,
        panel: "panel"
    });
    //骑行路线
    riding.search([113.244245,23.128967], [113.071358,22.544442], function (status, result) {
        if(status === "complete") {
            console.log("成功");
        }else{
            console.log("失败");
        }
    });
```

##### 地点关键字 + 骑行路线规划

###### 使用 AMap.Riding 和『起终点关键字』进行骑行路线规划

```
    // 骑行路线规划
    var map = new AMap.Map("container", {
        resizeEnable: true,
        zoom: 13,
        center: [116.397428, 39.90923]
    });

    // 构建骑行导航
    var riding = new AMap.Riding({
        map: map,
        panel: "panel"
    });
    //骑行路线
    riding.search([{keyword: "广州", city: "广州"}, {keyword: "江门", city: "江门"}], function (status, result) {
        if(status === "complete") {
            console.log("成功");
        }else{
            console.log("失败");
        }
    });
```

##### 位置经纬度 + 获取骑行规划数据

###### 使用[AMap.Riding](https://lbs.amap.com/api/javascript-api/reference/route-search#AMap.Riding)的search方法获取规划数据

```
// 构建地图
    var map = new AMap.Map("container", {
        resizeEnable: true,
        zoom: 13,
        center: [116.397428, 39.90923]
    });

    // 导航数据
    var ridingOption = {
        map: map,
        panel: "panel",
        policy: 1,
        hideMarkers: false,
        isOutline: true,
        outlineColor: "#ffeeee",
        autoFitView: true
    }
    // 构建骑行导航
    var riding = new AMap.Riding(ridingOption);
    //骑行路线
    riding.search([113.244245,23.128967], [113.071358,22.544442], function (status, result) {
        if(status === "complete") {
            console.log("成功");
        }else{
            console.log("失败");
        }
    });

```

##### 规划结果 + 骑行路线绘制

###### 使用[AMap.Riding](https://lbs.amap.com/api/javascript-api/reference/route-search#AMap.Riding)获取规划数据并自定义绘制

```
 // 构建地图
    var map = new AMap.Map("container", {
        resizeEnable: true,
        zoom: 13,
        center: [116.397428, 39.90923]
    });

    var ridingOption = {
        policy: 1
    }
    var riding = new AMap.Riding(ridingOption);

    riding.search([113.244245,23.128967], [113.071358,22.544442], function (status, result) {
        if(status === "complete") {
            console.log("成功");
            if(result.routes && result.routes.length) {
                drawRoute(result.routes[0])
            }
        }else{
            console.log("失败");
        }
    });

    function drawRoute(route) {
        var path = parseRouteToPath(route);

        var startMarker = new AMap.Marker({
            position: path[0],
            icon: 'https://webapi.amap.com/theme/v1.3/markers/n/start.png',
            map: map
        });

        var endMarker = new AMap.Marker({
            position: path[path.length - 1],
            icon: "https://webapi.amap.com/theme/v1.3/markers/n/end.png",
            map: map
        });

        var routeLine = new AMap.Polyline({
            path: path,
            isOutline: true,
            outlineColor: "#ffeeee",
            borderWeight: 2,
            strokeWeight: 5,
            strokeColor: "#0091ff",
            lineJoin: "round"
        });

        routeLine.setMap(map);
        map.setFitView([startMarker, endMarker, routeLine]);
    }

    function parseRouteToPath(route) {
        var path = [];
        for(var i = 0; i < route.rides.length; i ++) {
            var step = route.rides[i]

            for(var j = 0; j < step.path.length; j ++) {
                path.push(step.path[j]);
            }
        }
        return path;
    }
```

#### 公交路线规划

##### 位置经纬度 + 公交路线规划

###### 使用 AMap.Transfer 和『起终点经纬度』进行公交路线规划

```
   var map = new AMap.Map("container", {
       resizeEnable: true,
       center: [116.397428, 39.90923],
       zoom: 13
   });
   var transOptions = {
       map: map,
       city: "北京市",
       panel: "panel",
       policy:  AMap.TransferPolicy.LEAST_TIME
   }

   var transfer = new AMap.Transfer(transOptions);
   transfer.search([116.291035,39.907899], [116.427281, 39.903719], function (status, result) {
       if(status === "complete") {
           console.log("完成");
       }else{
           console.log("失败" + result);
       }
   })
```

##### 地点关键字 + 公交路线规划

###### 使用 AMap.Transfer 和 『起终点关键字』进行公交路线规划

```
   var map = new AMap.Map("container", {
       resizeEnable: true,
       center: [116.397428, 39.90923],
       zoom: 13
   });
   var transOptions = {
       map: map,
       city: "北京市",
       panel: "panel",
       policy:  AMap.TransferPolicy.LEAST_TIME
   }

   var transfer = new AMap.Transfer(transOptions);
   transfer.search([{keyword: '地震局',city:'北京'}, {keyword: '望京西园4区',city:'北京'}], function (status, result) {
       if(status === "complete") {
           console.log("完成");
       }else{
           console.log("失败" + result);
       }
   });
```

##### 位置经纬度 + 获取公交规划数据

###### 使用[AMap.Transfer](https://lbs.amap.com/api/javascript-api/reference/route-search#m_AMap.Transfer)的search方法获取规划数据

```
   var map = new AMap.Map("container", {
       resizeEnable: true,
       center: [116.397428, 39.90923],
       zoom: 13
   });
   var transOptions = {
       map: map,
       city: "北京市",
       panel: "panel",
       nightflag: true,  //是否计算夜班车,
       autoFitView: true,
       outLineColor: "#ffeeee",
       policy:  AMap.TransferPolicy.LEAST_TIME
   }

   var transfer = new AMap.Transfer(transOptions);
   transfer.search([116.291035,39.907899], [116.427281, 39.903719], function (status, result) {
       if(status === "complete") {
           console.log("成功");
       }else{
           console.log("失败");
       }
   });
```

##### 规划结果 + 公交路线展示

###### 使用 AMap.TransferRender 对『公交路线规划结果数据』进行可视化展示

```
   var map = new AMap.Map("container", {
       resizeEnable: true,
       center: [116.397428, 39.90923],
       zoom: 13
   });
   var transOptions = {
       city: "北京市",
       nightflag: true,  //是否计算夜班车,
       autoFitView: true,
       policy:  AMap.TransferPolicy.LEAST_TIME
   }

   var transfer = new AMap.Transfer(transOptions);
   transfer.search([116.291035,39.907899], [116.427281, 39.903719], function (status, result) {
       if(status === "complete") {
           console.log("成功");
           (new Lib.AMap.TransferRender()).autoRender({
               data: result,
               map: map,
               panel: "panel"
           })
       }else{
           console.log("失败");
       }
   });
```

##### 规划结果 + 公交路线绘制

###### 使用[AMap.Transfer](https://lbs.amap.com/api/javascript-api/reference/route-search#m_AMap.Transfer)获取规划数据并自定义绘制

```
var map = new AMap.Map("container", {
       resizeEnable: true,
       center: [116.397428, 39.90923],
       zoom: 13
   });
   var transOptions = {
       city: "北京市",
       nightflag: true,  //是否计算夜班车,
       autoFitView: true,
       policy:  AMap.TransferPolicy.LEAST_TIME
   }

   var transfer = new AMap.Transfer(transOptions);
   transfer.search([116.291035,39.907899], [116.427281, 39.903719], function (status, result) {
       if(status === "complete") {
           console.log("成功");
           if(result.plans && result.plans.length) {
               drawRoute(result.plans[0]);
           }
       }else{
           console.log("失败");
       }
   });

   function drawRoute(route) {
       var startMarker = new AMap.Marker({
           position: route.segments[0].transit.origin,
           icon: 'https://webapi.amap.com/theme/v1.3/markers/n/start.png',
           map: map
       })

       var endMarker = new AMap.Marker({
           position: route.segments[route.segments.length - 1].transit.destination,
           icon: 'https://webapi.amap.com/theme/v1.3/markers/n/end.png',
           map: map
       });

       var routeLines = [];

       for(var i = 0; i < route.segments.length; i ++) {
           var segment = route.segments[i]
           var line = null;


           if(segment.transit_mode === "WALK") {
               line = new AMap.Polyline({
                   path: segment.transit.path,
                   isOutline: true,
                   outlineColor: "#ffeeee",
                   borderWeight: 2,
                   strokeWeight: 5,
                   strokeColor: "grey",
                   lineJoin: "round"
               });
               line.setMap(map);
               routeLines.push(line);
           }else if (segment.transit_mode === 'SUBWAY' || segment.transit_mode === 'BUS') {
               line = new AMap.Polyline({
                   path: segment.transit.path,
                   isOutline: true,
                   outlineColor: '#ffeeee',
                   borderWeight: 2,
                   strokeWeight: 5,
                   strokeColor: '#0091ff',
                   lineJoin: 'round',
                   strokeStyle: 'solid'
               })

               line.setMap(map)
               routeLines.push(line)
           } else {
               // 其它transit_mode的情况如RAILWAY、TAXI等，该示例中不做处理
           }
       }
       // 调整视野达到最佳显示区域
       map.setFitView([ startMarker, endMarker ].concat(routeLines));
   }
```

#### 地理编码

##### 地理编码（地址 -> 坐标）

###### Geocoder.getLocation，使用地理编码接口，根据地址转获取经纬度位置

```
   var map = new AMap.Map("container", {
       resizeEnable: true
   });

   var geocoder, marker;
   function geoCode(value) {
       if(!geocoder) {
           geocoder = new AMap.Geocoder({
               city: "010"  //北京
           })
       }
       geocoder.getLocation(value, function (status, result) {
           if(status === 'complete' && result.geocodes.length) {
               var lnglat = result.geocodes[0].location;
                   value = lnglat;
               if(!marker) {
                   marker = new AMap.Marker();
                   map.add(marker);
               }
               console.log(value);
               marker.setPosition(lnglat);
               map.setFitView(marker);
           }else{
               console.log("失败");
           }
       })
   }
    geoCode("北京市朝阳区阜荣街10号")
```

##### 批量地理编码	

###### Geocoder插件支持批量地理编码查询，将多个地址一次转换为经纬度

```
   var map = new AMap.Map("container", {
       resizeEnable: true
   });
   
var geocoder, markers = [];
   function geoCode(value) {
       if(!geocoder){
           geocoder = new AMap.Geocoder({
                   city: "010", //城市设为北京，默认：“全国”
           });
       }
       map.remove(markers);
       markers = [];
       geocoder.getLocation(value, function(status, result) {
           if (status === 'complete'&&result.geocodes.length) {
               for(var i = 0;i < result.geocodes.length; i ++){
                   var lnglat = result.geocodes[i].location;
                   value = lnglat;
                   console.log(value)
                   var  marker = new AMap.Marker({
                       position: result.geocodes[i].location
                   });
                   markers.push(marker);
               }
               map.add(markers);
               map.setFitView(markers);
           }
       });
   }
    geoCode(["北京市朝阳区阜荣街10号", "朝阳区广顺南大街13号", "朝阳区阜通西大街17号"])
```

##### 逆地理编码（坐标 -> 地址）

###### Geocoder.getAddress，逆地理编码，根据经纬度获取详细地址信息

```
    var map = new AMap.Map("container", {
        resizeEnable: true
    });

    var geocoder, marker;
    function regeoCode(lnglat) {
        if(!geocoder) {
            geocoder = new AMap.Geocoder({
                city: "010",
                radius: 100  //范围
            })
        }
        if(!marker) {
            marker = new AMap.Marker();
            map.add(marker);
        }
        marker.setPosition(lnglat);

        geocoder.getAddress(lnglat, function (status, result) {
            if(status === "complete" && result.regeocode) {
                var address = result.regeocode.formattedAddress;
                console.log(address);
            }else{
                console.log("失败");
            }
        })
    }
    map.on("click", function (e) { regeoCode([e.lnglat.getLng(),e.lnglat.getLat()])});
```

#### 行政区划查询

##### 行政区边界查询

###### 使用DistrictSearch.search获取某个行政区的边界信息，并绘制行政区划边界。

```
        //初始化地图对象，加载地图
        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.397428, 39.90923],//地图中心点
            zoom: 10 //地图显示的缩放级别
        });   

        var district = null;
        var polygons = [];
        function drawBounds() {
            if (!district) {
                var opts = {
                    subdistrict: 0,  //获取边界不需要返回下级行政区
                    extensions: "all",  //返回行政区边界坐标组等具体信息
                    level: "district",  //查询级别为市
                }
                district = new AMap.DistrictSearch(opts);
            }
            district.search("越秀区", function (status, result) {
                map.remove(polygons);  //清除上次结果 
                polygons = [];
                var bounds = result.districtList[0].boundaries;
                if (bounds) {
                    for (var i = 0; i < bounds.length; i++) {
                        var polygon = new AMap.Polygon({
                            strokeWeight: 1,
                            path: bounds[i],
                            fillOpacity: .4,
                            fillColor: "#80d8ff",
                            strokeColor: '#0091ea'
                        });
                        polygons.push(polygon);
                    }
                }
                map.add(polygons);
                map.setFitView(polygons);  //视口自适应
            });

        }
        drawBounds()
```

##### 下属行政区查询

###### 使用DistrictSearch逐级别依次搜索下级行政区的信息，并生成下拉列表。

```
 var map, district, polygons = [], citycode;
    var citySelect = document.getElementById('city');
    var districtSelect = document.getElementById('district');
    var areaSelect = document.getElementById('street');

    map = new AMap.Map('container', {
        resizeEnable: true,
        center: [116.30946, 39.937629],
        zoom: 3
    });
    //行政区划查询
    var opts = {
        subdistrict: 1,   //返回下一级行政区
        showbiz:false  //最后一级返回街道信息
    };
    district = new AMap.DistrictSearch(opts);//注意：需要使用插件同步下发功能才能这样直接使用
    district.search('中国', function(status, result) {
        if(status=='complete'){
            getData(result.districtList[0]);
        }
    });
    function getData(data,level) {
        var bounds = data.boundaries;
        if (bounds) {
            for (var i = 0, l = bounds.length; i < l; i++) {
                var polygon = new AMap.Polygon({
                    map: map,
                    strokeWeight: 1,
                    strokeColor: '#0091ea',
                    fillColor: '#80d8ff',
                    fillOpacity: 0.2,
                    path: bounds[i]
                });
                polygons.push(polygon);
            }
            map.setFitView();//地图自适应
        }
       
        //清空下一级别的下拉列表
        if (level === 'province') {
            citySelect.innerHTML = '';
            districtSelect.innerHTML = '';
            areaSelect.innerHTML = '';
        } else if (level === 'city') {
            districtSelect.innerHTML = '';
            areaSelect.innerHTML = '';
        } else if (level === 'district') {
            areaSelect.innerHTML = '';
        }

        var subList = data.districtList;
        if (subList) {
            var contentSub = new Option('--请选择--');
            var curlevel = subList[0].level;
            var curList =  document.querySelector('#' + curlevel);
            curList.add(contentSub);
            for (var i = 0, l = subList.length; i < l; i++) {
                var name = subList[i].name;
                var levelSub = subList[i].level;
                var cityCode = subList[i].citycode;
                contentSub = new Option(name);
                contentSub.setAttribute("value", levelSub);
                contentSub.center = subList[i].center;
                contentSub.adcode = subList[i].adcode;
                curList.add(contentSub);
            }
        }
        
    }
    function search(obj) {
        //清除地图上所有覆盖物
        for (var i = 0, l = polygons.length; i < l; i++) {
            polygons[i].setMap(null);
        }
        var option = obj[obj.options.selectedIndex];
        var keyword = option.text; //关键字
        var adcode = option.adcode;
        district.setLevel(option.value); //行政区级别
        district.setExtensions('all');
        //行政区查询	
        //按照adcode进行查询可以保证数据返回的唯一性
        district.search(adcode, function(status, result) {
            if(status === 'complete'){
                getData(result.districtList[0],obj.id);
            }
        });
    }
    function setCenter(obj){
        map.setCenter(obj[obj.options.selectedIndex].center)
    }
```

#### 公交信息查询 

##### 公交站点查询

###### 使用 AMap.StationSearch 和『站点关键字』进行公交站点查询

```
var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 13,
            center: [116.397428, 39.90923]
        });

        //公交站点查询
        stationSearch("公园前")
        function stationSearch(stationKeyWord) {

            if (stationKeyWord) {
                var station = new AMap.StationSearch({
                    pageIndex: 1,  //页码
                    pageSize: 60,  //单页显示结果条数
                    city: "广州"  //确定搜索城市
                });
                station.search(stationKeyWord, function (status, result) {
                    if (status === "complete" && result.info === "OK") {
                        stationSearch_CallBack(result);
                    } else {
                        console.log("查询失败");
                    }
                })
            }
        }
        //公交站点查询返回数据解析
        function stationSearch_CallBack(searchResult) {
            var stationArr = searchResult.stationInfo;
            var searchNum = stationArr.length;
            console.log(searchNum);
            if (searchNum > 0) {
                for (var i = 0; i < searchNum; i++) {
                    var marker = new AMap.Marker({
                        icon: new AMap.Icon({
                            image: "https://a.amap.com/jsapi_demos/static/resource/img/pin.png",
                            size: new AMap.Size(32, 32),
                            imageSize: new AMap.Size(32, 32)
                        }),
                        offset: new AMap.Pixel(-16, -32),
                        position: stationArr[i].location,
                        map: map,
                        title: stationArr[i].name
                    })
                    marker.info = new AMap.InfoWindow({
                        content: stationArr[i].name,
                        offset: new AMap.Pixel(0, -30)
                    });
                    marker.on("mouseover", function (e) {
                        e.target.info.open(map, e.target.getPosition());
                    });
                }
                map.setFitView();
            }
        }
```

##### 公交线路查询

###### 使用 AMap.LineSearch 进行公交线路查询

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 8,
            center: [113.279325,22.879363]
        });
        //公交线路查询 
         var linesearch;
        function lineSearch(busLineName) {
            if (busLineName) {
                linesearch = new AMap.LineSearch({
                    pageIndex: 1,
                    city: "广州",
                    pageSize: 1,
                    extensions: "all"
                })
            }
            linesearch.search(busLineName, function (status, result) {
                map.clearMap();
                if (status === "complete" && result.info === "OK") {
                    lineSearch_Callback(result);
                } else {
                    alert(result);
                }
            })
        }
        function lineSearch_Callback(data) {
            var lineArr = data.lineInfo;
            var lineNum = data.lineInfo.length;
            if (lineNum == 0) {

            } else {
                for (var i = 0; i < lineNum; i++) {
                    var pathArr = lineArr[i].path;
                    var stops = lineArr[i].via_stops;
                    var startPot = stops[0].location;
                    var endPot = stops[stops.length - 1].location;
                    if (i == 0) {
                        //作为示例，只绘制一条线路
                        drawbusLine(startPot, endPot, pathArr)
                    }
                }
            }
        }
         /*绘制路线*/
        function drawbusLine(startPot, endPot, BusArr) {
            //绘制起点，终点
            new AMap.Marker({
                map: map,
                position: startPot,  //基点位置
                icon: "https://webapi.amap.com/theme/v1.3/markers/n/start.png",
                zIndex: 10
            });
            new AMap.Marker({
                map: map,
                position: endPot,  //基点位置
                icon: "https://webapi.amap.com/theme/v1.3/markers/n/end.png",
                zIndex: 10
            })
            //绘制乘车的路线
            busPolyline = new AMap.Polyline({
                map: map,
                path: BusArr,
                strokeColor: "#09f",  //线颜色
                strokeOpacity: .8,  //线透明度
                isOutline: true,
                outlineColor: "#fff",
                strokeWeight: 6  //线宽
            });
            map.setFitView();
        }
        lineSearch("244A");
```

##### 公交到达圈

###### 通过 AMap.ArrivalRange 可获取通过公交出行方式，一定时间内可以到达的的范围

```
 var map = new AMap.Map("container", {
            resizeEnable: true,
            zoomEnable: true,
            center: [116.397428, 39.90923],
            zoom: 10
        });

        function getLnglat(e) {
            var lnglat = e.lnglat;
            document.getElementById('lnglat').value = e.lnglat.toString()
            getArriveRange();
        }
        map.on('click', getLnglat);

        var centerMarker;
        function addCenterMarker(position) {
            if (!centerMarker) {
                centerMarker = new AMap.Marker({
                    map: map,
                    position: position
                });
            } else {
                centerMarker.setPosition(position)
            }
        }


        var arrivalRange, polygons = [];
        //添加多边形覆盖物
        function getArriveRange() {
            if (!arrivalRange) {
                arrivalRange = new AMap.ArrivalRange()
            }
            var lnglat = $("#lnglat").val().split(',');
            var t = $("#t").val();
            var v = $("#v").val();

            addCenterMarker(lnglat);

            arrivalRange.search(lnglat, t, function (status, result) {
                map.remove(polygons);
                polygons = [];
                if (result.bounds) {
                    for (var i = 0; i < result.bounds.length; i++) {
                        var polygon = new AMap.Polygon({
                            fillColor: "#3366FF",
                            fillOpacity: "0.4",
                            strokeColor: "#00FF00",
                            strokeOpacity: "0.5",
                            strokeWeight: 1
                        });
                        polygon.setPath(result.bounds[i]);
                        polygons.push(polygon);
                    }
                    map.add(polygons);
                    map.setFitView();
                }
            }, {
                    policy: v
                });
        }

        var isChanged = false;
        $(function () {
            $('.single-slider').jRange({
                onstatechange: getArriveRange,
                from: 1,
                to: 45,
                step: 1,
                scale: [1, 15, 30, 45],
                format: '%s',
                width: 400,
                showLabels: true,
                showScale: true
            });
        });
        getArriveRange();

        $('#search').on('click', getArriveRange);
        $('#v').on('change', getArriveRange);
        $('#clear').on('click', function () { map.remove(polygons) });
```

#### 轨迹纠偏

##### 驾车轨迹纠偏

###### GraspRoad的驾车轨迹纠偏接口可以将偏离道路的轨迹路径纠正到道路上

```
  //轨迹纠偏
        var map = new AMap.Map("container", {
            resizeEnable: true
        });

        var graspRoad;

        var pathParam = [{ "x": 116.478928, "y": 39.997761, "sp": 19, "ag": 0, "tm": 1478031031 },
            { "x":116.478907, "y":39.998422, "sp":10, "ag":0, "tm":2},
            { "x":116.479384, "y":39.998546, "sp":10, "ag":110, "tm":3},
            { "x":116.481053, "y":39.998204, "sp":10, "ag":120, "tm":4},
            { "x":116.481793, "y":39.997868, "sp":10, "ag":120, "tm":5},
            { "x":116.482898, "y":39.998217, "sp":10, "ag":30, "tm":6},
            { "x":116.483789, "y":39.999063, "sp":10, "ag":30, "tm":7},
            { "x":116.484674, "y":39.999844, "sp":10, "ag":30, "tm":8}]
        var path1 = [];
        for (var i = 0; i < pathParam.length; i++) {
            path1.push([pathParam[i].x, pathParam[i].y]);
        }
        var oldLine = new AMap.Polyline({
            path: path1,
            strokeWeight: 8,
            strokeColor: "red",
            strokeOpacity: 1
        });
        map.add(oldLine);
        if (!graspRoad) {
            //构建轨迹纠偏
            graspRoad = new AMap.GraspRoad();
        }
        graspRoad.driving(pathParam, function (error, result) {
            if (!error) {
                var path2 = [];
                var newPath = result.data.points;
                for (var i = 0; i < newPath.length; i++) {
                    path2.push([newPath[i].x, newPath[i].y]);
                }
                var newLine = new AMap.Polyline({
                    path: path2,
                    strokeWeight: 8,
                    strokeOpacity: .8,
                    strokeColor: "#0091ea",
                    showDir: true
                });
                map.add(newLine);
                map.setFitView();
            }
        })
```

#### 定位

##### IP城市定位

###### 使用[CitySearch.getLocalCity](https://lbs.amap.com/api/javascript-api/reference/location#m_AMap.CitySearch)可根据IP进行城市级定位，获得用户当前所在城市信息，适用于PC端以及GPS信号不佳的场景

```
      //IP城市定位
        var map = new AMap.Map("container", {
            resizeEnable: true,
            center: [116.397428, 39.90923],
            zoom: 13
        });

        showCityInfo();
        //获取用户所在的城市信息
        function showCityInfo() {
            //实例化城市查询 
            var citysearch = new AMap.CitySearch();
            citysearch.getLocalCity(function (status, result) {
                if (status === "complete" && result.info === "OK") {
                    if (result && result.city && result.bounds) {
                        var cityinfo = result.city;
                        var citybounds = result.bounds;
                        console.log(cityinfo);
                        //显示当前城市
                        map.setBounds(citybounds);
                    }
                } else {
                    console.log("查询城市失败");
                }
            })
        }
```

##### 地图初始IP城市定位

###### Map实例初始化时，不设定center时，API 将根据用户 IP 自动匹配地图中心点到用户所在城市的中心

```
		//IP城市定位
        var map = new AMap.Map("container", {
            resizeEnable: true,
        });

        console.log("当前中心点：" + map.getCenter() + "当前城市：" + map.getAdcode());
```

##### 浏览器精确定位

###### 使用[Geolocation.getCurrentPosition](https://lbs.amap.com/api/javascript-api/reference/location#m_AMap.Geolocation)获取当前位置，可用于依赖于于用户定位的场景。

```
        var map = new AMap.Map("container", {
            resizeEnable: true
        });

        AMap.plugin("AMap.Geolocation", function () {
            var geolocation = new AMap.Geolocation({
                enableHighAccuracy: true,  //是否使用高精度定位
                timeout: 10000,  //超过10秒后停止定位，默认5S
                buttonPosition: "RB",  //定位按扭的依靠位置
                buttonOffset: new AMap.Pixel(10, 20),  //定位按扭与设置的停靠位置的偏移量
                zoomToAccuray: true,  //定位成功后是否自动调整地图视野到定位点 
            });
            map.addControl(geolocation);
            geolocation.getCurrentPosition(function (status, result) {
                if (status === "complete") {
                    onComplete(result);
                } else {
                    onError(result);
                }
            })
        });

        //解析定位结果 
        //成功
        function onComplete(data) {
            console.log("OK");
            var str = [];
            str.push("定位结果" + data.position);
            str.push("定位类别" + data.location_type);
            if (data.accuracy) {
                str.push("精度：" + data.accuracy + "米");
            }
            str.push("是否经过偏移" + (data.isConverted ? "是" : "否"));
            console.log(str);
        }

        //失败
        function onError(data) {
            console.log(data.message);
        }
```

##### 浏览器精确定位-定位点自定义

###### 通过给Geolocation设定相关属性，可以自定义定位按钮、定位点和精度圆的显示样式以及是否显示

```
       //浏览器精确定位-定位点自定义
        var map = new AMap.Map("container", {
            resizeEnable: true
        });

        var options = {
            "showButton": true,  //是否显示定位按钮
            "buttonPosition": "LB",  //定位按钮的位置
            "buttonOffset": new AMap.Pixel(10, 20),  //定位按钮距离对应角落的距离
            "showMarker": true, //是否显示定位点
            "markerOptions": {
                "offset": new AMap.Pixel(-18, -36),
               "content": '<img src="https://a.amap.com/jsapi_demos/static/resource/img/user.png" style="width:36px;height:36px"/>'
            },
            "showCircle": true,  //是否显示定位精度圈
            "circleOptions": {
                "strokeColor": "#0093FF",
                "noSelect": true,
                "strokeOpacity": .5,
                "strokeWeight": 1,
                "fillColor": "#02B0FF",
                "fillOpacity": .25
            }
        }
        AMap.plugin(["AMap.Geolocation"], function () {
            var geolocation = new AMap.Geolocation(options);
            map.addControl(geolocation);
            geolocation.getCurrentPosition();
        })
```

#### 天气预报

###### 使用[Weather](https://lbs.amap.com/api/javascript-api/reference/search_plugin#m_AMap.Weather)插件，获取指定地区的天气信息，可用于天气查询等场景。

```
        //浏览器精确定位-定位点自定义
        var map = new AMap.Map('container', {
            resizeEnable: true,
            center: [116.486409, 39.921489],
            zoom: 12
        });
        AMap.plugin("AMap.Weather", function () {
            var weather = new AMap.Weather();
            //查询实时天气
            weather.getLive("广州", function (err, data) {
                if (!err) {
                    var str = [];
                    str.push('<h4 >实时天气' + '</h4><hr>');
                    str.push('<p>城市/区：' + data.city + '</p>');
                    str.push('<p>天气：' + data.weather + '</p>');
                    str.push('<p>温度：' + data.temperature + '℃</p>');
                    str.push('<p>风向：' + data.windDirection + '</p>');
                    str.push('<p>风力：' + data.windPower + ' 级</p>');
                    str.push('<p>空气湿度：' + data.humidity + '</p>');
                    str.push('<p>发布时间：' + data.reportTime + '</p>');
                    var marker = new AMap.Marker({ map: map, position: map.getCenter() });
                    var infoWin = new AMap.InfoWindow({
                        content: '<div class="info" style="position:inherit;margin-bottom:0;">' + str.join('') + '</div><div class="sharp"></div>',
                        isCustom: true,
                        offset: new AMap.Pixel(0, -37)
                    });
                    infoWin.open(map, marker.getPosition());
                    marker.on("mouseover", function () {
                        infoWin.open(map, marker.getPosition());
                    })
                }


            })

            weather.getForecast('朝阳区', function (err, data) {
                if (err) { return; }
                var str = [];
                for (var i = 0, dayWeather; i < data.forecasts.length; i++) {
                    dayWeather = data.forecasts[i];
                    str.push(dayWeather.date + ' <span class="weather">' + dayWeather.dayWeather + '</span> ' + dayWeather.nightTemp + '~' + dayWeather.dayTemp + '℃');
                }
                console.log(str);
            });
        })
```

#### 工具类

##### 鼠标工具-绘制覆盖物

###### 使用[MouseTool](https://lbs.amap.com/api/javascript-api/reference/plugin#AMap.MouseTool)可以在地图上绘制Marker、Polyline、Poly	gon和Circle

```
        var map = new AMap.Map("container", {
            resizeEnable: true
        });

        var mouseTool = new AMap.MouseTool(map);
        var overlays = [];
        mouseTool.on("draw", function (e) {
            overlays.push(e.obj);
        });

        function draw(type) {
            switch (type) {
                case "marker": {
                    mouseTool.marker({});
                    break;
                }
                case "polyline": {
                    mouseTool.polyline({
                        strokeColor: "#80d8ff"
                    });
                    break;
                }
                case "rectangle": {
                    mouseTool.rectangle({
                        fillColor: "#00b0ff",
                        strokeColor: "#80d8ff"
                    });
                    break;
                }
            }
        }
        draw('polyline');
        //mouseTool.close(true)//关闭，并清除覆盖物
        //map.remove(overlays) //清除
```

##### 鼠标工具-拉框缩放

###### 使用[MouseTool](https://lbs.amap.com/api/javascript-api/reference/plugin#AMap.MouseTool)可实现放大/缩小选中地图区域效果，用于区域缩放等场景

```
       //拉框放大、拉框缩小
        var map = new AMap.Map("container", {
            resizeEnable: true
        });

        var mouseTool = new AMap.MouseTool(map);

        function draw(type) {
            switch (type) {
                case "zoomIn": {
                    mouseTool.rectZoomIn({
                        stokeColor: '#80d8ff',
                        fillColor: '#80d8ff',
                        fillOpacity: .3
                    });
                    break;
                }
                case "zoomOut": {
                    mouseTool.rectZoomOut({
                        strokeColor: '#80d8ff',
                        fillColor: '#80d8ff',
                        fillOpacity: 0.3
                    });
                    break;
                }
            }
        }
        //拉框放大
        draw("zoomIn");
        //拉框缩小
        draw("zoomOut");
```

##### 鼠标工具-距离面积测量

###### 使用[MouseTool](https://lbs.amap.com/api/javascript-api/reference/plugin#AMap.MouseTool)封装了RagingTool的测距功能，同时提供了 measureArea 面积测量功能

```
  var map = new AMap.Map("container", {
            resizeEnable: true
        });

        var mouseTool = new AMap.MouseTool(map);
        function draw(type) {
            switch (type) {
                case "rule": {
                    mouseTool.rule({
                        startMarkerOptions: {//可缺省
                            icon: new AMap.Icon({
                                size: new AMap.Size(19, 31),  //图标大小
                                imageSize: new AMap.Size(19, 31),
                                image: "https://webapi.amap.com/theme/v1.3/markers/b/start.png"
                            })
                        },
                        endMarkerOptions: {
                            icon: new AMap.Icon({
                                size: new AMap.Size(19, 31),  //图标大小
                                imageSize: new AMap.Size(19, 31),
                                image: "https://webapi.amap.com/theme/v1.3/markers/b/end.png"
                            }),
                            offset: new AMap.Pixel(-9, -31)
                        },
                        midMarkerOpations: {// 可缺省
                            icon: new AMap.Icon({
                                size: new AMap.Size(19, 31),  //图标大小
                                imageSize: new AMap.Size(19, 31),
                                image: "https://webapi.amap.com/theme/v1.3/markers/b/mid.png"
                            }),
                            offset: new AMap.Pixel(-9, -31)
                        },
                        lineOptions: {//可缺省
                            strokeStyle: "solid",
                            strokeColor: "#FF33FF",
                            strokeOpacity: 1,
                            strokeWeight: 2
                        }
                    })
                    break;
                }
                case "measureArea": {
                    mouseTool.measureArea({
                        strokeColor: "#80d8ff",
                        fillColor: "#80d8ff",
                        fillOpacity: .3
                    });
                    break;
                }

            }
        }
        draw("measureArea")
```

##### 测距工具

###### 使用[RangingTool](https://lbs.amap.com/api/javascript-api/reference/plugin#AMap.RangingTool)测量地图上两点间实际记录，可用于线上地图距离量取等场景。

```
var map = new AMap.Map("container", {
            resizeEnable: true
        });

        var ruler1, ruler2;
        //默认样式
        ruler1 = new AMap.RangingTool(map);

        //自定义样式
        var startMarkerOptions = {
            icon: new AMap.Icon({
                size: new AMap.Size(19, 31),  //图标大小
                imageSize: new AMap.Size(19, 31),
                image: "https://webapi.amap.com/theme/v1.3/markers/b/start.png"
            })
        };

        var endMarkerOptions = {
            icon: new AMap.Icon({
                size: new AMap.Size(19, 31),  //图标大小
                imageSize: new AMap.Size(19, 31),
                image: "https://webapi.amap.com/theme/v1.3/markers/b/end.png"
            }),
            offset: new AMap.Pixel(-9, -31)
        }

        var midMarkerOptions = {
            icon: new AMap.Icon({
                size: new AMap.Size(19, 31),  //图标大小
                imageSize: new AMap.Size(19, 31),
                image: "https://webapi.amap.com/theme/v1.3/markers/b/mid.png"
            }),
            offset: new AMap.Pixel(-9, -31)
        }

        var lineOptions = {
            strokeStyle: "solid",
            strokeColor: "#FF33FF",
            strokeOpacity: 1,
            strokeWeight: 2
        }

        var rulerOptions = {
            startMarkerOptions: startMarkerOptions,
            midMarkerOptions: midMarkerOptions,
            endMarkerOptions: endMarkerOptions,
            lineOptions: lineOptions
        }

        ruler2 = new AMap.RangingTool(map, rulerOptions);

        //开启自定义样式测距
        ruler2.turnOn();
        ruler1.turnOff();

        //开启默认样式测距
        //ruler1.turnOn();
        //ruler2.turnOff();
```

#### 辅助库

##### 浏览器环境

###### 当前浏览器环境的一些通用检测结果可以通过 AMap.Browser 获取

```
var wrap = document.getElementsByClassName("wrap")[0];
   var env = {
       "是否移动设备": AMap.Browser.mobile,
       "是否触摸设备": AMap.Browser.touch,
       "是否高清屏": AMap.Browser.retina,
       "是否安卓设备": AMap.Browser.android,
       "是否ios设备": AMap.Browser.ios,
       "是否Windows系统": AMap.Browser.windows,
       "是否iMac系统": AMap.Browser.mac,
       "是否IE678": AMap.Browser.ielt9,
       "是否支持canvas": AMap.Browser.isCanvas,
       "是否支持WebGL": AMap.Browser.isWebGL(),
       "是否支持SVG": AMap.Browser.isSvg,
       "是否支持WebWorker": AMap.Browser.isWorker,
       "是否支持WebSocket": AMap.Browser.isWebsocket,
       "User-Agent": AMap.Browser.ua
   }
    var tree = jsonTree.create(env, wrap);
   tree.expand();
```

#### 调起高德地图

##### 点标记

###### 使用 markOnAMAP 调起高德地图应用

```
var map = new AMap.Map("container", {
        resizeEnable: true,
        center: [113.265531, 23.135281]
    });

    var marker = new AMap.Marker({
        map: map,
        position: map.getCenter(),
        label: {
            offset: new AMap.Pixel(20, 20),  //修改Label相对于marker的位置
            content: "点击Marker打开高德地图"
        }
    });
    marker.on("click", function (e) {
        marker.markOnAMAP({
            name: "广州",
            position: marker.getPosition()
        });
    });
```

##### POI详情

###### 使用 poiOnAMAP 调起高德地图 POI详情

```
 var map = new AMap.Map("container", {
        resizeEnable: true,
        center: [116.473188,39.993253]
    });

    AMap.plugin("AMap.PlaceSearch", function () {
        var placeSearch = new AMap.PlaceSearch({
            city: "010",
            pageSize: 5
        });
        placeSearch.search("博物馆", function (status, result) {
            if(status === "complete") {
                var pois = result.poiList.pois;
                for(var i = 0;i < pois.length; i ++) {
                    var marker = new AMap.Marker({
                        content: "<div class='marker'>" + i + "</div>",
                        position: pois[i].location,
                        map: map,
                        label: {
                            offset: new AMap.Pixel(20, 20),  //修改label相对于marker的位置
                            content: pois[i].name
                        }
                    });

                    marker.id = pois[i].id;
                    marker.name = pois[i].name;
                    marker.on("click", function () {
                        map.poiOnAMAP({
                            name: this.name,
                            location: this.getPosition(),
                            id: this.id
                        })
                    })
                }
                map.setFitView();
            }
        })
    })
```

#### 关系判断 

##### 点是否在线上

###### 使用[ AMap.GeometryUtil.isPointOnSegment ](https://lbs.amap.com/api/javascript-api/reference/math)判断点是否在线上

```
        var map = new AMap.Map("container", {
            resizeEnable: true,
            zoom: 13
        });
        //创建折线
        var path = [
            [116.368904, 39.913423],
            [116.382122, 39.901176],
            [116.387271, 39.912501],
            [116.398258, 39.904600]
        ]
        //构建线条
        var polyline = new AMap.Polyline({
            map: map,
            path: path,
            strokeColor: "#80d8ff",
            strokeWeight: 5
        });
        //构建标记
        var marker = new AMap.Marker({
            map: map,
            draggable: true,
            position: [116.377904, 39.915423]
        });

        //判断点线关系
        function pointOnSegment() {
            var pos = marker.getPosition();
            var mp = map.getResolution();  //获取指定位置的地图分辩率，单位：米/像素
            var m = 5 * mp; //m 为Polyline宽度的米数
            //判断marker是否在线上
            var inLine = AMap.GeometryUtil.isPointOnSegment(pos, path[0], path[1], m);
            var text = "点不在线上";

            if (inLine) {
                text = "点在线上"
            }
            marker.setLabel({   
                offset: new AMap.Pixel(20, 20),
                content: text   
            });
        }
        map.setFitView();
        pointOnSegment();
        marker.on("dragging", pointOnSegment);
```

##### 点是否在多边形内

###### 使用[ AMap.GeometryUtil.isPointInRing ](https://lbs.amap.com/api/javascript-api/reference/math)，判断点是否在多边形内。

```
 var map = new AMap.Map("container", {
       resizeEnable: true,
       zoom: 10,
       center: [116.566298, 40.014179]
   });

   // 创建多边形
   var path = [
       [116.169465,39.932670],
       [116.160260,39.924492],
       [116.186138,39.879817],
       [116.150625,39.710019],
       [116.183198,39.709920],
       [116.226950,39.777616],
       [116.421078,39.810771],
       [116.442621,39.799892],
       [116.463478,39.790066],
       [116.588276,39.809551],
       [116.536091,39.808859],
       [116.573856,39.839643],
       [116.706380,39.916740],
       [116.657285,39.934545],
       [116.600293,39.937770],
       [116.540039,39.937968],
       [116.514805,39.982375],
       [116.499935,40.013710],
       [116.546520,40.030443],
       [116.687668,40.129961],
       [116.539697,40.080659],
       [116.503390,40.058474],
       [116.468800,40.052578]
   ];
   var polygon = new AMap.Polygon({
       map: map,
       fillOpacity: .4,
       path: path
   });

   //构建点标记
    var marker = new AMap.Marker({
        map: map,
        draggable: true,
        position: [116.566298, 40.014179]
    });

    function compute() {
        var point = marker.getPosition();
        var isPointInRing = AMap.GeometryUtil.isPointInRing(point, path);
        marker.setLabel({
            content: isPointInring ? "外部" : "内部",
            offset: new AMap.Pixel(20, 0)
        });
    }
    compute();
    marker.on("dragging", compute);
    map.setFitView();
```

##### 面与面的几何关系

###### GeometryUtil提供了面和面几何关系的计算方法，包括包含关系、相交关系以及重叠面的计算等，ringRingClip仅适用于凸多边形。

```
   var map = new AMap.Map("container", {
       resizeEnable: true,
       zoom: 13,
       center: [116.376907,39.910967]
   });

   var path1 =  [
       [116.376907,39.910967],
       [116.384911,39.919505],
       [116.40109,39.919728],
       [116.411132,39.911408],
       [116.412076,39.899135],
       [116.402292,39.892353],
       [116.3874,39.892518],
       [116.376971,39.899267]
   ];
   var polygon1 = new AMap.Polygon({
       map: map,
       fillColor: "blue",
       fillOpacity: .3,
       path: path1
   });
   var path2 = [
       [116.390233,39.906602],
       [116.395254,39.908668],
       [116.400661,39.906667],
       [116.400962,39.898589],
       [116.395769,39.894855],
       [116.390147,39.898049],
   ]
   var polygon2 = new AMap.Polygon({
       map: map,
       fillColor: "red",
       fillOpacity: .3,
       path: path2,
       draggable: true
   });
   var textBox = new AMap.Text({
       map: map,
       position: new AMap.LngLat(116.40109,39.919728),
       offset: new AMap.Pixel(-20, 40),
       style: {
           "background-color": "yellow",
           "border": "solid 1px #0088ff",
           "padding": "10px 20px"
       }
   });

   function compute() {
       var polygon1_path = polygon1.getPath();
       var polygon2_path = polygon2.getPath();
        //小圈是否在大圈内
       var isRingInRing = AMap.GeometryUtil.isRingInRing(polygon2_path, polygon1_path);
       //两圈是否交叉
       var doesRingRingIntersect = AMap.GeometryUtil.doesRingRingIntersect(polygon2_path, polygon1_path);
       var ringRingClip = AMap.GeometryUtil.ringRingClip(polygon2_path, polygon1_path);
       var ringArea = parseInt(AMap.GeometryUtil.ringArea(ringRingClip));

       var text = "两圈关系：在大圈外";
       if(isRingInRing) {
           text = "两圈关系：在大圈内";
       }else if(doesRingRingIntersect) {
           text = "两圈关系：两圈相交，交叉区域面积为" + ringArea + "平方米"
       }
       textBox.setText(text)
   }
   compute();
   polygon2.on("draggable", compute)
```

##### 其他

###### 三角拆分

```
var map = new AMap.Map("container", {
       resizeEnable: true,
       zoom: 13,
       center: [116.376907,39.910967]
   });

   // 带洞多边形 - 外多边形坐标数组和内多边形坐标数组
   var pointers = {
       outer: [
           [117.104554, 30.504444],
           [117.118974, 30.506219],
           [117.12893, 30.508586],
           [117.13305, 30.511248],
           [117.139917, 30.514501],
           [117.147126, 30.518642],
           [117.153993, 30.5216],
           [117.161546, 30.526036],
           [117.171502, 30.529289],
           [117.177339, 30.531655],
           [117.184892, 30.531063],
           [117.197595, 30.533133],
           [117.212014, 30.535499],
           [117.223001, 30.536682],
           [117.233987, 30.536977],
           [117.23845, 30.538456],
           [117.240854, 30.545848],
           [117.251153, 30.543778],
           [117.251497, 30.53816],
           [117.24875, 30.530767],
           [117.246347, 30.523965],
           [117.243943, 30.515684],
           [117.241197, 30.504149],
           [117.238107, 30.493795],
           [117.229524, 30.481073],
           [117.221971, 30.474268],
           [117.215104, 30.469533],
           [117.204461, 30.466574],
           [117.190728, 30.462727],
           [117.183862, 30.464207],
           [117.156739, 30.47456],
           [117.14644, 30.47841],
           [117.140603, 30.482257],
           [117.127214, 30.485215],
           [117.107988, 30.487878]
       ],
       inner: [
           [117.162061, 30.49361],
           [117.167211, 30.49716],
           [117.172361, 30.50071],
           [117.177167, 30.505739],
           [117.184034, 30.512542],
           [117.18987, 30.522894],
           [117.2012, 30.525851],
           [117.210126, 30.527034],
           [117.219396, 30.526443],
           [117.225919, 30.527034],
           [117.234159, 30.529104],
           [117.237935, 30.528808],
           [117.235532, 30.522894],
           [117.234502, 30.516683],
           [117.232785, 30.507514],
           [117.226262, 30.491835],
           [117.217336, 30.480297],
           [117.202916, 30.4729],
           [117.194677, 30.470828],
           [117.184034, 30.473491],
           [117.177511, 30.47793],
           [117.170644, 30.484439],
           [117.167897, 30.489173]
       ]
   };
   var pathArray = [pointers.outer, pointers.inner];
   var polaygon = new AMap.Polygon({
       map: map,
       fillOpacity: .4,
       path: pathArray,
       fillColor: "#D1B3E3"
   });
   var pathArrayNormal = [
       [117.114879,30.532808],
       [117.1305,30.552693],
       [117.104408,30.558754],
       [117.075225,30.524158]
   ]
    var polygonNormal = new AMap.Polygon({
        map: map,
        fillOpacity: .4,
        path: pathArrayNormal,
        fillColor: "#D1B3E3"
    });
   map.setFitView();
   //获取随机颜色
    var getRandomColor = function () {
        return "#" + Math.floor(Math.random() * 16777215).toString(16);
    }
    //根据polygon顶点拆分三角形
    function triangulateShape() {
        //获得三角形顶点集合
        var triangles = AMap.GeometryUtil.triangulateShape(pathArray[0], pathArray[1]);
        var trianglePathArr = pathArray[0].concat(pathArray[1]);
        for(var i = 0; i < triangles.length; i += 3) {
            var trianglePath = [trianglePathArr[triangles[i]],trianglePathArr[triangles[i+1]],trianglePathArr[triangles[i+2]]]
        }

        var polygon_0 = new AMap.Polygon({
            map: map,
            fillOpacity: .3,
            path: trianglePath,
            strokeOpacity: 0,
            fillColor: getRandomColor()
        })
    }
   function triangulateShapeNormal(){
       // 获得三角形顶点集合
       var triangles = AMap.GeometryUtil.triangulateShape(pathArrayNormal);
       for ( var i = 0; i < triangles.length; i += 3 ){
           var trianglePath = [pathArrayNormal[triangles[i]],pathArrayNormal[triangles[i+1]],pathArrayNormal[triangles[i+2]]]
           var polygon_0 = new AMap.Polygon({
               map: map,
               fillOpacity:0.3,
               path: trianglePath,
               strokeOpacity: 0,
               fillColor: getRandomColor()
           });
       }
   }

   triangulateShape();
   triangulateShapeNormal();
```

##### 路径是否顺时针

###### 使用[ AMap.GeometryUtil.isClockwise ](https://lbs.amap.com/api/javascript-api/reference/math)，判断路径是否为顺时针。

```
//初始化地图对象，加载地图
    var map = new AMap.Map("container", {
        center: [116.400274, 39.905812],
        zoom: 14
    });

    var path = [
        [116.403322, 39.920255],
        [116.410703, 39.897555],
        [116.402292, 39.892353],
        [116.389846, 39.891365]
    ]

    //路径上点按顺序标明
    var markers = [{
        icon: 'https://webapi.amap.com/theme/v1.3/markers/n/mark_b1.png',
        position: path[0]
    }, {
        icon: 'https://webapi.amap.com/theme/v1.3/markers/n/mark_b2.png',
        position: path[1]
    }, {
        icon: 'https://webapi.amap.com/theme/v1.3/markers/n/mark_b3.png',
        position: path[2]
    }, {
        icon: 'https://webapi.amap.com/theme/v1.3/markers/n/mark_b4.png',
        position: path[3]
    }];

    //添加点标记
    markers.forEach(function (marker) {
        new AMap.Marker({
            map: map,
            icon: marker.icon,
            position: [marker.position[0], marker.position[1]],
            offset: new AMap.Pixel(-9, -31)
        });
    });

    // 根据路径绘制多边形
    var polygon = new AMap.Polygon({
        map: map,
        path: path
    });
    var clockwise = AMap.GeometryUtil.isClockwise(path);
    var text = '该路径为逆时针方向';
    if(clockwise){
        text = '该路径为顺时针方向';
    }
    var textBox = new AMap.Text({
        position: new AMap.LngLat(116.403322, 39.920255),
        text: text,
        offset: new AMap.Pixel(90, -20)
    })
    map.add(textBox);
```



